<div id="main_content">

      <div id="search-results">
  <p>
    <a href="/docs">Home</a> » <a href="/docs/guides">Guides</a> » <a href="/docs/guides/getting-started">Getting Started</a> » Using Zencoder with S3
  </p>

  <h2>
      <span class="api-section-permalink">
        <a href="/docs/guides/getting-started/working-with-s3">permalink</a>
      </span>
    Using Zencoder with S3
  </h2>

    <p>Zencoder can upload and download files from your Amazon S3 bucket. For Zencoder to download files, they either need to be accessible by Everyone or a bucket policy needs to be added to your bucket that will grant Zencoder access.</p>
<p>You can save <a href="/docs/api/encoding/job/credentials">credentials</a> to your account, which will allow us to use your account to upload files instead of ours. This means your account is the owner of the file, with full rights and priveleges over it. You can set credentials to be the default for all uploads or reference them with each request, but keep in mind that if you set them as the default for S3, they will be used for ALL S3 uploads. Generally this isn't a problem, but if later you'd like to upload to a third party's bucket, this can cause issues.</p>
<p>Another option is to use a bucket policy, which lets you set permissions on all of the files in your bucket. To get started, visit <a href="http://aws.amazon.com/console/">AWS Console</a>. Select your bucket on the left side of the screen, then click "properties". On the last row click "Add bucket policy". We'll put a Bucket Policy together below, which you'll copy in to the Bucket Policy text box.</p>
<p>Our recommended bucket policy:
</p><div class="docs-code">
  <div><div id="highlighter_460442" class="syntaxhighlighter  javascript"><div class="toolbar"><span><a href="#" class="toolbar_item command_help help">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><tbody class="bcls-table__body"><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div><div class="line number28 index27 alt1">28</div><div class="line number29 index28 alt2">29</div><div class="line number30 index29 alt1">30</div><div class="line number31 index30 alt2">31</div><div class="line number32 index31 alt1">32</div><div class="line number33 index32 alt2">33</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="javascript plain">{</code></div><div class="line number2 index1 alt1"><code class="javascript spaces">&nbsp;&nbsp;</code><code class="javascript string">"Version"</code><code class="javascript plain">: </code><code class="javascript string">"2008-10-17"</code><code class="javascript plain">,</code></div><div class="line number3 index2 alt2"><code class="javascript spaces">&nbsp;&nbsp;</code><code class="javascript string">"Id"</code><code class="javascript plain">: </code><code class="javascript string">"ZencoderBucketPolicy"</code><code class="javascript plain">,</code></div><div class="line number4 index3 alt1"><code class="javascript spaces">&nbsp;&nbsp;</code><code class="javascript string">"Statement"</code><code class="javascript plain">: [</code></div><div class="line number5 index4 alt2"><code class="javascript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="javascript plain">{</code></div><div class="line number6 index5 alt1"><code class="javascript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="javascript string">"Sid"</code><code class="javascript plain">: </code><code class="javascript string">"Stmt1295042087538"</code><code class="javascript plain">,</code></div><div class="line number7 index6 alt2"><code class="javascript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="javascript string">"Effect"</code><code class="javascript plain">: </code><code class="javascript string">"Allow"</code><code class="javascript plain">,</code></div><div class="line number8 index7 alt1"><code class="javascript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="javascript string">"Principal"</code><code class="javascript plain">: {</code></div><div class="line number9 index8 alt2"><code class="javascript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="javascript string">"AWS"</code><code class="javascript plain">: </code><code class="javascript string">"arn:aws:iam::395540211253:root"</code></div><div class="line number10 index9 alt1"><code class="javascript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="javascript plain">},</code></div><div class="line number11 index10 alt2"><code class="javascript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="javascript string">"Action"</code><code class="javascript plain">: [</code></div><div class="line number12 index11 alt1"><code class="javascript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="javascript string">"s3:GetObjectAcl"</code><code class="javascript plain">,</code></div><div class="line number13 index12 alt2"><code class="javascript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="javascript string">"s3:GetObject"</code><code class="javascript plain">,</code></div><div class="line number14 index13 alt1"><code class="javascript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="javascript string">"s3:PutObjectAcl"</code><code class="javascript plain">,</code></div><div class="line number15 index14 alt2"><code class="javascript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="javascript string">"s3:PutObject"</code><code class="javascript plain">,</code></div><div class="line number16 index15 alt1"><code class="javascript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="javascript string">"s3:ListMultipartUploadParts"</code></div><div class="line number17 index16 alt2"><code class="javascript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="javascript plain">],</code></div><div class="line number18 index17 alt1"><code class="javascript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="javascript string">"Resource"</code><code class="javascript plain">: </code><code class="javascript string">"arn:aws:s3:::MY-BUCKET/*"</code></div><div class="line number19 index18 alt2"><code class="javascript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="javascript plain">},</code></div><div class="line number20 index19 alt1"><code class="javascript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="javascript plain">{</code></div><div class="line number21 index20 alt2"><code class="javascript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="javascript string">"Sid"</code><code class="javascript plain">: </code><code class="javascript string">"Stmt1295042087538"</code><code class="javascript plain">,</code></div><div class="line number22 index21 alt1"><code class="javascript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="javascript string">"Effect"</code><code class="javascript plain">: </code><code class="javascript string">"Allow"</code><code class="javascript plain">,</code></div><div class="line number23 index22 alt2"><code class="javascript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="javascript string">"Principal"</code><code class="javascript plain">: {</code></div><div class="line number24 index23 alt1"><code class="javascript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="javascript string">"AWS"</code><code class="javascript plain">: </code><code class="javascript string">"arn:aws:iam::395540211253:root"</code></div><div class="line number25 index24 alt2"><code class="javascript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="javascript plain">},</code></div><div class="line number26 index25 alt1"><code class="javascript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="javascript string">"Action"</code><code class="javascript plain">: [</code></div><div class="line number27 index26 alt2"><code class="javascript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="javascript string">"s3:ListBucketMultipartUploads"</code><code class="javascript plain">,</code></div><div class="line number28 index27 alt1"><code class="javascript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="javascript string">"s3:GetBucketLocation"</code></div><div class="line number29 index28 alt2"><code class="javascript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="javascript plain">],</code></div><div class="line number30 index29 alt1"><code class="javascript spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="javascript string">"Resource"</code><code class="javascript plain">: </code><code class="javascript string">"arn:aws:s3:::MY-BUCKET"</code></div><div class="line number31 index30 alt2"><code class="javascript spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="javascript plain">}</code></div><div class="line number32 index31 alt1"><code class="javascript spaces">&nbsp;&nbsp;</code><code class="javascript plain">]</code></div><div class="line number33 index32 alt2"><code class="javascript plain">}</code></div></div></td></tr></tbody></table></div></div>
</div>
<p></p>
<p>There is only <strong>one change you will have to make</strong> to this bucket policy before it's ready to go.</p>
<p>
  </p><ol>
    <li>Replace MY-BUCKET with the name of your bucket. Leave the /* at the end of the line, as that will apply the policy to every file within the bucket.</li>
    <li>Optionally, replace the Action array with the actions you want to allow. Valid actions that Zencoder may need are:
      <h4>Object Permissions - first action array in the example above</h4>
      <ul>
        <li>s3:PutObject - allow Zencoder to upload files to the bucket</li>
        <li>s3:GetObject - allow Zencoder to download files from the bucket</li>
        <li>s3:GetObjectAcl - allow Zencoder to get ACL permissions for files</li>
        <li>s3:PutObjectAcl - allow Zencoder to set ACL permissions for other users on files</li>
        <li>s3:ListMultipartUploadParts - allow Zencoder to list which parts of a multipart file have been uploaded to the bucket</li>
      </ul>
      <h4>Bucket Permissions - second action array in the example above</h4>
      <ul>
        <li>s3:GetBucketLocation - allow Zencoder to get the location of the bucket (US, EU, Asia, etc.)</li>
        <li>s3:ListBucketMultipartUploads - allow Zencoder to view any multipart uploads currently happening on the bucket</li>
      </ul>
        ex: If you want Zencoder to be able to download and upload files, replace the first Action array with:
        <div class="docs-code">
          <div><div id="highlighter_461040" class="syntaxhighlighter  javascript"><div class="toolbar"><span><a href="#" class="toolbar_item command_help help">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><tbody class="bcls-table__body"><tr><td class="gutter"><div class="line number1 index0 alt2">1</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="javascript plain">[</code><code class="javascript string">"s3:PutObject"</code><code class="javascript plain">, </code><code class="javascript string">"s3:GetObject"</code><code class="javascript plain">]</code></div></div></td></tr></tbody></table></div></div>
        </div>

    </li>
  </ol>
<p></p>
<p>Note that there are two statements in the policy. The first statement affects keys within the bucket, while the second part affects the bucket itself.</p>
<p>
  The rest of the policy can be left alone and it will work fine. Amazon's documentation contains more information about the <a href="http://docs.amazonwebservices.com/AmazonS3/latest/dev/index.html?UsingBucketPolicies.html">elements of a Bucket Policy.</a>
</p>
<p>
  Zencoder can also set ACL permissions on the videos and thumbnails that we create for you. This is documented in our <a href="/docs/api/encoding/s3-settings">S3 API docs</a>.
</p>
<p>
  <strong>Note:</strong> When using a bucket policy you should always use URLs in the s3://BUCKET/KEY format so that Zencoder is sure to identify them as S3 URLs and sign the request appropriately.</p>
<p>
  If you'd like to build your own Bucket Policy, you can use <a href="http://awspolicygen.s3.amazonaws.com/policygen.html">Amazon's Policy Generator</a>. Use <em>arn:aws:iam::395540211253:root</em> as the AWS Principal to allow Zencoder access.
</p>
<h3>Can I Just Grant Permission To Specific Files?</h3>
<p>You definitely can. While the Bucket Policy approach is generally easier and faster, it doesn't work well for everyone. If that's you, you can grant permissions to our Amazon AWS account, <code>aws@zencoder.com</code>.</p>
<p>If you need to use our canonical ID instead, you can use <code>6c8583d84664a381db0c6af0e79b285ede571885fbe768e7ea50e5d3760597dd</code>.</p>
<h3>I'm getting permission denied still!</h3>
<p>S3 responds with "Access Denied" if access is denied or if the file isn't found. If you believe you've set up your S3 credentials or bucket policy correctly but are still getting "Access Denied" errors, double check the URL you're submitting. If the input looks like <code>"s3://my-bucket/this+file+is+great.mp4"</code>, there's a good chance what you actually want is <code>"s3://my-bucket/this file is great.mp4"</code></p>

</div>

    </div>