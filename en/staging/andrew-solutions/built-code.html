<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8">
  <script async src="//acdn.adnxs.com/prebid/not-for-prod/1/prebid.js"></script>
  <link href="//players.brightcove.net/videojs-ima3/3/videojs.ima3.min.css" rel="stylesheet">
  <title>Prebid Video -- Brightcove Player</title>
</head>

<body>
  <h1>Prebid Video -- Brightcove Player</h1>
  <video id="myPlayerID" data-account="1507807800001" data-player="defalut" data-video-id="5622718636001" data-embed="default" data-application-id class="video-js" playsinline controls width="640" height="480"></video>
  <script src="//players.brightcove.net/1507807800001/default_default/index.min.js"></script>
  <script src="//players.brightcove.net/videojs-ima3/3/videojs.ima3.min.js"></script>
  <script type="text/javascript">
    var pbjs = pbjs || {};
    pbjs.que = pbjs.que || [];
    iosDevice = !! navigator.platform.match(/iPhone|iPod|iPad/);

    function getServerUrl(callback) {
      var videoAdUnit = {
        code: "video1",
        mediaTypes: {
          video: {
            playerSize: [640, 480],
            context: "instream"
          }
        },
        bids: [{
          bidder: "appnexus",
          params: {
            placementId: iosDevice ? 13239390 : 13232361,
            video: {
              skipppable: true,
              playback_method: ["auto_play_sound_off"]
            }
          }
        }]
      };
      pbjs.que.push(function () {
        pbjs.addAdUnits(videoAdUnit);
        pbjs.setConfig({
          debug: true,
          cache: {
            url: "https://prebid.adnxs.com/pbc/v1/cache"
          }
        });
        pbjs.requestBids({
          bidsBackHandler: function (bids) {
            var videoUrl = pbjs.adServers.dfp.buildVideoUrl({
              adUnit: videoAdUnit,
              params: {
                iu: "/19968336/prebid_cache_video_adunit",
                cust_params: {
                  section: "blog",
                  anotherKey: "anotherValue"
                },
                output: "vast"
              }
            });
            callback(videoUrl);
          }
        });
      });
    };
    bc("myPlayerID").ima3({
      serverUrl: getServerUrl,
      debug: true,
      timeout: 5000,
      ima3SdkSettings: {
        "disableCustomPlaybackForIOS10Plus": true
      }
    });
    var myPlayer = videojs.getPlayer("myPlayerID");
    myPlayer.ready(function () {
      myPlayer.on("ima3error", function () {
        console.log("There was an ima3 error.");
      });
    });
  </script>
</body>

</html>
