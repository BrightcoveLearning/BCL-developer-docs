<!DOCTYPE html>
<html lang="en">

<head>
    <!-- Begin Drupal Taxonomy Data -->
    <meta name="products" content="Video Cloud, Brightcove Player">
    <meta name="role" content="Device SDK Developer">
    <meta name="task" content="Develop with the Native SDKs">
    <meta name="topic" content="Troubleshooting/Error Handling">
    <meta name="sdk" content="iOS,tvOS,Android">
    <meta name="keywords" content="device,SDK,FAQ">
    <!-- End Drupal Taxonomy Data -->

    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  	<meta name="viewport" content="initial-scale=1.0, maximum-scale=1.0, user-scalable=no, width=device-width" />
    <meta name="robots" content="noindex">
  	<!-- change title to match the h1 heading -->
  	<title>Video Cloud SSAI with the Native Player SDKs</title>

    <link rel="stylesheet" type="text/css" href="//cdnjs.cloudflare.com/ajax/libs/foundation/5.5.3/css/foundation.min.css" />
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/foundation/5.5.3/css/normalize.css" />
    <link href="//fonts.googleapis.com/css?family=Open+Sans:400italic,700italic,400,700" rel="stylesheet" type="text/css">
    <script src="//use.edgefonts.net/source-code-pro.js"></script>
    <link rel="stylesheet" href="//learning-services-media.brightcove.com/doc-assets/js/prism/prism.css">
    <link rel="stylesheet" href="//docs.brightcove.com/en/styles/template-less/css/bcls-doc.css">
    <link rel="stylesheet" href="/en/styles/foundation-fixes.css">

    <script src="//cdnjs.cloudflare.com/ajax/libs/foundation/5.5.3/js/vendor/modernizr.js"></script>

</head>

<body>
	<!-- header navbar -->
	<div id="navWrapper" class="fixed"></div>
	<!-- breadcrumbs -->
	<nav id="breadCrumbWrapper" class="breadcrumbs show-for-medium-up"></nav>
	<!-- search -->
	<div id="searchModal" class="reveal-modal" data-reveal></div>
	<!-- content -->
	<div class="row">
		<div class="sidebar large-2 columns show-for-large-up">
			<div id="sidenav" class="side-nav"></div>
		</div>
		<div id="main" class="large-10 small-12 columns">
			<h1>Video Cloud SSAI with the Native Player SDKs</h1>
      <aside class="bcls-aside bcls-aside--warning">This is a INTERNAL document for review only. For the official Brightcove documentation site, go to <a href="https://support.brightcove.com/">support.brightcove.com</a></aside>
      <p>In this topic, you will learn how to play Server-Side ads from videos ingested for Dynamic Delivery with the Brightcove Native Player SDKs.</p>


	    <!-- BEGIN DRUPAL CONTENT -->

      <article class="bcls-article">
        <section id="top" class="bcls-section">
            <aside class="bcls-aside bcls-aside--information">Notes:
            <ul>
              <li>
                Dynamic Delivery is currently in Limited Availability. Contact your account manager if you are interested in converting your account to Dynamic Delivery.
              </li>
              <li>
                Currently, Video Cloud SSAI is only available for Video-on-Demand (VOD).
              </li>
            </ul></aside>
        </section>

        <section class="bcls-section">
          <h2 id="Overview">Overview</h2>
          <p>
            Server-Side Ad Insertion (SSAI) allows you to embed ads into your videos so that they can't be blocked by ad blockers in the browser. Dynamic Delivery is the next generation ingest and delivery system which reduces your storage footprint and dynamically packages media. Learn more about using <a href="https://www.brightcove.com/en/blog/2017/03/digital-rights-management-drm-dynamic-delivery">Dynamic Delivery</a> for your videos.
          </p>
          <p>
            SSAI works with both DRM and non-DRM content.
          </p>
          <p>
            To play server-side ads with your video content stored in Video Cloud, follow these steps:
          </p>
          <ol class="bcls-tasklist">
            <li>
              <a href="#Create_an_ad_configuration">Create an ad configuration</a>
            </li>
            <li>
              <a href="#Play_a_video_with_ads">Play a video with ads</a>
              <ul>
                <li>
                  <a href="#iOS_implementation">iOS implementation</a>
                </li>
                <li>
<<<<<<< .merge_file_ocBjqe
                  <a href="">Android implementation</a>
=======
                  <a href="#Android_implementation">Android implementation</a>
>>>>>>> .merge_file_1R1xVG
                </li>
              </ul>
            </li>
          </ol>
      </section>

      <section class="bcls-section">
        <h2 id="Create_an_ad_configuration">Create an ad configuration</h2>
        <p>
          The ad configuration defines various aspects of SSAI playback, including a URL to your Video Multiple Ad Playlist (VMAP) file, beacons, and other configurations. For now, you must contact your Brightcove account manager to create your ad configuration.
        </p>
      </section>

      <section class="bcls-section">
        <h2 id="Play_a_video_with_ads">Play a video with ads</h2>
        <p>
          First, you will include the Once UX plugin in your app. Then, you will call an SDK method to fetch a video along with your ad configuration from the Playback API. Finally, you will play the video with ads.
        </p>
        <h3 id="iOS_implementation">iOS implementation</h3>
        <p>
          Follow these steps within your app to get your ad configuration and play your video:
        </p>
        <ol class="bcls-tasklist__restart">
          <li>
            Include the Once UX plugin in your app. For details, see the <a href="https://github.com/BrightcoveOS/ios-player-samples/tree/master/OUX">Basic Once UX Player</a> sample.
          </li>
          <li>
            Define constants for your account id, policy key, video id or video reference id, and your ad configuration id.
            <pre class="line-numbers"><code class="language-objectivec">NSString *accountId = @&quot;&lt;accountId&gt;&quot;;
NSString *policyKey = @&quot;&lt;policyKey&gt;&quot;;
NSString *videoReferenceId = @&quot;&lt;videoReferenceId&gt;&quot;;
NSString *adConfigId = @&quot;&lt;adConfigId&gt;&quot;;
</code></pre>
            <aside class="bcls-aside bcls-aside--information">Learn how to get or generate a policy key in the <a href="https://support.brightcove.com/node/18125">Policy Keys</a> document.</aside>
          </li>
          <li>
            Set the query parameter value to your ad configuration id.
            <pre class="line-numbers"><code class="language-objectivec">NSDictionary *queryParameters = @{
    @&quot;ad_config_id&quot; : adConfigId
};
</code></pre>
          </li>
          <li>
            Create an instance of the playbackService if it does not already exist.
            <pre class="line-numbers"><code class="language-objectivec">if (_playbackService == nil) {
    self.playbackService = [[BCOVPlaybackService alloc]
        initWithAccountId:accountId
        policyKey:policyKey];
}
</code></pre>
          </li>
          <li>
            Call the Playback API to retrieve your video along with your ad configuration.
            <pre class="line-numbers"><code class="language-objectivec">[_playbackService findVideoWithReferenceID:videoReferenceId
    parameters:queryParameters
    completion:^(BCOVVideo *video,
        NSDictionary *jsonResponse,
        NSError *error)
{...}]
</code></pre>
          </li>
          <li>
            Start video playback with your specified ads.
            <pre class="line-numbers"><code class="language-objectivec">if (error == nil)
         {
             // play it.
             [self.playbackController setVideos: @[ video ]];
         }
         else
         {
             NSLog (@&quot;Error! Playback Service says: %@&quot;,
error.localizedDescription);
         }
</code></pre>
          </li>
        </ol>

        <p>
          Here is the complete code block:
        </p>
        <pre class="line-numbers"><code class="language-objectivec">- (void)playVideo
{

    NSDictionary *queryParameters = @{
        @&quot;ad_config_id&quot; : adConfigId
    };

    if (_playbackService == nil) {
        self.playbackService = [[BCOVPlaybackService alloc]
            initWithAccountId:accountId
             policyKey:policyKey];
    }

    [_playbackService findVideoWithReferenceID:videoReferenceId
            parameters:queryParameters
            completion:^(BCOVVideo *video,
                 NSDictionary *jsonResponse,
                 NSError *error)
     {
         if (error == nil)
         {
             // play it.
             [self.playbackController setVideos: @[ video ]];
         }
         else
         {
             NSLog (@&quot;Error! Playback Service says: %@&quot;,
error.localizedDescription);
         }
    }];
}
</code></pre>
<<<<<<< .merge_file_ocBjqe


      </section>

=======
          <br />

          <h3 id="Android_implementation">Android implementation</h3>
          <p>
            Follow these steps within your app to get your ad configuration and play your video:
          </p>
          <ol class="bcls-tasklist__restart">
            <li>
              Include the Once UX plugin in your app. For details, see the <a href="https://github.com/BrightcoveOS/android-player-samples/tree/master/BasicOnceUxSampleApp">Basic Once UX Player</a> sample.
            </li>
            <li>
              Define constants for your account id, policy key, video id or video reference id, and your ad configuration id.
              <pre class="line-numbers"><code class="language-java">String accountId = &quot;&lt;accountId&gt;&quot;;
String policyKey = &quot;&lt;policyKey&gt;&quot;;
String videoRef = &quot;&lt;videoRef&gt;&quot;;
String adConfigId = &quot;&lt;adConfigId&gt;&quot;;
          </code></pre>
              <aside class="bcls-aside bcls-aside--information">Learn how to get or generate a policy key in the <a href="https://support.brightcove.com/node/18125">Policy Keys</a> document.</aside>
            </li>
            <li>
              Set the query parameter value to your ad configuration id.
              <pre class="line-numbers"><code class="language-java">Map&lt;String, String&gt; parameters = new HashMap&lt;&gt;();
parameters.put(&quot;ad_config_id&quot;, adConfigId);
          </code></pre>
            </li>
            <li>
              Create an instance of the catalog service.
              <pre class="line-numbers"><code class="language-java">Catalog catalog = new Catalog(brightcoveVideoView.getEventEmitter(), accountId, policyKey);
          </code></pre>
            </li>
            <li>
              Call the catalog service to retrieve your video along with your ad configuration from the Playback API.
              <pre class="line-numbers"><code class="language-java">catalog.findVideoByReferenceID(videoRef, null, parameters, new VideoListener() {
    ...
});
          </code></pre>
            </li>
            <li>
              Start video playback with your specified ads.
              <pre class="line-numbers"><code class="language-java">@Override
public void onVideo(Video video) {
    try {
        plugin.processVideo(video);
    } catch (NoSourceFoundException e) {
        // If NoSourceFoundException is thrown it means a suitable vmap url wasn't found.
        // You can try to play it on a regular view
        brightcoveVideoView.add(video)
    }
}
          </code></pre>
            </li>
          </ol>

          <p>
            Here is the complete code block:
          </p>
          <pre class="line-numbers"><code class="language-java">@Override
    protected void onCreate(Bundle savedInstanceState) {
        setContentView(R.layout.activity_main);
        brightcoveVideoView = (BrightcoveVideoView) findViewById(R.id.brightcove_video_view);
        super.onCreate(savedInstanceState);

        final OnceUxComponent plugin = new OnceUxComponent(this, brightcoveVideoView);
        Catalog catalog = new Catalog(brightcoveVideoView.getEventEmitter(), accountId, policyKey);

        Map&lt;String, String&gt; parameters = new HashMap&lt;&gt;();
        parameters.put(&quot;ad_config_id&quot;, adConfigId);
        catalog.findVideoByReferenceID(videoRef, null, parameters, new VideoListener() {
            @Override
            public void onVideo(Video video) {
                try {
                    plugin.processVideo(video);
                } catch (NoSourceFoundException e) {
                    // If NoSourceFoundException is thrown it means a suitable vmap url wasn't found.
                    // You can try to play it on a regular view
                    brightcoveVideoView.add(video)
                }
            }
        });
    }
          </code></pre>

      </section>
>>>>>>> .merge_file_1R1xVG
      </article>

      <!-- END DRUPAL CONTENT -->
		</div>
	</div>
	<!-- bcl scripts -->
  <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.2.3/jquery.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/fastclick/1.0.6/fastclick.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/foundation/5.5.3/js/foundation.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/handlebars.js/4.0.5/handlebars.min.js"></script>
  <script src="/en/scripts/docs-nav-data.min.js"></script>
  <script src="/en/scripts/bcls-doc-site-v0.js"></script>
  <script src="//learning-services-media.brightcove.com/doc-assets/js/bcls-utils.js"></script>
  <script src="//learning-services-media.brightcove.com/doc-assets/js/prism/prism.js"></script>
  <script>
  $(document).foundation();
  </script>
  <!-- Any scripts specific to page samples should go here -->
</body>

</html>
