<!DOCTYPE html>
<html lang="en">

<head>
    <!-- Begin Drupal Taxonomy Data -->
    <meta name="products" content="Video Cloud, Brightcove Player">
    <meta name="role" content="Device SDK Developer">
    <meta name="task" content="Develop with the Native SDKs">
    <meta name="topic" content="Troubleshooting/Error Handling">
    <meta name="sdk" content="iOS,tvOS,Android">
    <meta name="keywords" content="device,SDK,FAQ">
    <!-- End Drupal Taxonomy Data -->

    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  	<meta name="viewport" content="initial-scale=1.0, maximum-scale=1.0, user-scalable=no, width=device-width" />
    <meta name="robots" content="noindex">
  	<!-- change title to match the h1 heading -->
  	<title>Video Cloud SSAI Setup and Debugging</title>

    <link rel="stylesheet" type="text/css" href="//cdnjs.cloudflare.com/ajax/libs/foundation/5.5.3/css/foundation.min.css" />
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/foundation/5.5.3/css/normalize.css" />
    <link href="//fonts.googleapis.com/css?family=Open+Sans:400italic,700italic,400,700" rel="stylesheet" type="text/css">
    <script src="//use.edgefonts.net/source-code-pro.js"></script>
    <link rel="stylesheet" href="//learning-services-media.brightcove.com/doc-assets/js/prism/prism.css">
    <link rel="stylesheet" href="//docs.brightcove.com/en/styles/template-less/css/bcls-doc.css">
    <link rel="stylesheet" href="/en/styles/foundation-fixes.css">

    <script src="//cdnjs.cloudflare.com/ajax/libs/foundation/5.5.3/js/vendor/modernizr.js"></script>

</head>

<body>
	<!-- header navbar -->
	<div id="navWrapper" class="fixed"></div>
	<!-- breadcrumbs -->
	<nav id="breadCrumbWrapper" class="breadcrumbs show-for-medium-up"></nav>
	<!-- search -->
	<div id="searchModal" class="reveal-modal" data-reveal></div>
	<!-- content -->
	<div class="row">
		<div class="sidebar large-2 columns show-for-large-up">
			<div id="sidenav" class="side-nav"></div>
		</div>
		<div id="main" class="large-10 small-12 columns">
			<h1>Video Cloud SSAI Setup and Debugging</h1>
      <aside class="bcls-aside bcls-aside--warning">This is a temporary STAGING document for review only. For the official Brightcove documentation site, go to <a href="https://support.brightcove.com/">support.brightcove.com</a></aside>
      <p>In this topic, you will learn how to setup and debug Server-Side Ad Insertion (SSAI) with Dynamic Delivery and the Brightcove player.
      </p>


	    <!-- BEGIN DRUPAL CONTENT -->

	    <article class="bcls-article">
        <section id="top" class="bcls-section">
            <aside class="bcls-aside bcls-aside--information"><a href="https://www.brightcove.com/en/blog/2017/03/digital-rights-management-drm-dynamic-delivery">Dynamic Delivery</a> is currently in Limited Availability. Contact your account manager if you are interested in converting your account to Dynamic Delivery.
</aside>
        </section>

        <section class="bcls-section">
          <h2 id="Overview">Overview</h2>
          <p>
            Dynamic Delivery with Server-Side Ad Insertion (SSAI) offers a Storage API for tracking specific playback sessions to validate ad variable replacements, request/response, beacons, ad processing, and the transformations of an ad response.
          </p>
          <p>
            Due to large amounts of data, enabling tracing requires a tracing token to be appended to specific playback requests for logging.
          </p>
          <aside class="bcls-aside bcls-aside--information">SSAI logging is session based and uses parameters for a particular session. Itâ€™s critical to test in an environment that best represents your needs to debug including, geography, page variables, playback device, etc.</aside>
          <p>
            To debug server-side ads with your video content stored in Video Cloud, follow these steps:
          </p>
          <ol>
            <li>
              Initiate a trace
            </li>
            <li>
              Retrieve detailed trace information from the Storage API
            </li>
            <!-- <li><a href="#Initiating_a_trace">Initiating a trace</a></li>
            <li><a href="#Retrieving_trace_information">Retrieving trace information</a></li> -->
          </ol>
      </section>

      <section class="bcls-section">
      	<h2 id="Initiating_a_trace">Initiating a trace</h2>
        <p>
          To initiate a trace on your server-side ads, do the following:
        </p>
        <ol class="bcls-tasklist">
          <li>
            <p>
              Select a VMAP or direct SSAI URL.
            </p>
            <aside class="bcls-aside bcls-aside--warning">This can not be a URL returned from a VMAP response.</aside>
          </li>
          <li>
            Initiate a trace by appending an X-Trace token to the URL:
            <pre class="line-numbers"><code class="language-http">?trace_token=<span class="bcls-input">{xtrace_token}</span></code></pre>
          </li>
          <li>
            <p>
              Select the <code>session_id</code> from the <code>contentURI</code> within the VMAP response. The <code>session_id</code> is the third UUID within the <code>contentURI</code>.
            </p>
            <pre class="line-numbers"><code class="language-xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;vmap:VMAP xmlns:uo=&quot;uo&quot; xmlns:vmap=&quot;http://www.iab.net/vmap-1.0&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; version=&quot;1.0&quot;&gt;
    &lt;vmap:Extensions&gt;
        &lt;uo:unicornOnce ttl=&quot;1800&quot;
        <span class="bcls-highlight">contenturi</span>=&quot;...hls/v3/clear/accountid/
        58dea85e-a79d-4db8-be24-7bec49fe184b/
        36ed81a5-f5b7-4977-a1a0-2ab19ccab44a/
        <span class="bcls-highlight">24ff03dc-9a94-4979-8cfb-e3951f6a707a</span>/content.m3u8...&quot;
        contentlength=&quot;146.1760&quot; payloadlength=&quot;236.5660&quot;
        contenttype=&quot;application/x-mpegURL&quot;&gt;
        &lt;/uo:unicornOnce&gt;
    &lt;/vmap:Extensions&gt;
    &lt;vmap:AdBreak breakType=&quot;linear&quot; breakId=&quot;PreRoll_0_0&quot; timeOffset=&quot;start&quot;&gt;
        &lt;vmap:AdSource allowMultipleAds=&quot;true&quot; followRedirects=&quot;true&quot; id=&quot;0&quot;&gt;
            &lt;vmap:VASTData&gt;
...
</code></pre>
          </li>
          <li>
            If you haven't already done so, follow <a href="http://docs.brightcove.com/en/staging/ssai-bcplayer.html">these steps</a> to confugire your Brightcove player with an ad configuration and the Once UX plugin.
          </li>
        </ol>
      </section>

      <section class="bcls-section">
        <h2 id="Understanding_trace_retrieval">Understanding trace retrieval</h2>
        <p>
          The following information pertains to all Storage API requests.
        </p>

        <h4>Base URL</h4>

        <p>The base URL for the Storage API is:</p>

        <pre class="line-numbers">
        <code class="language-http">https://ssaiplayback.prod.boltdns.net/storage-api/v1/</code></pre>

        <!-- <h4>Account path</h4>

        <p>In all cases, requests will be made for a specific Video Cloud Account. So, you will always add the term <code>accounts</code> followed by your account id to the base URL:</p>

        <pre class="line-numbers">
        <code class="language-http">https://ssai.api.brightcove.com/v1<strong>/accounts/{account_id}</strong></code></pre> -->

        <h4>Authentication</h4>

        <p>Authentication for requests requires an Authorization header:</p>

        <pre class="line-numbers">
        <code class="language-http">Authorization: X-Trace-Token : <span class="bcls-input">{xtrace_token}</span></code></pre>

        <p>The <code>xtrace_token</code> is a temporary OAuth2 access token that must be obtained from the Brightcove OAuth service. For details on how to obtain client credentials and use them to retrieve access tokens, see the <a href="/node/17928">Brightcove OAuth Overview</a>.</p>

        <h4>Operations</h4>

        <p>When you request client credentials, you will need to specify the type of account access or operations that you want. The following is a list of the currently supported operations for the Storage API:</p>

        <ul>
          <li>Video data:
          <p><code>video-cloud/video/read</code><br />
            <code>video-cloud/video/all</code><br />
            <!-- <code>video-cloud/video/update</code><br />
            <code>video-cloud/video/delete</code><br />
            <code>video-cloud/video/all</code><br />
            <code>video-cloud/video/assets/read</code><br />
            <code>video-cloud/video/assets/create</code><br />
            <code>video-cloud/video/assets/update</code><br />
            <code>video-cloud/video/assets/delete</code> -->
          </p>
          </li>
        </ul>
    </section>

    <section class="bcls-section">
      <h2 id="Retrieving_ad-call_trace_info">Retrieving ad-call trace info</h2>
      <p>
        Retrieve ad-call trace information, including headers, made against the ad server.
      </p>

      <table class="bcls-table">
        <tbody class="bcls-table__body">
          <tr>
            <th>Method</th>
            <td>GET</td>
          </tr>
          <tr>
            <th>URL</th>
            <td>https://ssaiplayback.prod.boltdns.net/storage-api/v1/ad-calls/<span class="bcls-input">{account_id}</span>/<span class="bcls-input">{session_id}</span></td>
          </tr>
          <tr>
            <th rowspan="2">Headers</th>
            <td>Authorization: X-Trace-Token : <span class="bcls-input">{xtrace_token}</span></td>
          </tr>
          <tr>
            <td>Content-Type: application/json</td>
          </tr>
          <!-- <tr>
      			<th>Sample Body</th>
      			<td>
      			<pre><code>{
      &quot;name&quot;: &quot;VMAP Ad Server - updated&quot;
      }</code></pre>
              <p>
                Base 64 encoded payload of the ad server response that would include the VAST or ad server equivalent response body.
              </p>
      			</td>
      		</tr> -->
        </tbody>
      </table>
      <p>
        Sample response:
      </p>
      <!-- <pre class="line-numbers"><code class="language-json">[
      {
        &quot;name&quot;: &quot;VMAP Ad Server&quot;,
        &quot;vmap_response_namespace&quot;: &quot;uo&quot;,
        &quot;config_id&quot;: &quot;2ecc6beb-d6a4-4deb-a78e-37ac27e0f883&quot;,
        &quot;account_id&quot;: &quot;57838016001&quot;,
        &quot;created_timestamp&quot;: &quot;2017-07-24T19:28:34.976878586Z&quot;,
        &quot;updated_timestamp&quot;: &quot;2017-07-24T19:28:34.976878586Z&quot;,
        &quot;ad_config&quot;: {
            &quot;expected_ad_response&quot;: &quot;dfp_ad_rules&quot;,
            &quot;disable_server_beacons&quot;: false,
            &quot;template_url&quot;: {
                &quot;template&quot;: &quot;https://8sgl4oo6of.execute-api.us-west-2.amazonaws.com/qa/ads/dfp-ad-rules-new?ip={{ system.ip_address }}&amp;vid={{ metadata.video_id }}&amp;ppid={{ system.unique_user_id }}&amp;p_vmap={{ url.p_vmap }}&quot;
            }
        }
      }
      ]</code></pre> -->

         <br />
      </section>

      <section class="bcls-section">
        <h2 id="Retrieving_beacon_trace_info">Retrieving beacon trace info</h2>
        <p>
          Retrieve beacon trace information, including headers, made against the ad server.
        </p>

        <table class="bcls-table">
          <tbody class="bcls-table__body">
            <tr>
              <th>Method</th>
              <td>GET</td>
            </tr>
            <tr>
              <th>URL</th>
              <td>https://ssaiplayback.prod.boltdns.net/storage-api/v1/beacons/<span class="bcls-input">{account_id}</span>/<span class="bcls-input">{session_id}</span></td>
            </tr>
            <tr>
              <th rowspan="2">Headers</th>
              <td>Authorization: X-Trace-Token : <span class="bcls-input">{xtrace_token}</span></td>
            </tr>
            <tr>
              <td>Content-Type: application/json</td>
            </tr>
            <!-- <tr>
              <th>Sample Body</th>
              <td>
              <pre><code>{
        &quot;name&quot;: &quot;VMAP Ad Server - updated&quot;
        }</code></pre>
                <p>
                  Base 64 encoded payload of the ad server response that would include the VAST or ad server equivalent response body.
                </p>
              </td>
            </tr> -->
          </tbody>
        </table>
        <p>
          Sample response:
        </p>
        <!-- <pre class="line-numbers"><code class="language-json">[
        {
          &quot;name&quot;: &quot;VMAP Ad Server&quot;,
          &quot;vmap_response_namespace&quot;: &quot;uo&quot;,
          &quot;config_id&quot;: &quot;2ecc6beb-d6a4-4deb-a78e-37ac27e0f883&quot;,
          &quot;account_id&quot;: &quot;57838016001&quot;,
          &quot;created_timestamp&quot;: &quot;2017-07-24T19:28:34.976878586Z&quot;,
          &quot;updated_timestamp&quot;: &quot;2017-07-24T19:28:34.976878586Z&quot;,
          &quot;ad_config&quot;: {
              &quot;expected_ad_response&quot;: &quot;dfp_ad_rules&quot;,
              &quot;disable_server_beacons&quot;: false,
              &quot;template_url&quot;: {
                  &quot;template&quot;: &quot;https://8sgl4oo6of.execute-api.us-west-2.amazonaws.com/qa/ads/dfp-ad-rules-new?ip={{ system.ip_address }}&amp;vid={{ metadata.video_id }}&amp;ppid={{ system.unique_user_id }}&amp;p_vmap={{ url.p_vmap }}&quot;
              }
          }
        }
        ]</code></pre> -->

           <br />
        </section>


			</article>


      <!-- END DRUPAL CONTENT -->
		</div>
	</div>
	<!-- bcl scripts -->
  <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.2.3/jquery.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/fastclick/1.0.6/fastclick.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/foundation/5.5.3/js/foundation.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/handlebars.js/4.0.5/handlebars.min.js"></script>
  <script src="/en/scripts/docs-nav-data.min.js"></script>
  <script src="/en/scripts/bcls-doc-site-v0.js"></script>
  <script src="//learning-services-media.brightcove.com/doc-assets/js/bcls-utils.js"></script>
  <script src="//learning-services-media.brightcove.com/doc-assets/js/prism/prism.js"></script>
  <script>
  $(document).foundation();
  </script>
  <!-- Any scripts specific to page samples should go here -->
</body>

</html>
