<!DOCTYPE html>
<html lang="en">

<head>
    <!-- Begin Drupal Taxonomy Data -->
    <meta name="products" content="Video Cloud, Brightcove Player">
    <meta name="role" content="Device SDK Developer">
    <meta name="task" content="Develop with the Native SDKs">
    <meta name="topic" content="Troubleshooting/Error Handling">
    <meta name="sdk" content="iOS,tvOS,Android">
    <meta name="keywords" content="device,SDK,FAQ">
    <!-- End Drupal Taxonomy Data -->

    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  	<meta name="viewport" content="initial-scale=1.0, maximum-scale=1.0, user-scalable=no, width=device-width" />
    <meta name="robots" content="noindex">
  	<!-- change title to match the h1 heading -->
  	<title>Quick Start: Create a Simple Video App using Swift</title>

    <link rel="stylesheet" type="text/css" href="//cdnjs.cloudflare.com/ajax/libs/foundation/5.5.3/css/foundation.min.css" />
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/foundation/5.5.3/css/normalize.css" />
    <link href="//fonts.googleapis.com/css?family=Open+Sans:400italic,700italic,400,700" rel="stylesheet" type="text/css">
    <script src="//use.edgefonts.net/source-code-pro.js"></script>
    <link rel="stylesheet" href="//learning-services-media.brightcove.com/doc-assets/js/prism/prism.css">
    <link rel="stylesheet" href="//docs.brightcove.com/en/styles/template-less/css/bcls-doc.css">
    <link rel="stylesheet" href="/en/styles/foundation-fixes.css">

    <script src="//cdnjs.cloudflare.com/ajax/libs/foundation/5.5.3/js/vendor/modernizr.js"></script>

</head>

<body>
	<!-- header navbar -->
	<div id="navWrapper" class="fixed"></div>
	<!-- breadcrumbs -->
	<nav id="breadCrumbWrapper" class="breadcrumbs show-for-medium-up"></nav>
	<!-- search -->
	<div id="searchModal" class="reveal-modal" data-reveal></div>
	<!-- content -->
	<div class="row">
		<div class="sidebar large-2 columns show-for-large-up">
			<div id="sidenav" class="side-nav"></div>
		</div>
		<div id="main" class="large-10 small-12 columns">
			<h1>Quick Start: Create a Simple Video App using Swift</h1>
      <aside class="bcls-aside bcls-aside--warning">This is a temporary STAGING document for review only. For the official Brightcove documentation site, go to <a href="https://support.brightcove.com/">support.brightcove.com</a></aside>
      <p>In this topic, you will learn how to build a simple video playback app using the Brightcove Player SDK for iOS. You will build it using the Swift programming language.</p>


	    <!-- BEGIN DRUPAL CONTENT -->

      <article class="bcls-article">
<section class="bcls-section">
<h2 id="Overview">Overview</h2>

<p class="video-cloud-only">This example plays a video returned from the <a href="/node/17906">Brightcove Playback API</a>, which is the latest and recommended API to retrieve content from your Video Cloud library.</p>

<p class="video-cloud-only">For this option, you will need a Policy Key. If you are not familiar with Policy Keys, see <a href="/node/18003">Policy API Overview</a>.</p>

<aside class="bcls-aside bcls-aside--tip">This example is written in Swift 3.0, but you can also experiment with Objective-C. See the following:
<ul>
	<li><a href="/node/18219">Quick Start: Create a Simple Video App using Obj-C</a></li>
	<li><a href="https://github.com/BrightcoveOS/ios-player-samples/tree/master/Player/VideoCloudBasicPlayer/objc">Obj-C version of the VideoCloudBasicPlayer</a></li>
</ul>
</aside>
</section>

<section class="bcls-section">
<h2 id="Get_started">Get started</h2>

<p class="player-only">This example plays videos from an internal array of video files.</p>

<p class="video-cloud-only">There are two ways to try out this sample:</p>

<p class="player-only">Follow the steps below to get familiar with setting up an app project that uses the Brightcove Player SDK for iOS. You can view the complete code for each of the following:</p>

<ol>
	<li class="video-cloud-only">Follow the steps below to get familiar with setting up an app project that uses the Brightcove Player SDK for iOS. You can view the complete code for each of the following:
	<ul>
		<li><a href="#appdelegate">AppDelegate</a></li>
		<li class="video-cloud-only"><p>
      <a href="#viewController">ViewController</a>
    </p></li>
		<li class="player-only"><p>
      <a href="#viewControllerPerform">ViewController</a>
    </p></li>
	</ul>
	</li>
	<li class="video-cloud-only">Download the entire Xcode project for experimentation.
	<ol class="video-cloud-only" type="a">
		<li>
		Download the <a href="https://github.com/BrightcoveOS/ios-player-samples/tree/master/Player/VideoCloudBasicPlayer/swift">VideoCloudBasicPlayer</a> sample to your local system.
		</li>
		<li>Run the <code>pod install</code> command.</li>
		<li>Open and run the newly created workspace.</li>
	</ol>
	</li>
</ol>
</section>

<section class="bcls-section">
<h2 id="Create_the_project">Create the project</h2>

<p>Set up a project in Xcode. Then add the SDK along with any dependencies to the project.</p>

<h3>Set up the Xcode project</h3>

<p>Create a new Xcode project for the app.</p>

<ol class="bcls-tasklist">
	<li>
	<p>Start the creation of a new iOS project in Xcode. Select <strong>Create a new Xcode project</strong>.</p>

	<figure class="bcls-figure"><img class="bcls-image--no-border" alt="Create project" src="//learning-services-media.brightcove.com/doc-assets/device-sdks/ios/getting-started/quick-start-swift/quick-start-welcome.png" />
	<figcaption class="bcls-caption--image">Create project</figcaption>
	</figure>
	</li>
	<li>
	<p>Choose <strong>Single View Application</strong> for the template and select <strong>Next</strong>.</p>

	<figure class="bcls-figure"><img class="bcls-image--no-border" alt="Choose the project template" src="//learning-services-media.brightcove.com/doc-assets/device-sdks/ios/getting-started/quick-start-swift/quick-start-choose-project-template.png" />
	<figcaption class="bcls-caption--image">Choose the project template</figcaption>
	</figure>
	</li>
	<li>
	<p>Set the project information as follows:</p>

	<ul>
		<li><strong>Product Name:</strong> Simple-Video-Playback</li>
		<li><strong>Team:</strong> none
		<p>The Team field is optional. If you want to distribute your app on the App Store, you will need to select a team that you belong to through the Apple Developer Program. The team name is required for code signing. In this example, we'll select none.</p>
		</li>
		<li><strong>Organization Name:</strong> your company name</li>
		<li><strong>Organization Identifier:</strong> com.example-company<br />
		This makes the product name unique for the app store.</li>
		<li><strong>Language:</strong> Swift</li>
	</ul>

	<figure class="bcls-figure"><img class="bcls-image--no-border" alt="Add project information" src="//learning-services-media.brightcove.com/doc-assets/device-sdks/ios/getting-started/quick-start-swift/project-options.png" />
	<figcaption class="bcls-caption--image">Add project information</figcaption>
	</figure>
	</li>
	<li>
	<p>Choose the location where you want to save your project and create it.</p>

	<figure class="bcls-figure"><img class="bcls-image--no-border" alt="Save project" src="//learning-services-media.brightcove.com/doc-assets/device-sdks/ios/getting-started/quick-start-swift/workspace.png" />
	<figcaption class="bcls-caption--image">Save project</figcaption>
	</figure>
	</li>
	<li>Now close the project (yes, close it â€” this is important!)</li>
</ol>

<h3 id="dependencies">Add the SDK and its dependencies to your project</h3>

<p>The easiest way to add the SDK and its dependencies to your project is to use CocoaPods.</p>

<p>CocoaPods is a dependency manager that adds libraries to your project. It is not required, but makes installation easier. To install CocoaPods, see the instructions on the <a href="//cocoapods.org">CocoaPods</a> site.</p>

<aside class="bcls-aside bcls-aside--warning">
<ul>
	<li>CocoaPods version 1.0 or newer is required.</li>
	<li>Using CocoaPods (the <code>pod</code> tool) on an existing Xcode project will modify the project file. You may want to make a backup before doing this.</li>
</ul>
</aside>

<ol class="bcls-tasklist">
	<li>
	<p>In your project folder, create a plain text file called <strong>Podfile</strong> (no file extension).</p>
	</li>
	<li>
	<p>Using a text editor, add the following lines of code to the Podfile and save it. This code does the following:</p>

	<ul>
		<li>Line 1: Points to the GitHub location for the Brightcove pod specs.</li>
		<li>Line 3: Sets Pods to use frameworks instead of static libraries.</li>
		<li>Line 5: Defines the iOS platform version.</li>
		<li>Lines 7-9: Install the current version of the Brightcove player SDK.</li>
	</ul>

	<pre class="line-numbers" data-start="1">
<code class="language-swift">source 'https://github.com/brightcove/BrightcoveSpecs.git'

use_frameworks!

platform :ios, '10.0' # (or whatever version you want)

target 'Simple-Video-Playback' do
	pod 'Brightcove-Player-Core/dynamic'
end</code></pre>

	<aside class="bcls-aside bcls-aside--information">The <code>target</code> property is used for CocoaPods version 1.0 and newer.</aside>
	</li>
	<!--							<p class="text-warning">ReactiveCocoa will be added to your project as a part of the Brightcove SDK.</p>-->
	<li>
	<p>Open a Terminal session and navigate to your <strong>Simple-Video-Playback</strong> Xcode project folder.</p>

	<figure class="bcls-figure"><img class="bcls-image--no-border" alt="Terminal session" src="//learning-services-media.brightcove.com/doc-assets/device-sdks/ios/getting-started/quick-start-swift/quick-start-terminal.png" />
	<figcaption class="bcls-caption--image">Terminal session</figcaption>
	</figure>
	</li>
	<li>
	<p>In the Terminal session, type the command</p>

	<pre class="line-numbers" data-start="1">
<code class="language-swift">pod install</code></pre>

	<p>and press <strong>Return</strong> to run the it. You should see a series of messages in the terminal indicating that the Brightcove Player SDK has been added to your project.</p>
	</li>
	<li>
	<p><strong>Notice the last line</strong>, which is important â€” from this point on, you must open the <em>Simple-Video-Playback.xcworkspace</em> file in Xcode, <strong>not</strong> the <em>Simple-Video-Playback.xcodeproj</em> file. The <code>pod install</code> command creates this <code>.xcworkspace</code> file for your project.</p>
	</li>
</ol>

<aside class="bcls-aside bcls-aside--tip">
<ul>
	<li>If you create and edit Podfiles on a regular basis, you can try using the <a href="https://cocoapods.org/app">CocoaPods App</a> to complete the previous steps.</li>
	<li>If you don't want to use CocoaPods , you can <a href="https://github.com/brightcove/brightcove-player-sdk-ios/releases">download the latest version of the SDK</a> and manually add it to your project.</li>
</ul>
</aside>
</section>

<section class="bcls-section">
<h2 id="Code_the_video_app">Code the video app</h2>

<p>Create the code for a simple video playback app.</p>

<ol class="bcls-tasklist">
	<li>In Xcode, open the <strong>Simple-Video-Playback.xcworkspace</strong> file.</li>
</ol>

<h3 id="appdelegate">Set the audio behavior for the app</h3>

<p>The audio session handles audio behavior at the app level. Learn more about the <a href="https://developer.apple.com/library/ios/documentation/Audio/Conceptual/AudioSessionProgrammingGuide/Introduction/Introduction.html">AVAudioSession</a> class.</p>

<aside class="bcls-aside bcls-aside--tip">You can choose from several audio session categories and settings to customize your app's audio behavior. <a href="https://developer.apple.com/library/ios/documentation/Audio/Conceptual/AudioSessionProgrammingGuide/AudioSessionBasics/AudioSessionBasics.html#//apple_ref/doc/uid/TP40007875-CH3-SW1">Choose the best audio session category</a> for your app.</aside>

<p>For this sample, we will use <code>AVAudioSessionCategoryPlayback</code>. This plays audio even when the screen is locked and with the Ring/Silent switch set to silent. To keep it simple, we will put the code for this in the App Delegate.</p>

<ol class="bcls-tasklist">
	<li>
	<p>In your project, open the App Delegate file (<strong>AppDelegate.swift</strong>).</p>
	</li>
	<li>
	<p>In the <code>didFinishLaunchingWithOptions</code> function, add code to set the audio session category. Make sure you import the <code>AVFoundation</code> framework.</p>

	<ul>
		<li>We need the code below in order to ensure that audio plays back when we expect it to. For example, without setting this code, we won't hear the video when the mute switch is on.</li>
		<li>For simplicity in the sample, we are putting this in the app delegate. For more information about how to use this in your own app, see the <a href="https://developer.apple.com/library/content/documentation/Audio/Conceptual/AudioSessionProgrammingGuide/Introduction/Introduction.html">Audio Session Programming Guide</a>.</li>
	</ul>

	<pre class="line-numbers" data-start="1">
<code class="language-swift">//
//  AppDelegate.swift
//  Simple-Video-Playback
//
//  Created by on 9/28/17.
//  Copyright Â© 2017 Brightcove. All rights reserved.
//

import UIKit
<span class="bcls-highlight">import AVFoundation</span>

@UIApplicationMain
class AppDelegate: UIResponder, UIApplicationDelegate {

	var window: UIWindow?

	func application(_ application: UIApplication, didFinishLaunchingWithOptions launchOptions: [UIApplicationLaunchOptionsKey: Any]?) -&gt; Bool {
		// Override point for customization after application launch.

<span class="bcls-highlight">       var categoryError :NSError?
		var success: Bool
		do {
			try AVAudioSession.sharedInstance().setCategory(AVAudioSessionCategoryPlayback)
			success = true
		} catch let error as NSError {
			categoryError = error
			success = false
		}

		if !success {
			print("AppDelegate Debug - Error setting AVAudioSession category.  Because of this, there may be no sound. \(categoryError!)")
		}</span>

		return true
	}

	func applicationWillResignActive(_ application: UIApplication) {
		// Sent when the application is about to move from active to inactive state. This can occur for certain types of temporary interruptions (such as an incoming phone call or SMS message) or when the user quits the application and it begins the transition to the background state.
		// Use this method to pause ongoing tasks, disable timers, and invalidate graphics rendering callbacks. Games should use this method to pause the game.
	}

	func applicationDidEnterBackground(_ application: UIApplication) {
		// Use this method to release shared resources, save user data, invalidate timers, and store enough application state information to restore your application to its current state in case it is terminated later.
		// If your application supports background execution, this method is called instead of applicationWillTerminate: when the user quits.
	}

	func applicationWillEnterForeground(_ application: UIApplication) {
		// Called as part of the transition from the background to the active state; here you can undo many of the changes made on entering the background.
	}

	func applicationDidBecomeActive(_ application: UIApplication) {
		// Restart any tasks that were paused (or not yet started) while the application was inactive. If the application was previously in the background, optionally refresh the user interface.
	}

	func applicationWillTerminate(_ application: UIApplication) {
		// Called when the application is about to terminate. Save data if appropriate. See also applicationDidEnterBackground:.
	}

}</code></pre>
	<!-- <p><code data-gist-id="ffab3777678c48c7212d" data-gist-line="1-62" data-gist-highlight-line="9,23-35"></code></p> --></li>
</ol>

<h3>Build the View Controller</h3>

<p>Update the View Controller class to play a video from the Brightcove catalog service.</p>

<ol class="bcls-tasklist">
	<li>
	<p>In your project, open the View Controller file (<strong>ViewController.swift</strong>).</p>
	</li>
</ol>

<div class="video-cloud-only">
<h4>Import the Native SDK</h4>

<p>Although the Brightcove Native Player SDK for iOS is written in Obj-C, we can simply import the framework modules into our Swift project.</p>

<ol class="bcls-tasklist">
	<li>
	<p>Below the existing <code>import</code> directive, add the following to import the Brightcove Native Player SDK:</p>

	<pre class="line-numbers" data-start="9">
<code class="language-swift">import BrightcovePlayerSDK</code></pre>
	</li>
	<!-- <p><code data-gist-id="ffab3777678c48c7212d" data-gist-line="158" data-gist-hide-footer="true"></code></p> -->
</ol>

<h4>Customize the project with your values</h4>

<p>Add values to access your Video Cloud account.</p>

<aside class="bcls-aside bcls-aside--tip">This example plays a video returned from the <a href="/node/17906">Brightcove Playback API</a>, which is the latest and recommended API to retrieve content from your Video Cloud library. If you are not familiar with Policy Keys, see the <a href="/node/18003">Policy API Overview</a>.</aside>

<ol class="bcls-tasklist">
	<li>
	<p>Below the <code>import</code> directives, add your own values for the following:</p>

	<ul>
		<li>Line 12: Defines your Brightcove Playback API Policy Key</li>
		<li>Line 13: Defines your Video Cloud Account ID</li>
		<li>Line 14: Defines your Video Cloud Video ID</li>
	</ul>

	<pre class="line-numbers" data-start="11">
<code class="language-swift">// ** Customize these values with your own account information **
let kViewControllerPlaybackServicePolicyKey = "BCpkADawqM2NZcfpTGYMHaafJU597X9J0XTvw8CXZcMITep7BFNYHFKGz3XJQfYzudYCp9GWn3u18OQdlqJxSKFrIipF4Ndx9umqQ5EtUaAn_oTXaQgIs1lAe4-FciLISBFDCTAA3j2qALp8"
let kViewControllerAccountID = "3636334163001"
let kViewControllerVideoID = "3637773814001"</code></pre>
	</li>
	<!-- <p><code data-gist-id="ffab3777678c48c7212d" data-gist-line="153-156"></code></p> -->
</ol>

<h4>Set the class delegate</h4>

<p>This allows your app to listen and respond to video playback events and player control events.</p>

<ol class="bcls-tasklist">
	<li>
	<p>Update the View Controller class as follows:</p>

	<pre class="line-numbers" data-start="16">
<code class="language-swift">class ViewController: UIViewController, BCOVPlaybackControllerDelegate {
</code></pre>
	</li>
	<!-- <p><code data-gist-id="ffab3777678c48c7212d" data-gist-line="158" data-gist-hide-footer="true"></code></p> -->
</ol>

<h4>Declare constants and set the view</h4>

<ol class="bcls-tasklist">
	<li>
	<p>In the <code>ViewController</code> class, add the following :</p>

	<ul>
		<li>Line 18: Defines a constant, which initializes the Brightcove playback service with your Account ID and Policy Key. The <a href="https://brightcovelearning.github.io/Brightcove-API-References/ios-sdk/Classes/BCOVPlaybackService.html"><code>BCOVPlaybackService</code></a> class provides asynchronous methods for retrieving data from the Playback API.</li>
		<li>Line 19: Defines a constant for the playback controller. The <a href="https://brightcovelearning.github.io/Brightcove-API-References/ios-sdk/Protocols/BCOVPlaybackController.html"><code>BCOVPlaybackController</code></a> has methods to control playback functionality.</li>
		<li>
		<p>Line 20: Defines a variable for the view.</p>
		</li>
	</ul>

	<pre class="line-numbers" data-start="16">
<code class="language-swift">class ViewController: UIViewController, BCOVPlaybackControllerDelegate {
	let playbackService = BCOVPlaybackService(accountId: kViewControllerAccountID, policyKey: kViewControllerPlaybackServicePolicyKey)!
	let playbackController :BCOVPlaybackController
	@IBOutlet weak var videoContainer: UIView!</code></pre>
	<!-- <p><code data-gist-id="ffab3777678c48c7212d" data-gist-line="158-162" data-gist-highlight-line="160-162"></code></p> --></li>
</ol>

<h4>Create an init function</h4>

<ol class="bcls-tasklist">
	<li>Below the code in the previous step, create an <code>init()</code> function as follows:

	<ul>
		<li>Line 23: Initializes a shared manager. The <a href="https://brightcovelearning.github.io/Brightcove-API-References/ios-sdk/Classes/BCOVPlayerSDKManager.html"><code>BCOVPlayerSDKManager</code></a> class is a singleton that allows you to create other objects in the SDK ecosystem.</li>
		<li>Line 24: Uses the shared manager to create a playback controller.</li>
		<li>
		<p>Line 25: <strong>Optional:</strong> Sends your Video Cloud Account ID to analytics. This is only needed if you override the <code>BCOVVideo</code> class or do not use the Brightcove Playback service or catalog.</p>

		<aside class="bcls-aside bcls-aside--tip">For details about sending data to Video Cloud Analytics, see the <a href="/node/18214">Using Brightcove Analytics</a> guide.</aside>
		</li>
		<li>
		<p>Lines 30-32: set the delegate and turn on the auto-advance and autoplay features.</p>
		</li>
	</ul>

	<pre class="line-numbers" data-start="22">
<code class="language-swift"> required init?(coder aDecoder: NSCoder) {
	let manager = BCOVPlayerSDKManager.shared()!
	playbackController = manager.createPlaybackController()

	super.init(coder: aDecoder)

	playbackController.analytics.account = kViewControllerAccountID

	playbackController.delegate = self
	playbackController.isAutoAdvance = true
	playbackController.isAutoPlay = true
}</code></pre>
	<!-- <p><code data-gist-id="ffab3777678c48c7212d" data-gist-line="164-175"></code></p>  --></li>
</ol>

<h4>Configure the player</h4>

<ol class="bcls-tasklist">
	<li>
	<p>In the <code>viewDidLoad()</code> function, add the following:</p>

	<ul>
		<li>Lines 40-41: Create and set the options for the player view.</li>
		<li>Lines 44-45: Create and set the Brightcove player controls.</li>
		<li>Lines 47-49: Configure the playback controller's view.</li>
		<li>Line 51: Adds the player view as a subview of the main view.</li>
		<li>Line 53: Calls the <code>requestContentFromPlaybackService</code> function, which you will define in the next step.</li>
	</ul>

	<pre class="line-numbers" data-start="35">
<code class="language-swift">override func viewDidLoad() {
	super.viewDidLoad()
	// Do any additional setup after loading the view, typically from a nib.

	// Create and set options
	let options = BCOVPUIPlayerViewOptions()
	options.presentingViewController = self

	// Create and configure Control View
	let controlsView = BCOVPUIBasicControlView.withVODLayout()
	let playerView = BCOVPUIPlayerView.init(playbackController: playbackController, options: options, controlsView: controlsView)!

	playerView.delegate = self
	playerView.frame = videoContainer.bounds
	playerView.autoresizingMask = [.flexibleHeight, .flexibleWidth]

	videoContainer.addSubview(playerView)

	requestContentFromPlaybackService()
}</code></pre>
	<!-- <p><code data-gist-id="ffab3777678c48c7212d" data-gist-line="177-185" data-gist-hide-footer="true" data-gist-highlight-line="180-184"></code></p> --></li>
</ol>

<h4>Request content from the Brightcove library</h4>

<p>In order to play back video content, you will request a playlist from the catalog service</p>

<ol class="bcls-tasklist">
	<li>
	<p>Below the <code>viewDidLoad()</code> function, create a function named <code>requestContentFromPlaybackService()</code> as follows:</p>

	<ul>
		<li>Line 57: Returns a video object from the Playback API based on the given video id.</li>
		<li>Line 60: Adds the video to the playback controller.</li>
		<li>Line 64: Writes an error message if a playlist is not returned.</li>
	</ul>

	<pre class="line-numbers" data-start="56">
<code class="language-swift"> func requestContentFromPlaybackService() {
	playbackService.findVideo(withVideoID: kViewControllerVideoID, parameters: nil) {
		(video: BCOVVideo?, dict: [AnyHashable:Any]?, error: Error?) in
		if let v = video {
			self.playbackController.setVideos([v] as NSFastEnumeration!)
		} else {
			print("ViewController Debug - Error retrieving video: %@", error!)
		}
	}
}</code></pre>
	<!-- <p><code data-gist-id="ffab3777678c48c7212d" data-gist-line="187-198"></code></p> --></li>
</ol>
<!--
						<h4>The rest</h4>
						<ol start="10">
							<li><p>Create a function to handle when the playback session advances.</p></li>
							<p><code data-gist-id="ffab3777678c48c7212d" data-gist-line="123-125" data-gist-hide-footer="true"></code></p>
							<li><p>Create a function to set the status bar style.</p></li>
							<p><code data-gist-id="ffab3777678c48c7212d" data-gist-line="129-131" data-gist-hide-footer="true"></code></p>
						</ol>
-->

<h4 id="viewController">View the code</h4>

<p>The View Controller is now complete. Here is the full code:</p>

<pre class="line-numbers" data-start="1">
<code class="language-swift">//  ViewController.swift
//  Simple-Video-Playback
//
//  Created by on 9/28/17.
//  Copyright Â© 2017 Brightcove. All rights reserved.
//

import UIKit
import BrightcovePlayerSDK

// ** Customize these values with your own account information **
let kViewControllerPlaybackServicePolicyKey = "BCpkADawqM2NZcfpTGYMHaafJU597X9J0XTvw8CXZcMITep7BFNYHFKGz3XJQfYzudYCp9GWn3u18OQdlqJxSKFrIipF4Ndx9umqQ5EtUaAn_oTXaQgIs1lAe4-FciLISBFDCTAA3j2qALp8"
let kViewControllerAccountID = "3636334163001"
let kViewControllerVideoID = "3637773814001"

class ViewController: UIViewController, BCOVPlaybackControllerDelegate {

	let playbackService = BCOVPlaybackService(accountId: kViewControllerAccountID, policyKey: kViewControllerPlaybackServicePolicyKey)!
	let playbackController :BCOVPlaybackController
	@IBOutlet weak var videoContainer: UIView!

	required init?(coder aDecoder: NSCoder) {
		let manager = BCOVPlayerSDKManager.shared()!
		playbackController = manager.createPlaybackController()

		super.init(coder: aDecoder)

		playbackController.analytics.account = kViewControllerAccountID

		playbackController.delegate = self
		playbackController.isAutoAdvance = true
		playbackController.isAutoPlay = true
	}

	override func viewDidLoad() {
		super.viewDidLoad()
		// Do any additional setup after loading the view, typically from a nib.

		// Create and set options
		let options = BCOVPUIPlayerViewOptions()
		options.presentingViewController = self

		// Create and configure Control View
		let controlsView = BCOVPUIBasicControlView.withVODLayout()
		let playerView = BCOVPUIPlayerView.init(playbackController: playbackController, options: options, controlsView: controlsView)!

		playerView.delegate = self
		playerView.frame = videoContainer.bounds
		playerView.autoresizingMask = [.flexibleHeight, .flexibleWidth]

		videoContainer.addSubview(playerView)

		requestContentFromPlaybackService()
	}

	func requestContentFromPlaybackService() {

		playbackService.findVideo(withVideoID: kViewControllerVideoID, parameters: nil) {
			(video: BCOVVideo?, dict: [AnyHashable:Any]?, error: Error?) in
			if let v = video {
				self.playbackController.setVideos([v] as NSFastEnumeration!)
			} else {
				print("ViewController Debug - Error retrieving video: %@", error!)
			}
		}
	}

	override func didReceiveMemoryWarning() {
		super.didReceiveMemoryWarning()
		// Dispose of any resources that can be recreated.
	}

}</code></pre>
<!-- <p><code data-gist-id="ffab3777678c48c7212d" data-gist-line="143-205"></code></p> --></div>
<!--class="video-cloud-only"-->

<div class="player-only">
<h4>Import the Native SDK</h4>

<p>Although the Brightcove Native Player SDK for iOS is written in Obj-C, we can simply import the framework modules into our Swift project.</p>

<ol class="bcls-tasklist">
	<li>
	<p>Below the existing <code>import</code> directive, add the following to import the Brightcove Native Player SDK:</p>

	<pre class="line-numbers" data-start="8">
	<code class="language-swift">import BrightcovePlayerSDK
	</code></pre>
	</li>
	<!-- <p><code data-gist-id="ffab3777678c48c7212d" data-gist-line="158" data-gist-hide-footer="true"></code></p> -->
</ol>

<h4>Customize the project with your values</h4>

<p>Set the value of your Account Id, which will be sent to Brightcove in a later step.</p>

<ol class="bcls-tasklist">
	<li>
	<p>Below the <code>#import</code> directives, add your own value for your Brightcove Account Id.</p>

	<pre class="line-numbers" data-start="10">
<code class="language-swift">let kViewControllerAccountID = "123456789" // for analytics</code></pre>
	</li>
	<!-- <p><code data-gist-id="aa87403235764a27cae1" data-gist-line="75" data-gist-hide-footer="true"></code></p> -->
</ol>

<h4>Set the class delegates</h4>

<p>This allows your app to listen and respond to video playback events and player control events.</p>

<ol class="bcls-tasklist">
	<li>
	<p>Update the View Controller class as follows:</p>

	<pre class="line-numbers" data-start="12">
<code class="language-swift">class ViewController: UIViewController, BCOVPlaybackControllerDelegate {</code></pre>
	</li>
	<!-- <p><code data-gist-id="aa87403235764a27cae1" data-gist-line="77" data-gist-hide-footer="true"></code></p> -->
</ol>

<h4>Declare constants and set the view</h4>

<ol class="bcls-tasklist">
	<li>
	<p>In the <code>ViewController</code> class, add the following :</p>

	<ul>
		<li>Line 14: defines a constant for the playback controller. The <a href="https://brightcovelearning.github.io/Brightcove-API-References/ios-sdk/Protocols/BCOVPlaybackController.html"><code>BCOVPlaybackController</code></a> has methods to control playback functionality.</li>
		<li>
		<p>Line 15: defines a variable for the view.</p>
		</li>
	</ul>

	<pre class="line-numbers" data-start="12">
<code class="language-swift">class ViewController: UIViewController, BCOVPlaybackControllerDelegate {

	let playbackController :BCOVPlaybackController
	@IBOutlet weak var videoContainer: UIView!</code></pre>
	</li>
	<!-- <p><code data-gist-id="aa87403235764a27cae1" data-gist-line="77-80" data-gist-hide-footer="true" data-gist-highlight-line="79-80"></code></p> -->
</ol>

<h4>Create an init function</h4>

<ol class="bcls-tasklist">
	<li>Below the code in the previous step, create an <code>init()</code> function as follows:

	<ul>
		<li>Line 18: initializes a shared manager. The <a href="https://brightcovelearning.github.io/Brightcove-API-References/ios-sdk/Classes/BCOVPlayerSDKManager.html"><code>BCOVPlayerSDKManager</code></a> class is a singleton that allows you to create other objects in the SDK ecosystem.</li>
		<li>Line 19: uses the shared manager to create a playback controller with the default view strategy.</li>
		<li>
		<p>Line 23: Sends your Video Cloud Publisher ID to analytics.</p>
		</li>
		<li>
		<p>Lines 25-27: set the delegate and turn on the auto-advance and autoplay features.</p>
		</li>
	</ul>

	<pre class="line-numbers" data-start="17">
<code class="language-swift">required init?(coder aDecoder: NSCoder) {
	let manager = BCOVPlayerSDKManager.shared()!
	playbackController = manager.createPlaybackController()

	super.init(coder: aDecoder)

	playbackController.analytics.account = kViewControllerAccountID

	playbackController.delegate = self
	playbackController.isAutoAdvance = true
	playbackController.isAutoPlay = true
}</code></pre>
	</li>
	<!-- <p><code data-gist-id="aa87403235764a27cae1" data-gist-line="82-93"></code></p> -->
</ol>

<h4>Configure the player</h4>

<ol class="bcls-tasklist">
	<li>
	<p>In the <code>viewDidLoad()</code> function, add the following:</p>

	<ul>
		<li>Lines 33-35: create an array of video sources using url paths.</li>
		<li>Lines 37-38: configure the playback controller's view.</li>
		<li>Line 39: adds the player view as a subview of the main view.</li>
		<li>Line 41: adds the video array to the controller's playback queue.</li>
		<li>Line 42: starts playback of the first video.</li>
	</ul>

	<pre class="line-numbers" data-start="30">
<code class="language-swift">override func viewDidLoad() {
	super.viewDidLoad()
	// Do any additional setup after loading the view, typically from a nib.

	// create an array of videos
	var videoArray = [AnyObject]()
	videoArray = [videoWithURL(url: NSURL(string: "http://cf9c36303a9981e3e8cc-31a5eb2af178214dc2ca6ce50f208bb5.r97.cf1.rackcdn.com/bigger_badminton_600.mp4")!),
			videoWithURL(url: NSURL(string: "http://devimages.apple.com/iphone/samples/bipbop/bipbopall.m3u8")!)]

	// Create and set options
	let options = BCOVPUIPlayerViewOptions()
	options.presentingViewController = self

	// Create and configure Control View
	let controlsView = BCOVPUIBasicControlView.withVODLayout()
	let playerView = BCOVPUIPlayerView.init(playbackController: playbackController, options: options, controlsView: controlsView)!

	playerView.delegate = self
	playerView.frame = videoContainer.bounds
	playerView.autoresizingMask = [.flexibleHeight, .flexibleWidth]

	videoContainer.addSubview(playerView)

	playbackController.setVideos(videoArray as NSFastEnumeration!)
	playbackController.play();
}</code></pre>
	<!-- <p><code data-gist-id="aa87403235764a27cae1" data-gist-line="95-108" data-gist-highlight-line="97-107"></code></p> --></li>
</ol>

<h4>Set the delivery method for video sources</h4>

<ol class="bcls-tasklist">
	<li>
	<p>Below the <code>viewDidLoad()</code> function, create a function that sets the delivery method for <code>BCOVSources</code> that belong to a video.</p>

	<pre class="line-numbers" data-start="56">
<code class="language-swift">func videoWithURL(url: NSURL) -&gt; BCOVVideo {
	// set the delivery method for BCOVSources that belong to a video
	let source:BCOVSource = BCOVSource(url: url as URL!, deliveryMethod: kBCOVSourceDeliveryHLS, properties: nil)
	let video = BCOVVideo.init(source: source, cuePoints: BCOVCuePointCollection.init(array: []), properties: [NSObject:AnyObject]())
	return video!
}</code></pre>
	</li>
	<!-- <p><code data-gist-id="aa87403235764a27cae1" data-gist-line="110-115"></code></p> -->
</ol>

<h4>The rest</h4>

<ol class="bcls-tasklist">
	<li>
	<p>Below the <code>videoWithURL()</code> function, create a function to handle when the playback session advances.</p>

	<pre class="line-numbers" data-start="63">
<code class="language-swift">private func playbackController(controller: BCOVPlaybackController!, didAdvanceToPlaybackSession session: BCOVPlaybackSession!) {
		print("ViewController Debug - Advanced to new session.")
}</code></pre>
	</li>
	<!-- <p><code data-gist-id="aa87403235764a27cae1" data-gist-line="117-119" data-gist-hide-footer="true"></code></p> --><!-- <li><p>Create a function to set the status bar style.</p>
																<pre class="line-numbers" data-start="57"><code class="language-swift">override func preferredStatusBarStyle() -&gt; UIStatusBarStyle {
		return .LightContent
}</code></pre>
														</li> --><!-- <p><code data-gist-id="aa87403235764a27cae1" data-gist-line="122-124" data-gist-hide-footer="true"></code></p> -->
</ol>

<h4 id="viewControllerPerform">View the code</h4>

<p>The View Controller is now complete. Here is the full code:</p>

<pre class="line-numbers" data-start="1">
<code class="language-swift">//
//  ViewController.swift
//  Simple Video Playback - Perform
//
//  Copyright Â© 2017 Brightcove. All rights reserved.

import UIKit
import BrightcovePlayerSDK

let kViewControllerAccountID = "123456789" // for analytics

class ViewController: UIViewController, BCOVPlaybackControllerDelegate {

	let playbackController :BCOVPlaybackController
	@IBOutlet weak var videoContainer: UIView!

	required init?(coder aDecoder: NSCoder) {
	let manager = BCOVPlayerSDKManager.shared()!
	playbackController = manager.createPlaybackController()

	super.init(coder: aDecoder)

	playbackController.analytics.account = kViewControllerAccountID

	playbackController.delegate = self
	playbackController.isAutoAdvance = true
	playbackController.isAutoPlay = true
	}

	override func viewDidLoad() {
		super.viewDidLoad()

		// Load an array of videos
		var videoArray = [AnyObject]()
		videoArray = [videoWithURL(url: NSURL(string: "http://cf9c36303a9981e3e8cc-31a5eb2af178214dc2ca6ce50f208bb5.r97.cf1.rackcdn.com/bigger_badminton_600.mp4")!),
				videoWithURL(url: NSURL(string: "http://devimages.apple.com/iphone/samples/bipbop/bipbopall.m3u8")!)]

		// Create and set options
		let options = BCOVPUIPlayerViewOptions()
		options.presentingViewController = self

		// Create and configure Control View
		let controlsView = BCOVPUIBasicControlView.withVODLayout()
		let playerView = BCOVPUIPlayerView.init(playbackController: playbackController, options: options, controlsView: controlsView)!

		playerView.delegate = self
		playerView.frame = videoContainer.bounds
		playerView.autoresizingMask = [.flexibleHeight, .flexibleWidth]

		videoContainer.addSubview(playerView)

		playbackController.setVideos(videoArray as NSFastEnumeration!)
		playbackController.play();
	}

	func videoWithURL(url: NSURL) -&gt; BCOVVideo {
		// set the delivery method for BCOVSources that belong to a video
		let source:BCOVSource = BCOVSource(url: url as URL!, deliveryMethod: kBCOVSourceDeliveryHLS, properties: nil)
		let video = BCOVVideo.init(source: source, cuePoints: BCOVCuePointCollection.init(array: []), properties: [NSObject:AnyObject]())
		return video!
	}

	private func playbackController(controller: BCOVPlaybackController!, didAdvanceToPlaybackSession session: BCOVPlaybackSession!) {
		print("ViewController Debug - Advanced to new session.")
	}

	override func didReceiveMemoryWarning() {
		super.didReceiveMemoryWarning()
		// Dispose of any resources that can be recreated.
	}

}</code></pre>
<!-- <p><code data-gist-id="aa87403235764a27cae1" data-gist-line="66-131"></code></p> --></div>
<!--class="player-only"--></section>
<!--id="Code_the_video_app"-->

<section class="bcls-section">
<h2 id="Connect_the_storyboard_view">Connect the storyboard view</h2>

<p>Connect the <code>Main.storyboard</code> view with the <code>videoContainer</code> property.</p>

<ol class="bcls-tasklist">
	<li>
	<p>In the Xcode, open the <code>Main.storyboard</code> file.</p>
	</li>
	<li>
	<p>In the companion view, expand the <strong>View Controller Scene</strong> and then the <strong>View Controller</strong> menu to expose the <strong>View</strong> object.</p>

	<figure class="bcls-figure"><img class="bcls-image" alt="Storyboard view" src="//learning-services-media.brightcove.com/doc-assets/device-sdks/ios/getting-started/quick-start-swift/storyboard-view.png" />
	<figcaption class="bcls-caption--image">Storyboard view</figcaption>
	</figure>
	</li>
	<li>
	<p>Show the Assistant Editor, and open the <code>ViewController.swift</code> file.</p>

	<figure class="bcls-figure"><img class="bcls-image" alt="Assistant editor" src="//learning-services-media.brightcove.com/doc-assets/device-sdks/ios/getting-started/quick-start-swift/assistant-editor.png" />
	<figcaption class="bcls-caption--image">Assistant editor</figcaption>
	</figure>
	</li>
	<li>
	<p>Select the open circle next to the <code>@IBOutlet</code> for the <code>videoContainerView</code>, and drag it to the <strong>View</strong> object to connect these components.</p>

	<figure class="bcls-figure"><img class="bcls-image" alt="Connect the view" src="//learning-services-media.brightcove.com/doc-assets/device-sdks/ios/getting-started/quick-start-swift/connect-view.png" />
	<figcaption class="bcls-caption--image">Connect the view</figcaption>
	</figure>
	</li>
</ol>
</section>

<section class="bcls-section">
<h2 id="Manage_Media_Security">Manage Media Security</h2>

<p>App Transport Security (ATS) enforces secure connections between your app and web services. With Apple's release of the iOS 9 SDK, a new feature called <a href="https://developer.apple.com/library/prerelease/ios/technotes/App-Transport-Security-Technote/">App Transport Security (ATS)</a> was added.</p>

<ol class="bcls-tasklist">
	<li>
	<p>One of the following situations will apply to your app:</p>

	<ul>
		<li>
		<p>By default the Brightcove Native SDK for iOS uses a source selection policy to choose HTTPS over HTTP sources, so you can build your apps with ATS enabled.</p>

		<p>That's it, you are ready to run your app.</p>
		</li>
		<br />
		<li>
		<p>If you are using HTTP sources or have other HTTP calls in your app, you may encounter the following error message:</p>

		<pre class="line-numbers" data-start="1">
<code class="language-swift">App Transport Security has blocked a cleartext HTTP (http://) resource load since it is insecure.
Temporary exceptions can be configured via your app's Info.plist file.</code></pre>

		<p>This means that ATS is enabled, but your system is not configured to meet the ATS requirements. To fix this situation, see the <a href="/node/18215">Working with App Transport Security (ATS)</a> document.</p>
		</li>
	</ul>
	</li>
</ol>
</section>

<section class="bcls-section">
<h2 id="Run_the_app">Run the app</h2>

<div class="video-cloud-only">
<p>The app is ready to build and run on an iPhone, iPad or the iOS Simulator. You should be able to play the videos from your playlist.</p>

<figure class="bcls-figure"><img class="bcls-image--no-border" alt="iPhone sample" src="//learning-services-media.brightcove.com/doc-assets/device-sdks/ios/getting-started/quick-start-swift/svp-app.png" />
<figcaption class="bcls-caption--image">iPhone sample</figcaption>
</figure>
</div>

<div class="player-only">
<p>The app is ready to build and run on an iPhone, iPad or the iOS Simulator. You should be able to play the videos defined in your array.</p>

<figure class="bcls-figure"><img class="bcls-image--no-border" alt="iPhone sample" src="//learning-services-media.brightcove.com/doc-assets/device-sdks/ios/getting-started/quick-start-swift/perform-quick-start-video.png" />
<figcaption class="bcls-caption--image">iPhone sample</figcaption>
</figure>
</div>
<!--class="player-only"--></section>
</article>








      <!-- END DRUPAL CONTENT -->
		</div>
	</div>
	<!-- bcl scripts -->
  <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.2.3/jquery.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/fastclick/1.0.6/fastclick.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/foundation/5.5.3/js/foundation.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/handlebars.js/4.0.5/handlebars.min.js"></script>
  <script src="/en/scripts/docs-nav-data.min.js"></script>
  <script src="/en/scripts/bcls-doc-site-v3.js"></script>
  <script src="//learning-services-media.brightcove.com/doc-assets/js/bcls-utils.js"></script>
  <script src="//learning-services-media.brightcove.com/doc-assets/js/prism/prism.js"></script>
  <script>
  $(document).foundation();
  </script>
  <!-- Any scripts specific to page samples should go here -->
</body>

</html>
