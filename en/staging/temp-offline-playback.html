<!DOCTYPE html>
<html lang="en">

<head>
    <!-- Begin Drupal Taxonomy Data -->
    <meta name="products" content="Video Cloud, Brightcove Player">
    <meta name="role" content="Device SDK Developer">
    <meta name="task" content="Develop with the Native SDKs">
    <meta name="topic" content="Troubleshooting/Error Handling">
    <meta name="sdk" content="iOS,tvOS,Android">
    <meta name="keywords" content="device,SDK,FAQ">
    <!-- End Drupal Taxonomy Data -->

    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  	<meta name="viewport" content="initial-scale=1.0, maximum-scale=1.0, user-scalable=no, width=device-width" />
    <meta name="robots" content="noindex">
  	<!-- change title to match the h1 heading -->
  	<title>Offline Playback with the Native Player SDKs</title>

    <link rel="stylesheet" type="text/css" href="//cdnjs.cloudflare.com/ajax/libs/foundation/5.5.3/css/foundation.min.css" />
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/foundation/5.5.3/css/normalize.css" />
    <link href="//fonts.googleapis.com/css?family=Open+Sans:400italic,700italic,400,700" rel="stylesheet" type="text/css">
    <script src="//use.edgefonts.net/source-code-pro.js"></script>
    <link rel="stylesheet" href="//learning-services-media.brightcove.com/doc-assets/js/prism/prism.css">
    <link rel="stylesheet" href="//docs.brightcove.com/en/styles/template-less/css/bcls-doc.css">
    <link rel="stylesheet" href="/en/styles/foundation-fixes.css">

    <script src="//cdnjs.cloudflare.com/ajax/libs/foundation/5.5.3/js/vendor/modernizr.js"></script>

</head>

<body>
	<!-- header navbar -->
	<div id="navWrapper" class="fixed"></div>
	<!-- breadcrumbs -->
	<nav id="breadCrumbWrapper" class="breadcrumbs show-for-medium-up"></nav>
	<!-- search -->
	<div id="searchModal" class="reveal-modal" data-reveal></div>
	<!-- content -->
	<div class="row">
		<div class="sidebar large-2 columns show-for-large-up">
			<div id="sidenav" class="side-nav"></div>
		</div>
		<div id="main" class="large-10 small-12 columns">
			<h1>Offline Playback with the Native Player SDKs</h1>
      <aside class="bcls-aside bcls-aside--warning">This is a temporary STAGING document for review only. For the official Brightcove documentation site, go to <a href="https://support.brightcove.com/">support.brightcove.com</a></aside>
      <p>In this topic, you will learn how offline playback works with the Brightcove Native Player SDKs.</p>


	    <!-- BEGIN DRUPAL CONTENT -->

      <article class="bcls-article">
<section id="top" class="bcls-section">
<p>Offline Playback with the Brightcove Native Playback SDKs for iOS and Android allows publishers to reach their viewers in entirely new ways while ensuring their content remains secure. Our SDKs offer powerfully simple solutions for complex offline playback problems including download management, offline catalog management, analytics, DRM, and of course playback.</p>

<p>Using offline playback, users can download both DRM-protected and non-encrypted video content to their devices and watch it when they are not connected.</p>

<aside class="bcls-aside bcls-aside--information">To use this feature, you need to be a Video Cloud customer using Dynamic Delivery.</aside>
</section>

<section class="bcls-section">
<h2 id="Supported_device_versions">Supported device versions</h2>

<p>The Brightcove Native Player SDKs support offline playback with the following device OS versions:</p>

<ul>
	<li>iOS 10.0+, but 10.3+ is recommended</li>
	<li>Android 5.0+</li>
</ul>
</section>

<section class="bcls-section">
<h2 id="Content_delivery">Content delivery</h2>

<p>Streaming video takes advantage of Video Cloud's multi-bitrate streaming feature which detects bandwidth at the source and delivers the best quality for the device. The offline playback feature supports the following streaming types:</p>

<ul>
	<li><strong>Android</strong>: Dynamic Adaptive Streaming over HTTP (DASH)</li>
  <li><strong>iOS</strong>: Apple HTTP Live Streaming (HLS)</li>
</ul>
</section>

<section class="bcls-section">
<h2 id="Security">Security</h2>

<p>The protection of downloaded content is top-of-mind with our Offline solution. The Brightcove Native Player SDKs provide the following functionality to ensure your content is stored safely on viewers' devices:</p>

<p>
  <strong>DRM-protected content:</strong>
</p>
<ul>
  <li>For DRM-protected content, the Native SDKs use the following technologies:
    <ul>
      <li>
        <strong>Android</strong>: <a href="http://www.widevine.com/wv_drm.html">Widevine Modular</a>
      </li>
      <li>
        <strong>iOS</strong>: <a href="https://developer.apple.com/streaming/fps/">FairPlay</a>
      </li>
    </ul>
  </li>
  <li>Video content can only be watched on the device and app that has downloaded the content.</li>
	<li>Video content can only be watched until a specific date and time expiration.
    <aside class="bcls-aside bcls-aside--information">The date/time is set in the DRM license.</aside></li>
	<li>Video URLs returned to the client will expire so that others can not use them.</li>
</ul>
<p>
  <strong>All content:</strong>
</p>
<ul>
    <li>When the app is deleted, all downloaded content is removed.
    <aside class="bcls-aside bcls-aside--information">For Android, this is true as long as the default storage location is not overridden.</aside></li>
    <li>Your app can delete locally stored content at any time.</li>
</ul>

</section>

<section class="bcls-section">
<h2 id="Download_management">Download management</h2>

<p>The Brightcove Native Player SDKs handle the complexities of downloading content to a viewer's device, greatly simplifying the process for native applications.</p>

<ul>
	<li>Publishers can choose the rendition quality of the content to download.</li>
	<li>Captions can be downloaded and displayed while offline.</li>
	<li>Multiple audio tracks are supported by the Native SDKs. For details about adding additional tracks with the Native SDK for iOS, see the <a href="https://github.com/brightcove/brightcove-player-sdk-ios/blob/master/OfflinePlayback.md#downloading-secondary-tracks">iOS App Developer's Guide for Offline Playback</a>.</li>
</ul>

<p>The following functionality can be added to your apps to support download management:</p>

<ul>
	<li><a href="#Display_content">Display content</a></li>
	<li><a href="#Show_download_status">Show download status</a></li>
	<li><a href="#Manage_the_download_queue">Manage the download queue</a></li>
	<li><a href="#Show_local_storage_space">Show local storage space</a></li>
	<li><a href="#Pause_resume_cancel_download">Pause/resume/cancel download</a></li>
</ul>

<h3 class="BCL_conceptTitle" id="Display_content">Display content</h3>

<p>Display a list of content available for streaming or download.</p>

<p>When you set a video's <code>offline_enabled</code> property to <strong>true</strong> using the <a href="https://brightcovelearning.github.io/Brightcove-API-References/cms-api/v1/doc/index.html#api-videoGroup-Update_Video">CMS API</a>, the Native SDKs will mark this video as downloadable.</p>

<h4 id="Using_the_CodePen" class="bcls-expander-head">Prepare videos</h4>
<div class="bcls-expander-content">
  <p>For the SDKs to mark a video as downloadable, you need to do the following:</p>
<ol class="bcls-tasklist"><li>Contact your account manager to enable your account for offline playback.</li>
	<li>
		<p>
			For each video that you want to be downloadable, use the <a href="/overview-cms-api">CMS API</a> to set the <a href="/cms-api-custom-fields-reference#videoFields">offline_enabled</a> field to a value of <strong>true</strong>.
		</p>
		<p>Here is an example using curl:</p>

		<pre class="line-numbers" data-start="1">
<code class="language-json">curl --header "Authorization: Bearer $oauth_token" --request PATCH --data '
{"offline_enabled" : true}
' https://cms.api.brightcove.com/v1/accounts/<span class="bcls-input">your account id</span>/videos/<span class="bcls-input">your video id</span>
</code></pre>

		<p>Setting this field will be similar to the steps found in the <a href="/setting-360-degree-video-properties-cms-api">Setting 360-Video Properties with the CMS API</a> document.</p>
	</li>
</ol>
</div>

<figure class="bcls-figure"><img class="bcls-image--no-border" alt="Display content" src="//learning-services-media.brightcove.com/doc-assets/device-sdks/guides/odrm/content-list.png" />
<figcaption class="bcls-caption--image">Display content</figcaption>
</figure>

<h3 class="BCL_conceptTitle" id="Show_download_status">Show download status</h3>

<p>Display the current download along with its status.</p>

<p>Total estimated size, current download status and percent of downloading progress information will be returned by the SDKs.</p>
<!-- <figure class="bcls-figure"><img class="bcls-image--no-border" alt="Download status" src="//learning-services-media.brightcove.com/doc-assets/device-sdks/guides/odrm/download-progress.png" />
		<figcaption class="bcls-caption--image">Download status</figcaption>
		</figure> -->

<aside class="bcls-aside bcls-aside--tip">For Android devices, download status is also shown in the Notification Area. The notification title is set to the video title. The notification is removed if the download is paused or cancelled. For details, see the <a href="/node/18246#Offline_playback_with_DRM">Code Snippets using the Native SDK for Android</a> document.</aside>

<h3 class="BCL_conceptTitle" id="Manage_the_download_queue">Manage the download queue</h3>

<p>Create and manage the download queue.</p>

<p>The Native SDKs will allow mutliple videos to be queued for downloads. For example, a user can download multiple episodes of a season and the Native SDKs will manage the process by providing download status for each asset.</p>
<!-- <figure class="bcls-figure">
		  <img class="bcls-image--no-border" src="//learning-services-media.brightcove.com/doc-assets/device-sdks/guides/odrm/download-queue.png" alt="Download queue">
		  <figcaption class="bcls-caption--image">Download queue</figcaption>
		</figure> -->

<h3 class="BCL_conceptTitle" id="Show_local_storage_space">Show local storage space</h3>

<p>Inform the user when there is not enough local storage to complete downloading the current item and any items in the queue.</p>

<p>The SDKs provide the estimated size and progress so that you can determine if there is sufficient space for downloads.</p>
<!-- <figure class="bcls-figure">
		  <img class="bcls-image--no-border" src="//learning-services-media.brightcove.com/doc-assets/device-sdks/guides/odrm/download-space.png" alt="Local storage space">
		  <figcaption class="bcls-caption--image">Local storage space</figcaption>
		</figure> -->

<h3 class="BCL_conceptTitle" id="Pause_resume_cancel_download">Pause/resume/cancel download</h3>

<p>Allow the user to pause, resume or cancel content download.</p>

<p>Download functionality will resume where it left off if the user pauses/resumes or if the download is interrupted. For example, it you lose Wi-Fi connection during download, it will resume where it left off when you are reconnected.</p>

<p>If you cancel a video download, then any progress made will be erased.</p>
<!-- <figure class="bcls-figure"><img class="bcls-image--no-border" alt="Pause/resume/cancel download" src="//learning-services-media.brightcove.com/doc-assets/device-sdks/guides/odrm/download-cancelled.png" />
		<figcaption class="bcls-caption--image">Pause/resume/cancel download</figcaption>
		</figure> --></section>

<section class="bcls-section">
<h2 id="Local_catalog_management">Local catalog management</h2>

<p>The Brightcove Native Player SDKs simplify the process of managing downloaded local content.</p>

<p>The following functionality can be added to your apps to support local catalog management:</p>

<ul>
	<li><a href="#Show_downloaded_content">Show downloaded content</a></li>
	<li><a href="#Play_local_content">Play local content</a></li>
	<li><a href="#Delete_local_content">Delete local content</a></li>
</ul>

<h3 class="BCL_conceptTitle" id="Show_downloaded_content">Show downloaded content</h3>

<p>Show all of the downloaded episodes for each show/season.</p>

<p>The SDKs return metadata and playback details for all downloaded content. This metadata includes video title, description, thumbnails, available captions, available audio tracks, etc.</p>

<p>There are new metadata properties specific to offline playback, which include the following:</p>

<p>
  <strong>DRM-protected content:</strong>
</p>
<ul>
	<li>Token identifier</li>
	<li>License expiration date</li>
</ul>
<p>
  <strong>All content:</strong>
</p>
<ul>
	<li>Download start and end time</li>
	<li>Downloaded thumbnail name along with its file URL</li>
	<li>Downloaded poster name along with its file URL</li>
	<li>Relative and derived file URL of the video bundle</li>
</ul>

<p>You can then filter the results for your specific implementation.</p>

<aside class="bcls-aside bcls-aside--tip">You will be able to see the time remaining for a rental license.</aside>

<h3 class="BCL_conceptTitle" id="Delete_local_content">Delete local content</h3>

<p>Allow users to delete content from local storage.</p>

<p>The SDKs expose a method to delete a video along with its metadata and related assets.</p>
</section>

<section class="bcls-section">
<h2 id="Content_playback">Content playback</h2>

<p>The Native SDKs allow you to play content in the following situations:</p>

<ul>
	<li>Play a video while it downloads.</li>
	<li>Play a video after it has been downloaded. Downloaded content can be played back locally when the device is offline or online. The offline video can only be played from local storage.</li>
	<li>If you choose to stream an online version of the video, you should retrieve a new video object from the Playback Service.</li>
</ul>
</section>

<section class="bcls-section">
<h2 id="Analytics">Analytics</h2>
<!-- <p>There are two new types of analytics being introduced for measuring data related to the Offline flow: Download analytics &amp; Offline playback metrics.</p> -->

<p>Analytics introduced for measuring data related to the Offline flow include the following Download analytics:</p>
<!-- <h3>Download analytics</h3>

		<p>Download Analytics will automatically track:</p> -->

<ul>
	<li>Every download request - This includes rendition bitrate and rendition dimensions</li>
	<li>Every download complete</li>
	<li>Every download failure</li>
	<li>Every download cancellation</li>
</ul>

<p>For details about viewing these download metrics from the Analytics API, see the <a href="/node/17961#fieldValues">Dimension: video</a> document.</p>
</section>

<section class="bcls-section">
<h2 id="Samples">Samples</h2>

<p>The following table contains links to code samples to show you how to get started with offline playback:</p>

<table class="bcls-table">
  <thead class="bcls-table__head">
    <tr>
      <th style="width:25%">Sample Application</th>
			<th style="width:75%">Description</th>
		</tr>
  </thead>
  <tbody class="bcls-table__body">
    <tr>
      <td><a href="https://github.com/BrightcoveOS/ios-player-samples/tree/master/Offline">iOS Offline Playback</a></td>
			<td>Download and play HLS videos, including those protected with FairPlay encryption. For developer details, see the <a href="https://github.com/brightcove/brightcove-player-sdk-ios/blob/master/OfflinePlayback.md">iOS App Developers Guide for Offline Playback</a>.</td>
		</tr>
    <tr>
      <td><a href="https://github.com/BrightcoveOS/android-player-samples/tree/master/brightcove-exoplayer/OfflinePlaybackSampleApp">Android Offline Playback</a></td>
			<td>Download and play DASH videos, including those protected with Widevine encryption.</td>
		</tr>
    </tbody>
  </table>
</section>

<section class="bcls-section">
<h2 id="Notes">Notes</h2>

<p>The following notes apply to the offline playback feature supported by the Native SDKs:</p>
<h3>Android</h3>
<p>
  When the app is deleted, all downloaded content is removed. This is true as long as the default storage location is not overridden.
</p>

<h3>iOS</h3>
<p>
  As a security feature, you cannot stream an offline HLS video to an AirPlay device for playback. This is confirmed by Apple to be an <code>AVFoundation</code> limitation.
</p>
</section>

<section class="bcls-section"><h2 id="FAQ">FAQ</h2>

<p>Below you will find answers to some general questions.</p>
<h3>
  DRM-protected content
</h3>

<p class="bcls-question">Can the user change the system clock to bypass the expiration date?</p>

<p class="bcls-answer"><strong>Android</strong>: Absolute expiration determines the date and time until which a license is valid. This is enforced by Widevine and the Android DRM layer. Theoretically, the DRM layer in Android must prevent the user from bypassing the expiration period. Any issues that we may have found is described in the Android OS release notes.
<br /><br />
<strong>iOS</strong>: License expiration is enforced by FairPlay. iOS handles all checking for clock changes, etc. An app has the option of checking the license expiration to alert the user that the license has expired. This may be preferable to simply playing back an expired video and then receiving a playback error.</p>
<!-- <p class="bcls-answer">Absolute expiration determines the date and time until which a license is valid. This is enforced by Widevine and the Android DRM layer. Theoretically, the DRM layer in Android must prevent the user from bypassing the expiration period. Any issues that we may have found is described in the <a href="https://brightcovelearning.github.io/Brightcove-API-References/android-sdk/release-notes.txt">Native SDK for Android release notes</a>.</p> -->

<p class="bcls-question">Will the license and offline videos continue loading while the app is in the background?</p>

<p class="bcls-answer"><strong>Android</strong>: Yes. Typically, the license is downloaded immediately, but even the license can be downloaded while the app is backgrounded.
<br /><br />
<strong>iOS</strong>: License loading should happen in the foreground. We have a <a href="https://github.com/brightcove/brightcove-player-sdk-ios/blob/master/ios/dynamic/BrightcovePlayerSDK.framework/Headers/BCOVOfflineVideoManager.h#L631">method to preload the license</a>. Downloading of the main video content can happen while the app is in the background.</p>
<!-- <p class="bcls-answer">License loading should happen in the foreground. We have a method to preload the license.
Downloading of the main video content can happen while the app is in the background.</p> -->

<h3>
  All content
</h3>
<p class="bcls-question">What is the video format used for downloading offline content?</p>

<p class="bcls-answer"><strong>Android</strong>: DRM-protected DASH or non-encrypted DASH.
<br /><br />
<strong>iOS</strong>: HLS steaming. You can specify a bitrate for the download to use a specific variant.</p>

<p class="bcls-question">Will downloaded videos playback locally or streaming when the user is online?</p>

<p class="bcls-answer">A downloaded video can be played back while online or offline, but it will always use the downloaded video. If you choose to play back an online version of the video, you should retrieve a new video object from the Playback Service. The offline video can only be played from local storage.</p>

<p class="bcls-question">Will the release of Android OS v8.0 affect the Offline Playback feature?</p>

<p class="bcls-answer">The release of Android OS v8.0 will have new <a href="https://developer.android.com/preview/features/background.html">background service limitations</a>. We will test and make any changes needed for continued support of Offline Playback with the Native Player SDK for Android.</p>

</section>
<br /><br />

</article>






      <!-- END DRUPAL CONTENT -->
		</div>
	</div>
	<!-- bcl scripts -->
  <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.2.3/jquery.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/fastclick/1.0.6/fastclick.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/foundation/5.5.3/js/foundation.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/handlebars.js/4.0.5/handlebars.min.js"></script>
  <script src="/en/scripts/docs-nav-data.min.js"></script>
  <script src="/en/scripts/bcls-doc-site-v3.js"></script>
  <script src="//learning-services-media.brightcove.com/doc-assets/js/bcls-utils.js"></script>
  <script src="//learning-services-media.brightcove.com/doc-assets/js/prism/prism.js"></script>
  <script>
  $(document).foundation();
  </script>
  <!-- Any scripts specific to page samples should go here -->
</body>

</html>
