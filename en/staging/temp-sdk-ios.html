<!DOCTYPE html>
<html lang="en">

<head>
    <!-- Begin Drupal Taxonomy Data -->
    <meta name="products" content="Video Cloud, Brightcove Player">
    <meta name="role" content="Device SDK Developer">
    <meta name="task" content="Develop with the Native SDKs">
    <meta name="topic" content="Troubleshooting/Error Handling">
    <meta name="sdk" content="iOS,tvOS,Android">
    <meta name="keywords" content="device,SDK,FAQ">
    <!-- End Drupal Taxonomy Data -->

    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  	<meta name="viewport" content="initial-scale=1.0, maximum-scale=1.0, user-scalable=no, width=device-width" />
    <meta name="robots" content="noindex">
  	<!-- change title to match the h1 heading -->
  	<title>Running the Sample Apps: Native SDK for Android</title>

    <link rel="stylesheet" type="text/css" href="//cdnjs.cloudflare.com/ajax/libs/foundation/5.5.3/css/foundation.min.css" />
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/foundation/5.5.3/css/normalize.css" />
    <link href="//fonts.googleapis.com/css?family=Open+Sans:400italic,700italic,400,700" rel="stylesheet" type="text/css">
    <script src="//use.edgefonts.net/source-code-pro.js"></script>
    <link rel="stylesheet" href="//learning-services-media.brightcove.com/doc-assets/js/prism/prism.css">
    <link rel="stylesheet" href="//docs.brightcove.com/en/styles/template-less/css/bcls-doc.css">
    <link rel="stylesheet" href="/en/styles/foundation-fixes.css">

    <script src="//cdnjs.cloudflare.com/ajax/libs/foundation/5.5.3/js/vendor/modernizr.js"></script>

</head>

<body>
	<!-- header navbar -->
	<div id="navWrapper" class="fixed"></div>
	<!-- breadcrumbs -->
	<nav id="breadCrumbWrapper" class="breadcrumbs show-for-medium-up"></nav>
	<!-- search -->
	<div id="searchModal" class="reveal-modal" data-reveal></div>
	<!-- content -->
	<div class="row">
		<div class="sidebar large-2 columns show-for-large-up">
			<div id="sidenav" class="side-nav"></div>
		</div>
		<div id="main" class="large-10 small-12 columns">
			<h1>Running the Sample Apps: Native SDK for Android</h1>
      <aside class="bcls-aside bcls-aside--warning">This is a temporary STAGING document for review only. For the official Brightcove documentation site, go to <a href="https://support.brightcove.com/">support.brightcove.com</a></aside>
      <p>In this topic, you will learn how to run the sample apps associated with the Brightcove Native SDK for Android and iOS. These are a good starting point for creating your own apps that use the Native SDKs.</p>


	    <!-- BEGIN DRUPAL CONTENT -->

  <article class="bcls-article">
  <section class="bcls-section">
  <h2 id="Overview">Overview</h2>

  <p>The Brightcove Native SDKs provide a variety of sample apps to help you get started with your own implementations. For a complete list of samples, see the following:</p>
  <ul>
    <li>
      <a href="https://github.com/BrightcoveOS/android-player-samples">Player samples for Android</a>
    </li>
    <li>
      <a href="https://github.com/BrightcoveOS/ios-player-samples">Player samples for iOS and tvOS</a>
    </li>
  </ul>
  <p>
    This topic shows you how to run the sample apps mentioned above. There is also a collection of code snippets that you may find helpful:
  </p>
  <ul>
    <li>
      <a href="https://support.brightcove.com/code-snippets-using-native-sdk-android">Code Snippets using the Native SDK for Android</a>
    </li>
    <li>
      <a href="https://support.brightcove.com/code-snippets-using-native-sdk-ios">Code Snippets using the Native SDK for iOS</a>
    </li>
  </ul>

  </section>

  <section class="bcls-section">
  <h2 id="Key_concepts">Key concepts</h2>

  <p><span class="video-cloud-only">A few concepts must be understood to effectively use cue points in Brightcove Player. These concepts are explained in this section of the document.</span><span class="player-only">The following concept must be understood to effectively use cue points in Brightcove Player.</span></p>

  <div class="video-cloud-only">
  <h3>Video Cloud catalog cue points</h3>

  <p>The first concept to understand has to do with terminology. In Brightcove Player, cue points are stored as text track elements, per the HTML standard. This means that when a Video Cloud video is used, any "Video Cloud style" cue points are converted into text tracks.</p>

  <p>These "Video Cloud style" cue points can also be referred to as "catalog" cue points since they are read from the Video Cloud catalog (See the <a href="/node/18108">Player Catalog</a> document for more information on the catalog). When this conversion takes place, some of the information in the catalog cue point, like type and cue point time, are converted into the text track.</p>

  <h3>Catalog cue point structure</h3>

  <p>The next concept to understand is that there is significant difference between catalog cue points and the HTML standard in structure. The difference is that an HTML cue point can have a duration. This means for every cue point, two cue point change events will be dispatched: one on start of the cue point and one on end of the cue point.</p>

  <p>In the conversion process, every catalog cue point is converted into a cue point with identical start and stop times. This means that for every catalog cue point, two cue point events will be dispatched and has to be accounted for in code.</p>
  </div>

  <h3><code>activecues</code> array</h3>

  <p><span class="video-cloud-only">Another</span><span class="player-only">An</span> important conceptual point to understand when dealing with HTML cue points is the <code>activeCues</code> array. All the cue points are defined in an array. There is another array, <code>activeCues</code>, which holds the cue points which are "active", meaning the playback time is between the cue point's start and stop times.</p>

  <p>When using catalog cue points, the start and stop times are identical, so they will be active only for the second defined. Also, with catalog cue points, it is highly unlikely two cue points will be active at the same time since they will not overlap.</p>

  <aside class="bcls-aside bcls-aside--information">Note: There can be multiple sets of text tracks, for instance one set for cue points and another for video captions. In the example code in this document, the cue points text tracks are located in both the first and second elements in the TextTracks array. You will see this reflected in code.</aside>

  <h3>Cue point types</h3>

  <p>In this document you will see cue points with a <code>type</code> property assigned a value. These type values are assigned when creating cue points in the Studio user interface. There are two types of cue points, but both simply supply a string value to the <code>type</code> property. The appropriate value is helpful only if used in custom JavaScript while processing the cue point information. The types are detailed here:</p>

  <ul>
  	<li><strong>Ad</strong> - Assigns the string value of <code>AD</code> to the <code>type</code> property</li>
  	<li><strong>Code</strong> - Assigns the string value of <code>CODE</code> to the <code>type</code> property</li>
  </ul>
  </section>

  <section class="bcls-section video-cloud-only">
  <h2 id="Video_Cloud_cue_points">Video Cloud cue points</h2>

  <p>In this section of the document, you will learn to set catalog cue points and listen for catalog cue point event dispatches.</p>

  <h3>Setting Video Cloud cue points</h3>

  <p>Video Cloud cue points can be associated with a video using the Video Cloud Studio, and a number of other ways, detailed in this document: <a href="/node/15151">Adding Cue Points to Videos</a>.</p>

  <h3>Acting on Video Cloud cue points - video statically bound to the player</h3>

  <p>In this section of the document, you will learn to process catalog cue points when the video has been statically bound to the player, meaning the video has been loaded in the player either in Studio or using the Player Management API directly.</p>

  <p>To prevent a race condition of trying to process cue points before they are loaded, you need to use the <code>loadedmetadata</code> event to be dispatched before dealing with the cue points. Once the proper text track has been read, use the <code>oncuechange</code> event to listen for cue points events to be dispatched.</p>

  <p>The following code shows listening for cue points and displaying the data from the cue point. Note that in this example the video is statically bound to the Player.</p>

  <ul>
  	<li>Line 24: Create a paragraph element as a location in which to inject dynamically created HTML.</li>
  	<li>Lines 31,43: Use the <code>one()</code> method to add an event listener for the <code>loadedmetadata</code> event only once. The event handler function is defined here anonymously.</li>
  	<li>Line 32: Retrieve the TextTracks array using the <code>textTracks()</code> method, then assign the zeroth element, which holds the cue points, to the variable <code>tt</code>. Note that it may be possible in some implementations that the cue points could be in a different array element. See the <a href="#findtrack">Find correct track</a> section below for more information.</li>
  	<li>Lines 33,41: Sets the event handler function for when the <code>oncuechange</code>event is dispatched.</li>
  	<li>Line 34: Check to be sure the you are getting the first (zeroth array element) cue point dispatch. Without this condition, you would see that each cue point would be acted upon twice. Note that if you are using cue points that have durations that overlap this condition would have to be different.</li>
  	<li>Lines 35-39: Dynamically create HTML using information from the cue point and inject into the HTML page.</li>
  	<li>Line 42: Play the video.</li>
  </ul>

  <pre class="line-numbers" data-start="17">
  <code class="language-html">  &lt;video id="myPlayerID"
      data-account="1507807800001"
      data-player="6aac508a-741e-41a2-bc7a-5805644cf089"
      data-embed="default"
      data-video-id="1507781667001"
      class="video-js" controls&gt;&lt;/video&gt;

    &lt;p id="insertionPoint"&gt;&lt;/p&gt;

    &lt;script src="//players.brightcove.net/1507807800001/6aac508a-741e-41a2-bc7a-5805644cf089_default/index.min.js"&gt;&lt;/script&gt;

    &lt;script&gt;
      videojs("myPlayerID").ready(function(){
        var player = this;
        player.one("loadedmetadata",function(){
          var tt = player.textTracks()[0];
          tt.oncuechange = function() {
            if(tt.activeCues[0] !== undefined){
              var dynamicHTML = "id: " + tt.activeCues[0].id + ", ";
              dynamicHTML += "text: " + tt.activeCues[0].text + ", ";
              dynamicHTML += "startTime: " + tt.activeCues[0].startTime + ",  ";
              dynamicHTML += "endTime: " + tt.activeCues[0].endTime;
              document.getElementById("insertionPoint").innerHTML += dynamicHTML + "&lt;br/&gt;";
            }
          }
          player.play();
        });
      });
    &lt;/script&gt;</code></pre>

  <h3>Acting on Video Cloud cue points - dynamically load video in the player</h3>

  <p>In this section of the document, you will learn to process catalog cue points when the video is dynamically loaded into the player using the <code>catalog.getVideo()</code> and <code>catalog.load()</code> methods.</p>

  <p>When you use the player catalog to get and load the video, processing cue points is bit easier than when you use a statically bound video, as you do not need to use the <code>loadedmetadata</code> event.</p>

  <h3 id="allvcinfo">Retrieve all Video Cloud cue point info</h3>

  <p>As you may have noticed not all Video Cloud cue point information is directly available to you from the <code>activecues</code> array. This is easily remedied by retrieving the desired info from the <code>mediainfo</code> property.</p>

  <p>The basic approach of this solution is:</p>

  <ol>
  	<li>Wait for the <code>loadstart</code> event for the <code>mediainfo</code> property to be populated.</li>
  	<li>Assign the <code>cue_points</code> array from the <code>mediainfo</code> property to a variable. This variable contains complete Video Cloud cue point information.</li>
  	<li>On a cue point event, retrieve the corresponding cue point data based on the <code>time</code> property value. This will be done using a helper function that grabs an object out of an array based on a property value in the object.</li>
  	<li>Use the data from the cue point.</li>
  </ol>

  <p>The following image shows the entire cue point array (top-left), the single cue point data collection (top-right), and one property from that single cue point data collection (bottom-right).</p>

  <figure class="bcls-figure"><img class="bcls-image" alt="cue point data" src="//learning-services-media.brightcove.com/doc-assets/player-development/player-customization/cue-points/using-cue-points/cue-point-all-vc-data.png" /></figure>

  <p>In the snippet below only the new/changed code from examples above will be explained.</p>

  <ul>
  	<li>Lines 452-463: Include the function that will be used to extract a single cue point data collection from the array of all cue points. Note that you pass it the array of all cue points, the property in which you are searching for a specific value, and lastly the the value you are searching for.</li>
  	<li>Line 432: Listens for the <code>loadstart</code> event. When your video starts to load, then the <code>mediainfo</code> property is populated.</li>
  	<li>Line 434: Assign the array of all Video Cloud cue points to a variable.</li>
  	<li>Line 443: In the cue point dispatch event handler, assign the specific cue point's data collection to a variable. This is where the function mentioned in the first bullet point is called. The arguments used are:
  	<ul>
  		<li><code>cuePointAra</code>: The entire collection of Video Cloud cue points.</li>
  		<li><code>'time'</code>: The property in which to search for a value.</li>
  		<li><code>tt.activeCues[0].startTime</code>: The start time of the cue point currently being handled in the cue point dispatch event handler.</li>
  	</ul>
  	</li>
  	<li>Lines 444-445: Debugging <code>console.log()</code> method calls, which should be removed in production code.</li>
  </ul>

  <pre class="line-numbers" data-start="426">
  <code class="language-html">&lt;script&gt;
      videojs("myPlayerID").ready(function(){
        var myPlayer = this,
          cuePointAra=[],
          allCuePointData;

        myPlayer.on('loadstart',function(){
          //console.log('mediainfo', myPlayer.mediainfo);
          cuePointAra = myPlayer.mediainfo.cue_points;
          var tt = myPlayer.textTracks()[0];
          tt.oncuechange = function() {
            if(tt.activeCues[0] !== undefined){
              var dynamicHTML = "id: " + tt.activeCues[0].id + ", ";
              dynamicHTML += "text: " + tt.activeCues[0].text + ", ";
              dynamicHTML += "startTime: " + tt.activeCues[0].startTime + ",  ";
              dynamicHTML += "endTime: " + tt.activeCues[0].endTime;
              document.getElementById("insertionPoint").innerHTML += dynamicHTML + "&lt;br/&gt;";
              allCuePointData = getSubArray(cuePointAra,'time',tt.activeCues[0].startTime);
              console.log('cue point data:', allCuePointData);
              console.log('cue point metadata:', allCuePointData[0].metadata);
            }
          }
          myPlayer.play();
          myPlayer.muted(true);
        });

        function getSubArray(targetArray, objProperty, value) {
          var i, totalItems = targetArray.length,
            objFound = false,
            idxArr = [];
          for (i = 0; i &lt; totalItems; i++) {
            if (targetArray[i][objProperty] === value) {
              objFound = true;
              idxArr.push(targetArray[i]);
            }
          }
          return idxArr;
        };
      });
    &lt;/script&gt;</code></pre>
  </section>


  </article>








      <!-- END DRUPAL CONTENT -->
		</div>
	</div>
	<!-- bcl scripts -->
  <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.2.3/jquery.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/fastclick/1.0.6/fastclick.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/foundation/5.5.3/js/foundation.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/handlebars.js/4.0.5/handlebars.min.js"></script>
  <script src="/en/scripts/docs-nav-data.min.js"></script>
  <script src="/en/scripts/bcls-doc-site-v3.js"></script>
  <script src="//learning-services-media.brightcove.com/doc-assets/js/bcls-utils.js"></script>
  <script src="//learning-services-media.brightcove.com/doc-assets/js/prism/prism.js"></script>
  <script>
  $(document).foundation();
  </script>
  <!-- Any scripts specific to page samples should go here -->
</body>

</html>
