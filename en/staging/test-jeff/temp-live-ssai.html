<!DOCTYPE html>
<html lang="en">

<head>
    <!-- Begin Drupal Taxonomy Data -->
    <meta name="products" content="Video Cloud, Brightcove Player">
    <meta name="role" content="Device SDK Developer">
    <meta name="task" content="Develop with the Native SDKs">
    <meta name="topic" content="Troubleshooting/Error Handling">
    <meta name="sdk" content="iOS,tvOS,Android">
    <meta name="keywords" content="device,SDK,FAQ">
    <!-- End Drupal Taxonomy Data -->

    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  	<meta name="viewport" content="initial-scale=1.0, maximum-scale=1.0, user-scalable=no, width=device-width" />
    <meta name="robots" content="noindex">
  	<!-- change title to match the h1 heading -->
  	<title>Live API: Server-Side Ad Insertion (SSAI)</title>

    <link rel="stylesheet" type="text/css" href="//cdnjs.cloudflare.com/ajax/libs/foundation/5.5.3/css/foundation.min.css" />
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/foundation/5.5.3/css/normalize.css" />
    <link href="//fonts.googleapis.com/css?family=Open+Sans:400italic,700italic,400,700" rel="stylesheet" type="text/css">
    <script src="//use.edgefonts.net/source-code-pro.js"></script>
    <link rel="stylesheet" href="//learning-services-media.brightcove.com/doc-assets/js/prism/prism.css">
    <link rel="stylesheet" href="//docs.brightcove.com/en/styles/template-less/css/bcls-doc.css">
    <link rel="stylesheet" href="/en/styles/foundation-fixes.css">

    <script src="//cdnjs.cloudflare.com/ajax/libs/foundation/5.5.3/js/vendor/modernizr.js"></script>

</head>

<body>
	<!-- header navbar -->
	<div id="navWrapper" class="fixed"></div>
	<!-- breadcrumbs -->
	<nav id="breadCrumbWrapper" class="breadcrumbs show-for-medium-up"></nav>
	<!-- search -->
	<div id="searchModal" class="reveal-modal" data-reveal></div>
	<!-- content -->
	<div class="row">
		<div class="sidebar large-2 columns show-for-large-up">
			<div id="sidenav" class="side-nav"></div>
		</div>
		<div id="main" class="large-10 small-12 columns">
			<h1>Live API: Server-Side Ad Insertion (SSAI)</h1>
      <aside class="bcls-aside bcls-aside--warning">This is a temporary STAGING document for review only. For the official Brightcove documentation site, go to <a href="https://support.brightcove.com/">support.brightcove.com</a></aside>
      <p>This topic shows you how to set up server-side ad insertion (SSAI) for your live stream jobs.</p>
      <!-- <aside class="bcls-aside bcls-aside--information">The content in this document applies to Video Cloud only.</aside> -->


	    <!-- BEGIN DRUPAL CONTENT -->


<article class="bcls-article">
<section class="bcls-section">
<h2 id="Overview">Overview</h2>

<p><span class="”notranslate”">SSAI</span> allows you display ads during a live streaming event at specified times. The main features include:</p>

<ul>
	<li>Ad blockers will not work, since ads are stitched into the live stream on the server side</li>
	<li>Ads are inserted at cue points sent from your encoder or you can create an instant cue point using the <span class="notranslate">Live API</span></li>
	<li>You can ingest "slate" assets to fill any unused ad time</li>
</ul>

<p>Besides using the API, a lot of the SSAI setup can be managed in Video Cloud Studio as well. For details, see the <a href="/node/18588">Managing Live Settings</a> document.</p>

<aside class="bcls-aside bcls-aside--information">Before you can use <span class="”notranslate”">SSAI</span>, it must be enabled for your account. Contact your account manager for details.</aside>
</section>

<section class="bcls-section">
<h2 id="Headers">Headers</h2>

<p>The following headers are required with API requests:</p>

<pre class="line-numbers">
<code class="language-http notranslate">x-api-key: <span class="bcls-input">APIKEY-HERE</span>
Content-Type: application/json
</code>
</pre>
</section>

<section class="bcls-section">
<h2 id="Ad_configuration_variables">Ad configuration variables</h2>

<p>The following table provides a summary of ad configuration variables, which are used in the requests to manage ad configurations detailed in the sections that follow.</p>

<table class="bcls-table">
	<caption class="bcls-caption--table">Ad Configuration Variables</caption>
	<thead class="bcls-table__head">
		<tr>
			<th style="width:20%;">Variable</th>
			<th style="width:60%;">
			<div style="word-wrap:break-word;">Description</div>
			</th>
		</tr>
	</thead>
	<tbody class="bcls-table__body">
		<tr>
			<td style="width:20%"><code>session.session_id </code></td>
			<td style="text-align:left;width:60%;">
			<div style="word-wrap:break-word;">unique session id</div>
			</td>
		</tr>
		<tr>
			<td style="width:20%"><code>job.job_id </code></td>
			<td style="text-align:left;width:60%;">
			<div style="word-wrap:break-word;">unique job id</div>
			</td>
		</tr>
		<tr>
			<td style="width:20%"><code>application_ad_configuration.description </code></td>
			<td style="text-align:left;width:60%;">
			<div style="word-wrap:break-word;">value of the application at session creation</div>
			</td>
		</tr>
		<tr>
			<td style="width:20%"><code>random.int32 </code></td>
			<td style="text-align:left;width:60%;">
			<div style="word-wrap:break-word;">random 32-bit signed integer</div>
			</td>
		</tr>
		<tr>
			<td style="width:20%"><code>random.int64 </code></td>
			<td style="text-align:left;width:60%;">
			<div style="word-wrap:break-word;">random 64-bit signed integer</div>
			</td>
		</tr>
		<tr>
			<td style="width:20%"><code>random.uint32 </code></td>
			<td style="text-align:left;width:60%;">
			<div style="word-wrap:break-word;">random 32-bit unsigned integer</div>
			</td>
		</tr>
		<tr>
			<td style="width:20%"><code>random.uint64 </code></td>
			<td style="text-align:left;width:60%;">
			<div style="word-wrap:break-word;">random 64-bit unsigned integer</div>
			</td>
		</tr>
		<tr>
			<td style="width:20%"><code>random.uuid </code></td>
			<td style="text-align:left;width:60%;">
			<div style="word-wrap:break-word;">random uuid</div>
			</td>
		</tr>
		<tr>
			<td style="width:20%"><code>server.timestamputc </code></td>
			<td style="text-align:left;width:60%;">
			<div style="word-wrap:break-word;">epoch time in milliseconds when the call from the ads-api has been made</div>
			</td>
		</tr>
		<tr>
			<td style="width:20%"><code>client.useragent </code></td>
			<td style="text-align:left;width:60%;">
			<div style="word-wrap:break-word;">http user-agent header value at session creation</div>
			</td>
		</tr>
		<tr>
			<td style="width:20%"><code>client.ipaddress </code></td>
			<td style="text-align:left;width:60%;">
			<div style="word-wrap:break-word;">http x-forwarded-for header value at session creation, if provided, otherwise the remote address</div>
			</td>
		</tr>
		<tr>
			<td style="width:20%"><code>client.referrer </code></td>
			<td style="text-align:left;width:60%;">
			<div style="word-wrap:break-word;">http referer header value at session creation (note: that is the correct spelling)</div>
			</td>
		</tr>
		<tr>
			<td style="width:20%"><code>client.referer </code></td>
			<td style="text-align:left;width:60%;">
			<div style="word-wrap:break-word;">http referer header value at session creation (http spelling)</div>
			</td>
		</tr>
		<tr>
			<td style="width:20%"><code>client.ipuaid </code></td>
			<td style="text-align:left;width:60%;">
			<div style="word-wrap:break-word;">hash value of client.ipaddress and client.useragent</div>
			</td>
		</tr>
		<tr>
			<td style="width:20%"><code>live.adbreak </code></td>
			<td style="text-align:left;width:60%;">
			<div style="word-wrap:break-word;">(currently unused)</div>
			</td>
		</tr>
		<tr>
			<td style="width:20%"><code>live.adbreakdurationms</code></td>
			<td style="text-align:left;width:60%;">
			<div style="word-wrap:break-word;">Ad break duration in milliseconds</div>
			</td>
		</tr>
		<tr>
			<td style="width:20%"><code>live.adbreakduration </code></td>
			<td style="text-align:left;width:60%;">
			<div style="word-wrap:break-word;">Ad break duration in double-precision floating-point seconds</div>
			</td>
		</tr>
		<tr>
			<td style="width:20%"><code>live.adbreakdurationint </code></td>
			<td style="text-align:left;width:60%;">
			<div style="word-wrap:break-word;">Ad break duration in integer seconds</div>
			</td>
		</tr>
		<tr>
			<td style="width:20%"><code>live.adbreak.timestamputc.wallclock </code></td>
			<td style="text-align:left;width:60%;">
			<div style="word-wrap:break-word;">epoch time in milliseconds when the call to the ads server has been made</div>
			</td>
		</tr>
		<tr>
			<td style="width:20%"><code>live.adbreak.timestamputc.origin </code></td>
			<td style="text-align:left;width:60%;">
			<div style="word-wrap:break-word;">epoch time in milliseconds from the origin chunklist. This value indicates the time when the cue out chunk has been created in the origin chunklist.</div>
			</td>
		</tr>
		<tr>
			<td style="width:20%"><code>live.adbreak.timestamputc.session </code></td>
			<td style="text-align:left;width:60%;">
			<div style="word-wrap:break-word;">epoch time in milliseconds from the ssai chunklist. This value indicates the time of the cue out chunk in the ssai chunklist. Since the adbreak content and the adbreak gap are NOT usually the same, after the 1st adbreak the <code>live.adbreak.timestamputc.origin </code> is different from <code>live.adbreak.timestamputc.session </code>. This value takes into account the time adjustments that have been made in the <span class="”notranslate”">SSAI</span> chunklist.</div>
			</td>
		</tr>
		<tr>
			<td style="width:20%"><code>scte35_eventID</code></td>
			<td style="text-align:left;width:60%;">
			<div style="word-wrap:break-word;">an unique event id passed with an SCTE35 message.</div>
			</td>
		</tr>
		<tr>
			<td style="width:20%"><code>scte35_programID</code></td>
			<td style="text-align:left;width:60%;">
			<div style="word-wrap:break-word;">A unique program id passed with an SCTE35 message.</div>
			</td>
		</tr>
		<tr>
			<td style="width:20%"><code>scte35_availNum</code></td>
			<td style="text-align:left;width:60%;">
			<div style="word-wrap:break-word;">An id for a specific splice time available for ads, send via a SCTE35 message.</div>
			</td>
		</tr>
		<tr>
			<td style="width:20%"><code>scte35_breakDuration</code></td>
			<td style="text-align:left;width:60%;">
			<div style="word-wrap:break-word;">Break duration for the ad break, passed with an SCTE35 message.</div>
			</td>
		</tr>
		<tr>
			<td style="width:20%"><code>scte35_spliceTime</code></td>
			<td style="text-align:left;width:60%;">
			<div style="word-wrap:break-word;">Splice time for an ad break passed with an SCTE35 message.</div>
			</td>
		</tr>
	</tbody>
</table>
</section>

<section class="bcls-section">
<h2 id="Targeting_using_Targeting_using_query_strings">Targeting using query strings (URL parameters)</h2>

<p>Your ad tag, entered in the ad configuration (see <a href="#Create_an_ad_configuration">Create ad configurations</a> below) will typically look something like this:</p>
<textarea class="bcls-code">"https://ad-provider-host.com/path/to/ad-handler?ip={{client.ipaddress}}&amp;num={{random.int32}}&amp;ses={{session.session_id}}&amp;IDFA={{deviceid}}&amp;sitesection={{sitesection}}&amp;breakid={{breakid}}&amp;breaktheme={{breaktheme}}</textarea>

<p>The items inside the double curly braces are variables, also called ad macros, which Live will replace with values, if they exist, when it sends the ad request.</p>

<aside class="bcls-aside bcls-aside--information">Note that the variables that will be useful depend on the ad server.</aside>

<p>These values can be supplied in three ways:</p>

<ul>
	<li>Header information, detailed in the <a href="#Ad_configuration_variables">Ad configuration variables</a> above, is available for any request - you simply need to specify which ones you want with the appropriate key names in your ad configuration.</li>
	<li>Additional session values can be appended to the URL for the live stream, like this:
	<pre>
<code class="language-http notranslate">http://playback.bcovlive.io/e058d9f2737e18/us-west-2/NA/playlist.m3u8<span class="bcls-highlight">?deviceid=123456&amp;sitesection=services</span>"
</code>

</pre>

	<p>You can also add URLs dynamically, using Javascript and the Brightcove Player API:</p>

	<pre class="line-numbers">
<code class="language-html">&lt;!DOCTYPE html&gt;
&lt;body&gt;
  &lt;video
  id="myPlayerID"
  data-video-id="5975635167001"
  data-account="3737230870001"
  data-player="tIG7lVKBm"
  data-embed="default"
  data-application-id
  class="video-js"
  controls
  width="640"
  height="360"&gt;&lt;/video&gt;
  &lt;script src="//players.brightcove.net/3737230870001/tIG7lVKBm_default/index.min.js"&gt;&lt;/script&gt;

  &lt;script type="text/javascript"&gt;
  var player = videojs("myPlayerID");

  player.one("loadstart", function(){
    var sourceUrl = player.currentSource();
    console.log(sourceUrl);
    var liveUrlWithParams = sourceUrl.src + "?player_width={width}&amp;player_height={height}&amp;deviceid={deviceid}";

    player.src([{
      "type": "application/vnd.apple.mpegurl",
      "src": liveUrlWithParams
    }]);
  });
&lt;/script&gt;

&lt;/body&gt;</code></pre>

	<p>Note that the key names in this example correspond to the variable names in the ad tag shown above.</p>
	</li>
	<li>Values for specific ad breaks can be sent with the <a href="#Manual_cue_point_insertion">Manual cue point insertion</a> request (discussed below).</li>
</ul>
</section>

<section class="bcls-section">
<h2 id="Custom_headers_for_ad_requests">Custom headers for ad requests</h2>

<p>The <span class="”notranslate”">SSAI</span> platform can pass custom header with the Ad calls and all beacons used by the backend platform. Some ad servers such as VideoPlaza require custom headers. Custom headers are specified as a set of key-value pairs in an <code>ad_configuration_headers </code> object that is part of the <code>application_ad_configuration </code> (see the next section on <a href="#Create_an_ad_configuration">creating an ad configuration</a>).</p>

<h3>Notes</h3>

<ul>
	<li>Standard headers are handled by default such as:
	<ul>
		<li><code>X-Forwarded-For </code></li>
		<li><code>X-Device-User-Agent </code></li>
	</ul>
	</li>
	<li>Header values can use the <a href="#Ad_configuration_variables">ad configuration variables</a></li>
	<li>Header values can also be static strings</li>
</ul>

<aside class="bcls-aside bcls-aside--warning">Headers will be passed to all downstream requests including ad wrappers or impressions/quartiles so you should use them with caution.</aside>
</section>

<section class="bcls-section">
<h2 id="Create_an_ad_configuration">Create an ad configuration</h2>

<p>To create a new ad configuration, send a <code>POST </code> request to:</p>

<pre class="line-numbers">
<code class="language-http notranslate">https://api.bcovlive.io/v1/ssai/applications
</code>
</pre>

<h3>Sample request body</h3>

<pre class="line-numbers">
<code class="language-json notranslate">{
  "application_ad_configuration": {
    "ad_configuration_description": "Human readable description of the configuration",
    "ad_configuration_expected_response_type": "<span class="bcls-input">Dfp or Vast or SmartXML</span>",
    "ad_configuration_headers": {
    "X-Custom-Header-Rand": "{{random.int32}}",
    "X-VIDEOPLAZA-FORWARDED-FOR": "{{client.ipaddress}}"
    },
    "ad_configuration_headers_for_impressions": false,
    "ad_configuration_strategy": "<span class="bcls-input">SingleAdResponse or MultipleAdResponse</span>",
    "ad_configuration_transforms": [
      {
      "xpath": "/",
      "xslt": "&lt;xsl:stylesheet version=\"1.0\" xmlns:xsl=\"http://www.w3.org/1999/XSL/Transform\" xmlns:Det=\"http://Det.com\"&gt;&lt;xsl:output omit-xml-declaration=\"yes\"/&gt;&lt;xsl:template match=\"node()|@*\"&gt;&lt;xsl:copy&gt;&lt;xsl:apply-templates select=\"node()|@*\"/&gt;&lt;/xsl:copy&gt;&lt;/xsl:template&gt;&lt;/xsl:stylesheet&gt;"
      }
    ],
    "ad_configuration_url_format": "https://ad-provider-host.com/path/to/ad-handler?ip={{client.ipaddress}}&amp;num={{random.int32}}&amp;ses={{session.session_id}}"
  },
  "application_description": "Human readable description of the ad application",
  "account_id": <span class="bcls-input">"USER'S ACCOUNT ID" [Optional - When omitted, Account ID of requesting user is used]</span>
}
</code>
</pre>

<aside class="bcls-aside bcls-aside--information">Note that the <code>account_id </code> here is the Live account id.</aside>

<h3>Sample response</h3>

<pre class="line-numbers">
<code class="language-json notranslate">{
  "application": {
    "account_id": "USER ACCOUNT ID",
    "application_description": "Human readable description of the ad application",
    "application_ad_configuration": {
      "ad_configuration_description": "Human readable description of the configuration",
      "ad_configuration_expected_response_type": "<span class="bcls-highlight">Dfp | Vast | SmartXML</span>",
      "ad_configuration_headers": {
        "X-Custom-Header-Rand": "{{random.int32}}",
        "X-VIDEOPLAZA-FORWARDED-FOR": "{{client.ipaddress}}"
      },
      "ad_configuration_headers_for_impressions": false,
      "ad_configuration_strategy": "<span class="bcls-highlight">SingleAdResponse | MultipleAdResponse</span>",
      "ad_configuration_transforms": [
        {
          "xpath": "/",
          "xslt": "&lt;xsl:stylesheet version=\"1.0\" xmlns:xsl=\"http://www.w3.org/1999/XSL/Transform\" xmlns:Det=\"http://Det.com\"&gt;&lt;xsl:output omit-xml-declaration=\"yes\"/&gt;&lt;xsl:template match=\"node()|@*\"&gt;&lt;xsl:copy&gt;&lt;xsl:apply-templates select=\"node()|@*\"/&gt;&lt;/xsl:copy&gt;&lt;/xsl:template&gt;&lt;/xsl:stylesheet&gt;"
        }
      ],
      "ad_configuration_url_format": "https://ad-provider-host.com/path/to/ad-handler?ip={{client.ipaddress}}&amp;num={{random.int32}}&amp;ses={{session.session_id}}"
    },
    "application_id": <span class="bcls-highlight">"APPLICATION ID"</span>
  },
  "inserted": true
}
</code>
</pre>
</section>

<section class="bcls-section">
<h2 id="Update_an_ad_configuration">Update an ad configuration</h2>

<p>Updating an ad configuration is very similar to creating one. Make a <code>PUT </code> request to:</p>

<pre class="line-numbers">
<code class="language-http notranslate">https://api.bcovlive.io/v1/ssai/applications/application/<span class="bcls-input">APPLICATION_ID</span>
</code>
</pre>

<h3>Sample request body</h3>

<pre class="line-numbers">
<code class="language-json notranslate">{
  "application_ad_configuration": {
    "ad_configuration_description": "Some Updated Description Value",
    "ad_configuration_expected_response_type": "<span class="bcls-input">Dfp or Vast or SmartXML</span>,
    "ad_configuration_headers": {
      "X-Custom-Header-Rand": "{{random.int32}}",
      "X-VIDEOPLAZA-FORWARDED-FOR": "{{client.ipaddress}}"
    },
    "ad_configuration_headers_for_impressions": false,
    "ad_configuration_strategy": "<span class="bcls-input">SingleAdResponse or MultipleAdResponse</span>",
    "ad_configuration_transforms": [
      {
      "xpath": "/",
      "xslt": "&lt;xsl:stylesheet version=\"1.0\" xmlns:xsl=\"http://www.w3.org/1999/XSL/Transform\" xmlns:Det=\"http://Det.com\"&gt;&lt;xsl:output omit-xml-declaration=\"yes\"/&gt;&lt;xsl:template match=\"node()|@*\"&gt;&lt;xsl:copy&gt;&lt;xsl:apply-templates select=\"node()|@*\"/&gt;&lt;/xsl:copy&gt;&lt;/xsl:template&gt;&lt;/xsl:stylesheet&gt;"
      }
    ],
    "ad_configuration_url_format": "https://updated-ad-provider-host.com/path/to/ad-handler?ip={{client.ipaddress}}&amp;num={{random.int32}}&amp;ses={{session.session_id}}"
  },
  "application_description": "Human readable description of the ad application",
  "account_id": <span class="bcls-input">"USER'S ACCOUNT ID" [Optional - When omitted, Account ID of requesting user is used]</span>
}
</code>
</pre>

<aside class="bcls-aside bcls-aside--information">Note that the <code>account_id </code> here is the Live account id.</aside>

<h3>Sample response</h3>

<pre class="line-numbers">
<code class="language-json notranslate">{
  "account_id": "USER ACCOUNT ID",
  "application_description": "Human readable description of the ad application",
  "application_ad_configuration": {
    "ad_configuration_description": "Some Updated Description Value",
    "ad_configuration_expected_response_type": "<span class="bcls-highlight">Dfp | Vast | SmartXML</span>",
    "ad_configuration_headers": {
    "X-Custom-Header-Rand": "{{random.int32}}",
    "X-VIDEOPLAZA-FORWARDED-FOR": "{{client.ipaddress}}"
    },
    "ad_configuration_headers_for_impressions": false,
    "ad_configuration_strategy": "<span class="bcls-highlight">SingleAdResponse | MultipleAdResponse</span>",
    "ad_configuration_transforms": [
      {
      "xpath": "/",
      "xslt": "&lt;xsl:stylesheet version=\"1.0\" xmlns:xsl=\"http://www.w3.org/1999/XSL/Transform\" xmlns:Det=\"http://Det.com\"&gt;&lt;xsl:output omit-xml-declaration=\"yes\"/&gt;&lt;xsl:template match=\"node()|@*\"&gt;&lt;xsl:copy&gt;&lt;xsl:apply-templates select=\"node()|@*\"/&gt;&lt;/xsl:copy&gt;&lt;/xsl:template&gt;&lt;/xsl:stylesheet&gt;"
      }
    ],
    "ad_configuration_url_format": "https://updated-ad-provider-host.com/path/to/ad-handler?ip={{client.ipaddress}}&amp;num={{random.int32}}&amp;ses={{session.session_id}}"
  },
  "application_id": <span class="bcls-highlight">"APPLICATION ID"</span>
}
</code>
</pre>
</section>

<section class="bcls-section">
<h2 id="Get_all_ad_configurations">Get all ad configurations</h2>

<p>To retrieve all the ad configurations for an account, submit a <code>GET </code> request to:</p>

<pre class="line-numbers">
<code class="language-http notranslate">https://api.bcovlive.io/v1/ssai/applications/account/<span class="bcls-input">account_id</span>
</code>
</pre>

<aside class="bcls-aside bcls-aside--information">Note that the <code>account_id </code> here is the Live account id.</aside>

<h3>Sample response</h3>

<pre class="line-numbers">
<code class="language-json notranslate">[
  {
    "application_id": "APPLICATION_ID_1",
    "application_description": "DFP Single Midroll",
    "application_ad_configuration": {
    "ad_configuration_description": "DFP Test Config Single Midroll",
    "ad_configuration_strategy": "MultipleAdResponse",
    "ad_configuration_transforms": [],
    "ad_configuration_url_format": "https://ad-provider-host.com/path/to/ad-handler",
    "ad_configuration_expected_response_type": "Dfp"
    },
    "account_id": "ACCOUNT_ID"
  },
  {
    "application_id": "APPLICATION_ID_2",
    "application_description": "Test DFP Single Midroll"
    "application_ad_configuration": {
    "ad_configuration_description": "DFP Test Config Single Midroll",
    "ad_configuration_strategy": "MultipleAdResponse",
    "ad_configuration_transforms": [
    {
      "xslt": "&lt;xsl:stylesheet version=\"1.0\" xmlns:xsl=\"http://www.w3.org/1999/XSL/Transform\" xmlns:Det=\"http://Det.com\"&gt;&lt;xsl:output omit-xml-declaration=\"yes\"/&gt;&lt;xsl:template match=\"node()|@*\"&gt;&lt;xsl:copy&gt;&lt;xsl:apply-templates select=\"node()|@*\"/&gt;&lt;/xsl:copy&gt;&lt;/xsl:template&gt;&lt;/xsl:stylesheet&gt;",
      "xpath": "/"
    }
    ],
    "ad_configuration_url_format": "https://ad-provider-host.com/path/to/ad-handler?ip={{client.ipaddress}}&amp;num={{random.int32}}&amp;ses={{session.session_id}}",
    "ad_configuration_expected_response_type": "Dfp"
    },
    "account_id": "ACCOUNT_ID"
  }
]
</code>
</pre>
</section>

<section class="bcls-section">
<h2 id="Get_an_ad_configuration">Get an ad configuration</h2>

<p>You can also retrieve a specific ad configuration by its <code>application_id </code> by sending <code>GET </code> request to:</p>

<pre class="line-numbers">
<code class="language-http notranslate">https://api.bcovlive.io/v1/ssai/applications/application/<span class="bcls-input">APPLICATION_ID</span>
</code>
</pre>

<h3>Sample response</h3>

<pre class="line-numbers">
<code class="language-json notranslate">{
  "application_id": "APPLICATION_ID",
  "application_description": "Test DFP Single Midroll",
  "application_ad_configuration": {
    "ad_configuration_description": "DFP Test Config Single Midroll",
    "ad_configuration_strategy": "MultipleAdResponse",
    "ad_configuration_transforms": [
      {
      "xslt": "&lt;xsl:stylesheet version=\"1.0\" xmlns:xsl=\"http://www.w3.org/1999/XSL/Transform\" xmlns:Det=\"http://Det.com\"&gt;&lt;xsl:output omit-xml-declaration=\"yes\"/&gt;&lt;xsl:template match=\"node()|@*\"&gt;&lt;xsl:copy&gt;&lt;xsl:apply-templates select=\"node()|@*\"/&gt;&lt;/xsl:copy&gt;&lt;/xsl:template&gt;&lt;/xsl:stylesheet&gt;",
      "xpath": "/"
      }
    ],
    "ad_configuration_url_format": "https://ad-provider-host.com/path/to/ad-handler?ip={{client.ipaddress}}&amp;num={{random.int32}}&amp;ses={{session.session_id}}",
    "ad_configuration_expected_response_type": "Dfp"
  },
  "account_id": "ACCOUNT_ID"
}
</code>
</pre>
</section>

<section class="bcls-section">
<h2 id="Delete_an_ad_configuration">Delete an ad configuration</h2>

<p>To delete an ad configuration, send a <code>DELETE </code> request to:</p>

<pre class="line-numbers">
<code class="language-http notranslate">https://api.bcovlive.io/v1/ssai/applications/application/<span class="bcls-input">APPLICATION_ID</span>
</code>
</pre>

<h3>Sample response</h3>

<pre class="line-numbers">
<code class="language-json notranslate">{
"application_id": "APPLICATION_ID",
"deleted": true
}
</code>
</pre>
</section>

<section class="bcls-section">
<h2 id="Managing_slates">Managing slates</h2>

<p>Slates are your own assets used to fill unused ad time. You can use slates to provide a "be right back" message or any content that you like.</p>

<p>Below are details of the API requests to add and manage slate assets.</p>

<h3>Ingest slate media source asset</h3>

<p>To add a new slate asset, submit a <code>POST </code> request to:</p>

<pre class="line-numbers">
<code class="language-http notranslate">https://api.bcovlive.io/v1/ssai/slates
</code>
</pre>

<h4>Sample request body</h4>

<pre class="line-numbers">
<code class="language-json notranslate">{
"source_url": "https://somesourceasset.com/slate-to-ingest.mp4",
<em>"account_id": "ACCOUNT_ID", [Optional - When omitted, Account ID of the requesting user is used.</em>
<em>"source_description": "User identifiable description for the slate" [Optional]</em>
}
</code>
</pre>

<aside class="bcls-aside bcls-aside--information">Note that the <code>account_id </code> here is the Live account id.</aside>

<h4>Sample response</h4>

<pre class="line-numbers">
<code class="language-json notranslate">{
"media_source_asset_id": "NEW_UUID",
"account_id": "ACCOUNT_ID",
"media_source_asset_default": false,
"media_source_asset_type": "slate",
"media_source_asset_url": "https://somesourceasset.com/slate-to-ingest.mp4",
"media_source_asset_status": "transcoding"
"media_source_asset_description": "User identifiable description for the slate"
}
</code>
</pre>

<aside class="bcls-aside bcls-aside--information">Note: that setting <code>media_source_asset_default</code> is <strong>not</strong> supported at this time.</aside>

<h3>Delete slate media source asset</h3>

<p>To delete a slate media asset, send a <code>DELETE </code> request to:</p>

<pre class="line-numbers">
<code class="language-http notranslate">https://api.bcovlive.io/v1/ssai/slates/slate/<span class="bcls-input">SLATE_MSA_ID</span>
</code>
</pre>

<h4>Sample response</h4>

<pre class="line-numbers">
<code class="language-json notranslate">{
"media_source_asset_id": "MSA_UUID",
"media_source_asset_type": "slate",
"media_source_asset_url": "http://someS3urlpath/media.mp4",
"media_source_asset_default": false,
"media_source_asset_status": "ready",
"account_id": "ACCOUNT_ID"
}
</code>
</pre>

<h3>Get slate media source assets</h3>

<p>You can retrieve an array of all the slate assets for an account by sending a <code>GET </code> request to:</p>

<pre class="line-numbers">
<code class="language-http notranslate">https://api.bcovlive.io/v1/ssai/slates/account/<span class="bcls-input">account_id</span>
</code>
</pre>

<aside class="bcls-aside bcls-aside--information">Note that the <code>account_id </code> here is the Live account id.</aside>

<h4>Sample response</h4>

<pre class="line-numbers">
<code class="language-json notranslate">[
{
"media_source_asset_id": "MSA_UUID_1",
"media_source_asset_type": "slate",
"media_source_asset_default": false,
"media_source_asset_url": "http://someS3urlpath.com/media.mp4",
"account_id": "ACCOUNT_ID",
"media_source_asset_status": "ready"
},
{
"media_source_asset_id": "MSA_UUID_2",
"media_source_asset_type": "slate",
"media_source_asset_default": true,
"media_source_asset_url": "http://someS3urlpath.com/media.mp4",
"account_id": "ACCOUNT_ID",
"media_source_asset_status": "ready"
}
]
</code>
</pre>
</section>


<section class="bcls-section">
<h2 id="notes_on_dfp">Notes on DFP</h2>

<p>If you are obtaining ads from DFP, here are some things to keep in mind to help prevent issues.</p>

<h3>Ad tag</h3>

<p>When you are creating an ad tag for Live, be sure you are following the proper guidelines and including <code>/live </code>. See the DFP document <a href="https://support.google.com/dfp_premium/answer/1068325?hl=en">Create a master video tag manually</a> for full details.</p>

<h3>Concurrency</h3>

<p>If you are expecting a high amount of concurrency we recommended that you talk to your DFP account team.</p>

<h3>Single/multiple ad responses</h3>

<p>The <code>singleadresponse </code> and <code>multiadresponse </code> parameters are not currently used by <span class="”notranslate”">SSAI</span>.</p>

<p>Live <span class="”notranslate”">SSAI</span> only makes a single ad server call and expects that the response will contain all the ads for the break with the exception that it will follow any necessary ad wrappers with a limit of 5 redirects per ad. The following ad response formats are accepted and will be parsed as follows:</p>

<ul>
	<li>VAST - Single response or a pod of ads in a single response</li>
	<li>DFP Ad Rules - Aggregates all available ads in the response including pre-, mid-, post-roll defined ads</li>
	<li>Smart XML - Aggregates all available ads in the response including pre-, mid-, post-roll defined ads</li>
</ul>
</section>

<section class="bcls-section">
<h2 id="Known_issues">Known issues</h2>

<ul>
	<li>SSAI requires that the live streaming video have an audio track.</li>
	<li>If the VAST returned has the same ad ID, then the server will not request the ad content, even though the ad URL uses dynamic variables to make it a unique URL. This does <strong>not</strong> apply if you are using DFP for ads.</li>
	<li>With DFP, while you can use the same ad ID, there still needs to be a different creative ID - in other words, you can't do a simple swap of the MediaFile.</li>
	<li>
	<p>If an ad break has a duration less than the MAX duration of the ad URL (min_ad_duration=0&amp;max_ad_duration=30000), if ad is returned longer than the ad break, the ad will not be played.</p>
	</li>
	<li>
	<p>VPAID or clickable ads are not supported for <span class="”notranslate”">Brightcove Live SSAI</span>.</p>
	</li>
	<li>
	<p>When an ad break has remaining time shorter than the segment seconds of the stream and a slate is displayed, the slate is displayed for its segment duration and the actual ad break will be longer than expected.</p>
	</li>
	<li>The first time the ad is seen by our system, it will not play until it is transcoded and ready to deliver.</li>
</ul>
</section>

<section class="bcls-section">
<h2 id="elementalSample">Appendix</h2>

<p>Below is a screenshot to show a sample cue point setup for the Elemental encoder.</p>

<figure class="bcls-figure"><img class="bcls-image" alt="Elemental Cue Point Setup" src="//learning-services-media.brightcove.com/doc-assets/node/17763-server-side-ad-insertion-using-brightcove-live-api/elemental-screenshot.png" />
<figcaption class="bcls-caption--image">Elemental Cue Point Setup</figcaption>
</figure>
</section>
</article>


<!-- END DRUPAL CONTENT -->
  </div>
</div>
<!-- bcl scripts -->
<script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.2.3/jquery.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/fastclick/1.0.6/fastclick.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/foundation/5.5.3/js/foundation.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/handlebars.js/4.0.5/handlebars.min.js"></script>
<script src="/en/scripts/docs-nav-data.min.js"></script>
<script src="/en/scripts/bcls-doc-site-v3.js"></script>
<script src="//learning-services-media.brightcove.com/doc-assets/js/bcls-utils.js"></script>
<script src="//learning-services-media.brightcove.com/doc-assets/js/prism/prism.js"></script>
<script>
$(document).foundation();
</script>
<!-- Any scripts specific to page samples should go here -->
</body>

</html>
