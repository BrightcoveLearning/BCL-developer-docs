<!DOCTYPE html>
<html lang="en">

<head>
  <!-- Begin Drupal Taxonomy Data -->
  <meta name="products" content="Video Cloud, Brightcove Player">
  <meta name="role" content="Device SDK Developer">
  <meta name="task" content="Develop with the Native SDKs">
  <meta name="topic" content="Troubleshooting/Error Handling">
  <meta name="sdk" content="iOS,tvOS,Android">
  <meta name="keywords" content="device,SDK,FAQ">
  <!-- End Drupal Taxonomy Data -->

  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta name="viewport" content="initial-scale=1.0, maximum-scale=1.0, user-scalable=no, width=device-width" />
  <meta name="robots" content="noindex">
  <!-- change title to match the h1 heading -->
  <title>Advertising with the SSAI Plugin</title>

  <link rel="stylesheet" type="text/css" href="//cdnjs.cloudflare.com/ajax/libs/foundation/5.5.3/css/foundation.min.css" />
  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/foundation/5.5.3/css/normalize.css" />
  <link href="//fonts.googleapis.com/css?family=Open+Sans:400italic,700italic,400,700" rel="stylesheet" type="text/css">
  <script src="//use.edgefonts.net/source-code-pro.js"></script>
  <link rel="stylesheet" href="//learning-services-media.brightcove.com/doc-assets/js/prism/prism.css">
  <link rel="stylesheet" href="//docs.brightcove.com/en/styles/template-less/css/bcls-doc.css">
  <link rel="stylesheet" href="/en/styles/foundation-fixes.css">

  <script src="//cdnjs.cloudflare.com/ajax/libs/foundation/5.5.3/js/vendor/modernizr.js"></script>

</head>

<body>
  <!-- header navbar -->
  <div id="navWrapper" class="fixed"></div>
  <!-- breadcrumbs -->
  <nav id="breadCrumbWrapper" class="breadcrumbs show-for-medium-up"></nav>
  <!-- search -->
  <div id="searchModal" class="reveal-modal" data-reveal></div>
  <!-- content -->
  <div class="row">
    <div class="sidebar large-2 columns show-for-large-up">
      <div id="sidenav" class="side-nav"></div>
    </div>
    <div id="main" class="large-10 small-12 columns">
      <h1>Using Playback Authorization Service with the Native SDKs</h1>

      <!-- BEGIN DRUPAL CONTENT -->

<article class="bcls-article">
<section class="bcls-section">
  <p>In this topic, you will learn how to configure Brightcove Player to use Brightcove's Playback Authorization Service.</p>
</section>

  <section class="bcls-section">
    <h2 id="Introduction">Introduction</h2>

    <p>Brightcove's Playback Authorization Service (PAS) offers an extra level of security when using Dynamic Delivery with DRM-protected or HTTP Live Streaming Encryption (HLSe) content. With PAS, license requests will be authenticated using a signed <a href="https://jwt.io/introduction/">JSON Web Token (JWT)</a>. The token is used when requesting the video license, once the video has been loaded to the player and the source has been selected.</p>
    <p>This document focuses on using PAS with Brightcove Player. For more information about PAS in general, and using it with the Brightcove Player Native SDKs, see the following documents:</p>
      <ul>
        <li><a href="http://docs.brightcove.com/en/staging/pas/overview-playback-Authorization-service.html">Overview: Playback Authorization Service</a></li>
        <li><a href="https://docs.brightcove.com/en/staging/pas/technical-workflow-pas.html">Technical Workflow: Playback Authorization Service</a></li>
        <li><a href="https://docs.brightcove.com/en/staging/pas/using-pas-with-sdks.html">Using Playback Authorization Service with the Native SDKs</a></li>
        <!-- <li><a href="http://docs.brightcove.com/en/staging/test-matt/using-pas-with-bcp.html">Using Playback Authorization Service with Brightcove Player</a></li> -->
      </ul>
  </section>

  <section class="bcls-section">
    <h2 id="section-name2">Brightcove Player implementation</h2>
    <p>There are a number of possibilities for implementing PAS with Brightcove Player. They are listed here, then detailed in later sections of this document.</p>
    <ul>
      <li><a href="#Using_a_token_in_the_catalog_parameters">Using a token in the catalog parameters</a></li>
      <li><a href="#Using_Video.js_middleware">Using Video.js middleware</a></li>
    </ul>
  </section>

  <section class="bcls-section">
    <h2 id="Using_a_token_in_the_catalog_parameters">Using a token in the catalog parameters</h2>
    <p>The first approach is to pass a string token as part of a <a href="https://support.brightcove.com/player-catalog#Catalog_parameters_object">catalog parameters</a> object, using the property name <code>bcovAuthToken</code>.</p>
    <p>This approach will work for both DRM as well as HLSe. The player will detect the type of source being loaded from the Playback API and provide the correct implementation for that source.</p>
    <aside class="bcls-aside bcls-aside--information language-editable">Note: This implementation requires Player version <strong>6.33.0</strong> or greater.</aside>
    <p>This sample implementation code uses the <a href="https://support.brightcove.com/player-catalog#get_method">catalog.get()</a> method to request the video while supplying the token (which would need to replace the <code>&lt;BCOV_AUTH_TOKEN&gt;</code> placeholder). Be sure NOT to include the video ID in the <code>&lt;video-js&gt;</code> tag.</p>
    <pre class="line-numbers">
<code class="language-html">&lt;video-js id=&quot;myPlayerID&quot;
  data-account=&quot;1507807800001&quot;
  data-player=&quot;default&quot;
  data-embed=&quot;default&quot;
  controls
  data-application-id&gt;&lt;/video-js&gt;
&lt;script src=&quot;//players.brightcove.net/1507807800001/default_default/index.min.js&quot;&gt;&lt;/script&gt;

&lt;script&gt;
  (function() {
    var myPlayer = videojs.getPlayer('myPlayerID');

    myPlayer.catalog.get({
      type: 'video',
      id: '6015247091001',
      bcovAuthToken: '<span class="bcls-highlight">&lt;BCOV_AUTH_TOKEN&gt;</span>'
    })
      .then(function(videoReturned){
        myPlayer.catalog.load(videoReturned);
      })
      .catch(function(err){
        console.log('err:', err);
      });
  })();
&lt;/script&gt;</code></pre>
  <p>This code uses a JavaScript Promise. If you would like to learn more about this concept, see the <a href="https://support.brightcove.com/concepts-using-javascript-promises">Concepts: Using JavaScript Promises</a> document.</p>
  </section>

  <section class="bcls-section">
    <h2 id="Using_Video.js_middleware">Using Video.js middleware</h2>
    <p><p>The next three implementations of using Brightcove Player with PAS use Video.js middleware. At a very high level, the use cases where middleware is of most value is when you want to intercept and alter core behaviors of the player, such as setting the source or current time. Video.js middleware in general is not discussed in this document, but the actual middleware code is used. Here are document  sources that do detail middleware:</p>
      <ul>
      	<li><a href="http://docs.videojs.com/tutorial-middleware.html">Middleware (from the Video.js documentation set)</a></li>
      	<li><a href="http://blog.videojs.com/feature-spotlight-middleware/">Feature Spotlight: Middleware (from the Video.js blog)</a></li>
      	<li><a href="https://support.brightcove.com/brightcove-player-sample-disable-forward-scrubbing">Brightcove Player Sample: Disable Forward Scrubbing</a></li>
      </ul>
      <p>The simplest configuration is to add a middleware script to the player configuration. This is valid only for HLSe without SSAI, and will not work with DRM. It is up to the customer's implementation as to how the token is generated and passed to the player. Three examples follow.</p>
      <h3>Advanced (in-page) implementation</h3>
      <p>The following code uses Video.js middleware with the Advanced (in-page) player implementation.</p>
      <pre class="line-numbers">
<code class="language-javascript">videojs.use('application/vnd.apple.mpegurl', function(player) {
  return {
    setSource: function(srcObj, next) {

      // Get token from an attribute you added to the player
      var token = player.el().getAttribute('data-token');

      srcObj.src += '&bcov_auth=' + token;
      next(null, srcObj);
    }
  };
});</code></pre>

      <h3>Standard (iframe) implementation</h3>
      <p>The following code uses Video.js middleware with the Standard (iframe) player implementation.</p>
      <pre class="line-numbers">
<code class="language-javascript">videojs.use('application/vnd.apple.mpegurl', function(player) {
  return {
    setSource: function(srcObj, next) {

      // Get token from a query param
      var token = // parse location.search to get paramâ€¦

      srcObj.src += '&bcov_auth=' + token;
      next(null, srcObj);
    }
  };
});</code></pre>


      <h3>From an external API</h3>
      <p>The following code uses Video.js middleware with an external API.</p>
      <pre class="line-numbers">
<code class="language-javascript">videojs.use('application/vnd.apple.mpegurl', function(player) {
  return {
    setSource: function(srcObj, next) {

      // Get from API
      // Response here is `{ "token": "the token" }`

      videojs.xhr({
        json: true,
        url: 'token.json?video=' + player.mediainfo.id
      }, function(err, resp) {
        if (err) {
          next(err, srcObj);
        }
        srcObj.src += '&bcov_auth=' + resp.body.token;
        next(null, srcObj);
      });
    }
  };
});</code></pre>
  </section>

  <section class="bcls-section">
  <h2 id="Related_topics">Related topics</h2>

  <ul>
    <li><a href="http://docs.brightcove.com/en/staging/pas/overview-playback-Authorization-service.html">Overview: Playback Authorization Service</a></li>
    <li><a href="https://docs.brightcove.com/en/staging/pas/technical-workflow-pas.html">Technical Workflow: Playback Authorization Service</a></li>
    <li><a href="https://docs.brightcove.com/en/staging/pas/using-pas-with-sdks.html">Using Playback Authorization Service with the Native SDKs</a></li>
    <!-- <li><a href="http://docs.brightcove.com/en/staging/test-matt/using-pas-with-bcp.html">Using Playback Authorization Service with Brightcove Player</a></li> -->
  </ul>

  </section>

</article>

      <!-- END DRUPAL CONTENT -->
    </div>
  </div>

  <!-- bcl scripts -->
  <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.2.3/jquery.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/fastclick/1.0.6/fastclick.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/foundation/5.5.3/js/foundation.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/handlebars.js/4.0.5/handlebars.min.js"></script>
  <script src="/en/scripts/docs-nav-data.min.js"></script>
  <script src="/en/scripts/bcls-doc-site-v3.js"></script>
  <script src="//learning-services-media.brightcove.com/doc-assets/js/bcls-utils.js"></script>
  <script src="//learning-services-media.brightcove.com/doc-assets/js/prism/prism.js"></script>
  <script>
    $(document).foundation();
  </script>
  <!-- Any scripts specific to page samples should go here -->
</body>

</html>
