<!DOCTYPE html>
<html lang="en">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="initial-scale=1.0, maximum-scale=1.0, user-scalable=no, width=device-width" />
    <title id="bclPageTitle">Advertising with IMA3 Plugin Guide</title>
    <link rel="stylesheet" type="text/css" href="//cdnjs.cloudflare.com/ajax/libs/foundation/5.5.3/css/foundation.min.css" />
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/foundation/5.5.3/css/normalize.css" />
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:400italic,700italic,400,700' rel='stylesheet' type='text/css'>
    <script src="//use.edgefonts.net/source-code-pro.js"></script>
    <link rel="stylesheet" href="//learning-services-media.brightcove.com/doc-assets/js/prism/prism.css">
    <link rel="stylesheet" href="//docs.brightcove.com/en/styles/template-less/css/bcls-doc.css">
    <link rel="stylesheet" href="/en/styles/foundation-fixes.css">

    <script>
        (function(i, s, o, g, r, a, m) {
            i['GoogleAnalyticsObject'] = r;
            i[r] = i[r] || function() {
                (i[r].q = i[r].q || []).push(arguments)
            }, i[r].l = 1 * new Date();
            a = s.createElement(o),
                m = s.getElementsByTagName(o)[0];
            a.async = 1;
            a.src = g;
            m.parentNode.insertBefore(a, m)
        })(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga');

        ga('create', 'UA-2728311-29', 'auto');
        ga('send', 'pageview');
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/foundation/5.5.3/js/vendor/modernizr.js"></script>

</head>

<body>
    <!-- header navbar -->
    <div id="navWrapper" class="fixed"></div>
    <!-- breadcrumbs -->
    <nav id="breadCrumbWrapper" class="breadcrumbs show-for-medium-up"></nav>
    <!-- search -->
    <div id="searchModal" class="reveal-modal" data-reveal></div>
    <!-- content -->
    <div class="row">
        <div class="sidebar large-2 columns show-for-large-up">
            <div id="sidenav" class="side-nav"></div>
        </div>
        <div id="main" class="large-10 small-12 columns">
          <h1 id="bclPageHeading">Advertising with IMA3 Plugin Guide</h1>
      <!-- begin drupal content -->

      <style type="text/css">
       iframe {
         width: 640px;
         height: 360px;
       }
      </style>

      <article class="bcls-article">
            <header id="bcls_header" class="bcls-header">
                <!-- content starts here -->
              <p class="BCL-objective">This topic covers the use of the IMA plugin and how it can be implemented using <span class="video-cloud-only">Video Cloud Studio</span><span class="perform-only">Perform Studio</span> and through custom coding.</p>
              <p>The IMA plugin integrates the Brightcove player with Google&#39;s Interactive Media Ads (IMA) for HTML5 version 3. This allows you to request and track VAST ads for your player. For details about Google IMA, see the <a href="https://developers.google.com/interactive-media-ads/docs/sdks/html5/v3/">Using the IMA HTML5 SDK Version 3</a> document.</p>
            </header>
            <section id="sample" class="bcls-section">
             <h2>Player sample</h2>
              <p>The sample video below demonstrates the use of the IMA Plugin. Play the video to see a pre-roll, a skippable mid-roll at 5 seconds, then finally a post-roll.</p>
              <div><iframe src='//players.brightcove.net/1752604059001/63dd4825-e4fd-4cd7-a69f-7fd90e10cbd6_default/index.html?videoId=4607357817001' allowfullscreen webkitallowfullscreen mozallowfullscreen></iframe></div>
              <p>This topic contains the following sections:</p>
              <ul>
                <li><a href="#testadserver">Testing the ad server</a></li>
                    <li><a href="#playersmodule">Implementing using Players module</a></li>
                <li><a href="#options">Options</a></li>
                <li><a href="#html5settings">HTML5 settings</a></li>
                <li><a href="#events">Events</a></li>
                <li><a href="#playbackmodes">Playback modes</a></li>
                <li><a href="#issues">Known issues</a></li>
              </ul>
              <aside class="bcls-aside bcls-aside--information">Note: Initial behavior concerning the timing of loading of video advertisements is described in the <a href="#requestMode">requestMode</a> option. Be sure to check this as default behavior is undesirable for some types of ad servers/networks.</aside>
           </section>
           <section id="testadserver" class="bcls-section">
            <h2>Testing the ad server</h2>
            <p>The first thing you should do is verify the validity of the ad tag you are planning to use. Be sure you have copied its URL and browse to the following page: <a href="//developers.google.com/interactive-media-ads/docs/vastinspector_dual" target="_blank" rel="noopener noreferrer">Video Suite Inspector</a> (clicking this link will cause the page to open in a new window or tab)</p>
            <p>Paste your ad tag URL into the <strong>Input type</strong> form input field. Click <strong>Test Ad</strong> and you will see your ad(s) play, with the Google supplied motorcycle race video interspersed. If your ad tag is not working in this test environment, it will not work with Brightcove Player.</p>

            <aside class="bcls-aside bcls-aside--information">Note: The VAST ad tag can be hosted by your ad provider, or you can copy the XML and host it on your own URL.</aside>
          </section>
          <section id="playersmodule" class="bcls-section">
              <h2>Implement using Players module</h2>
                  <div id="player" class="video-cloud-only">
                    <video
                      data-account="20318290001"
                      data-player="E16-WGGOe"
                      data-embed="default"
                      data-video-id="4043519495001"
                      class="video-js" controls crossorigin="anonymous" width="640" height="360">
                      </video>
                    <script src="//players.brightcove.net/20318290001/E16-WGGOe_default/index.min.js"></script>
                </div>
              <aside class="bcls-aside bcls-aside--information">Note: In the steps below you add the IMA3 plugin using the <strong>ADVERTISING</strong> section of the player's configuration page. As noted below step 11, when you use the <strong>ADVERTISING</strong> section to add the plugin, that will be reflected in the <strong>PLUGINS</strong> section. If for some reason you need to use an older version of the IMA3 plugin, which is strongly discouraged, you will need to set the <strong>Enable IMA Ads</strong> to <strong>No</strong>, then load and configure the IMA3 plugin using the <strong>PLUGINS</strong> section.</aside>

              <p>To implement the IMA Plugin using the Players module, follow these steps:</p>
              <ol class="bcls-tasklist">
                  <li>Click <strong>Players</strong> in the navigation header to open the Players module.</li>
                  <li>Click the link for the player you want to configure.</li>
                  <li>Locate the <strong>Advertising</strong> section and click <strong>Edit</strong></li>
                  <li>Click <strong>Yes</strong> to enable IMA ads.</li>
                  <li>Enter the <strong>Server URL</strong> for the ad server.</li>
                  <li>Select the <strong>Request Ads</strong> setting.
                    <ul>
                    <li><strong>On load -</strong> Ads are requested immediately when the player loads (this is normally the best experience for DFP / VPAID)</li>
                    <li><strong>On play -</strong> The first ad request is delayed until playback is initiated</li>
                    <li><strong>On demand -</strong> All ad requests will be initiated programmatically using the <code>player.ima3.adrequest()</code> method</li>
                    </ul>
                  </li>
                  <li>Select the ad <strong>Content Type</strong>.    The Content Type determines the ad integration technologies to attempt to use. The player  will test each ad technology on initialization and use the first supported one for the lifetime of the player.<ul>
                    <li><strong>Flash preferred -</strong> Use Flash-based ads, if not available, use HTML5-based ads</li>
                    <li><strong>HTML5 preferred -</strong> Use HTML5-based ads, if not available, use Flash-based ads</li>
                    <li><strong>HTML5 only -</strong> Use only HTML5-based ads</li>
                  </ul></li>
                  <li>Select the ad <strong>VPAID Mode</strong>.    The VPAID Mode is used to enable VPAID 2 support in IMA ads.
                    <ul>
                      <li><strong>Enabled -</strong> Play VPAID ads in an iframe with a different domain</li>
                      <li><strong>Insecure -</strong> Play VPAID ads in an iframe with the same domain</li>
                      <li><strong>Disabled -</strong> VPAID ads throw an error                  </li>
                    </ul>
                  </li>
                  <li>Set the <strong>Timeout</strong> values.
                    <ul>
                      <li><strong>Initialization -</strong> The maximum amount of time to wait, in milliseconds, for an ad  to initialize before playback</li>
                      <li><strong>Pre-roll -</strong> The maximum amount of time to wait for an ad  to initiate a preroll, in milliseconds</li>
                      <li><strong>Post-roll -</strong> The maximum amount of time to wait for an ad  to initiate a postroll, in milliseconds</li>
                    </ul>
                    <figure class="bcls-figure">
                        <img class="bcls-image" src="//learning-services-media.brightcove.com/doc-assets/player-development/advertising/ima3-plugin/studio-ad-props.png" alt="ad properties in Studio">
                    </figure>
                  </li>
                  <li>Click <strong>Save</strong> to save the changes.</li>
              </ol>
              <p>When  the changes to the advertising properties are saved, the IMA plugin will be configured as part of the Plugin settings.</p>
              <figure class="bcls-figure">
                  <img class="bcls-image" src="//learning-services-media.brightcove.com/doc-assets/player-development/advertising/ima3-plugin/studio-ima-plugin-props.png" alt="IMA3 properties in Studio">
              </figure>
              <p>The IMA plugin does support additional properties that are not available in the UI. If needed, modify the IMA plugin JSON to include any other options you may need.</p>
              <aside class="bcls-aside bcls-aside--tip">Note: You may want to dynamically build the <code>serverURL</code> at the client (which means the IMA3 plugin would already be initialized), for example after a user login. You can do this by setting that value to an empty string in the <strong>options</strong> <code>{ "serverUrl": "" }</code>, then later assign the value programmatically.</aside>
            </section>
            <section id="JSON_vs_JavaScript_notation" class="bcls-section">
              <h2>JSON vs JavaScript notation</h2>
              <p>If you examine the <strong>Options</strong> section above, you see the configuration information is supplied in JSON format. If you are using code to implement your IMA3 plugin, the notation for setting options with JavaScript is slightly different.</p>
              <p>Here you see options in JSON format you could use in Studio:</p>
              <pre class="line-numbers"><code class="language-json">{
  "adTechOrder": [
    "flash",
    "html5"
  ],
  "postrollTimeout": 2000,
  "prerollTimeout": 1000,
  "requestMode": "onload",
  "serverUrl": "http://solutions.brightcove.com/bcls/brightcove-player/vmap/simple-vmap.xml?cust_params={mediainfo.ad_keys}",
  "timeout": 5000
}</code></pre>
              <p>If you are using JavaScript to configure your options, it would appear as follows:</p>
              <pre class="line-numbers"><code class="language-javascript">{
  adTechOrder: [
    'flash',
    'html5'
  ],
  postrollTimeout: 2000,
  prerollTimeout: 1000,
  requestMode: 'onload',
  serverUrl: 'http://solutions.brightcove.com/bcls/brightcove-player/vmap/simple-vmap',
  timeout: 5000
}</code></pre>
            </section>
            <section id="options" class="bcls-section">
                <h2>Options</h2>
                    <p>The video.js IMA3 plugin is built on top of the <a href="https://github.com/brightcove/videojs-ads">video.js ads framework</a> and accepts any options
                        that the ad framework provides. Take a look at the ad framework <a href="https://github.com/brightcove/videojs-ads/blob/master/README.md">README</a> for
                        details on the current set of overrideable settings. Both the IMA plugin specific options and ad framework options are documented here.</p>

                    <h3>adControlBar</h3>
                    <p>Type: <code>object</code> Default Value: Identical to the player control bar options</p>
              <p>When using the Flash ad tech, a separate set of controls are created to manage interaction with the ad SWF. When those controls are created,
                      these options will be used during their initialization. If no value is specified, the configuration settings for the regular control bar
                      will be used.</p>

                    <h3>adSwf</h3>
                    <p>Type: <code>string</code> Default Value: <code>videojs.ima3.swf</code></p>
              <p>The path to the videojs IMA3 swf. A debugging option for development.</p>
              <p>This option is part of the ad framework is configured as follows:</p>
<pre class="line-numbers"><code class="language-javascript">player.ima3({
  adSwf: 'http://example.com/custom.swf'
});</code></pre>

                    <h3>adTechOrder</h3>
                    <p>Type: <code>array</code> Default Value: [ &#39;flash&#39;, &#39;html5&#39;]</p>
              <p>The ad integration technologies to attempt to use, in order of descending precedence. videojs-ima3 will test each ad tech in order on initialization
                      and use the first supported one for the lifetime of the player. </p>

                    <h3>clickTrackingElement</h3>
              <p>Type: <code>HTMLElement</code> Default Value: undefined</p>
                    <p>If the HTML ad tech is being used in <a href="//developers.google.com/interactive-media-ads/docs/sdks/html5/v3/guides/custom_playback">custom ad playback</a> mode, this specifies an alternative HTML element to be used to track advertisement taps on devices that don't support input events over the video element. More details are available in the parameter documentation for the <a href="//developers.google.com/interactive-media-ads/docs/sdks/html5/v3/apis#ima.AdDisplayContainer">IMA AdDisplayContainer</a>. If you provide a click tracking element, it is your responsibility to show and hide it at the appropriate times on the appropriate platforms. In most cases, it's best to leave this setting undefined and allow the the plugin and IMA to manage ad interaction.</p>

                    <h3>debug</h3>
                    <p>Type: <code>boolean</code> Default Value: <code>false</code></p>
                    <p>If debug is set to true, the ads framework will output additional information about its current state during playback. This can be handy for diagnosing issues or unexpected behavior in an ad integration.</p>
                    <p>This option is part of the ad framework and is configured as follows:</p>
                    <pre class="line-numbers"><code class="language-javascript">player.ima3({
  debug: true
});</code></pre>

                  <h3>hardTimeouts</h3>
                  <p>Type: <code>boolean</code> Default Value: <code>false</code></p>
                  <p>Abandon ads that finish loading after they have timed out. This will prevent slow preroll ads from interrupting after the content video has begun playing. Either the <code>prerollTimeout</code>, <code>postrollTimeout</code> or <code>timeout</code> value for the timeout will be used, depending on the type of ad trying to be played.</p>
                  <p>This option is part of the ad framework and is configured as follows:</p>
                  <pre class="line-numbers"><code class="language-javascript">player.ima3({
  hardTimeouts: true
});</code></pre>
                    <h3>ima3SdkSettings</h3>
                    <p>Type: <code>object</code> Default Value: undefined</p>
                    <p>If provided, the properties of this object are used to set the page-level <a href="https://developers.google.com/interactive-media-ads/docs/sdks/html5/v3/apis#ima.ImaSdkSettings">Ima3SdkSettings</a> when
                        the IMA SDK has finished loading. The properties of this object are expected to be the camel-cased equivalent of setter methods on the <a href="https://developers.google.com/interactive-media-ads/docs/sdks/html5/v3/apis#ima.ImaSdkSettings">SDK</a>  settings object, minus the &#39;set&#39; prefix. For example, if you provided this object when initializing the plugin:</p>
<pre class="line-numbers"><code class="language-javascript">player.ima3({
  ima3SdkSettings: {
    &#39;numRedirects&#39;: 3,
    &#39;ppid&#39;: &#39;publisher-id&#39;
  }
}
</code></pre>
                    <aside class="bcls-aside bcls-aside--warning">Note: When using the Flash playback technology, the <code>numRedirects</code> value is not settable, and defaults to Google's default value of 4 permissible redirects.</aside>
                    <p>Then the video.js IMA plugin would run code that looks something like this when IMA had loaded:</p>
<pre class="line-numbers"><code class="language-javascript">window.google.ima.ImaSdkSettings.setNumRedirects(3);
window.google.ima.ImaSdkSettings.setPpid(&#39;publisher-id&#39;);
</code></pre>

                    <h3>loadingSpinner</h3>
                    <p>Type: <code>boolean</code> Default Value: <code>false</code></p>
                    <p>When set to true, the <code>vjs-loading-spinner</code> is displayed while an ad loads.</p>
                    <p>This option is part of the ad framework and is configured as follows:</p>
                    <pre class="line-numbers"><code class="language-javascript">player.ima3({
  loadingSpinner: true
});</code></pre>

                    <h3>postrollTimeout</h3>
                    <p>Type: <code>number</code> Default Value: <code>100</code> milliseconds</p>
                    <p>The maximum amount of time to wait for an ad implementation to initiate a postroll, in milliseconds. If <code>contentended</code> has been fired and the ad implementation does not call <code>startLinearAdMode()</code> before <code>postrollTimeout</code> expires, the content video will end playback.</p>
                    <p>This option is part of the ad framework and is configured as follows:</p>
                    <pre class="line-numbers"><code class="language-javascript">player.ima3({
  postrollTimeout: 1000
});</code></pre>
                    <p>Once the ad dispatches the <code>contentended</code> event one of these things will happen:</p>
              <ul>
                      <li><code>startLinearAdMode()</code> is called within the timeout: Postroll(s) will play without the user seeing any content video first.</li>
                      <li><code>skipLinearAdMode()</code> is called within the timeout: Content video stops.</li>
                      <li><code>startLinearAdMode()</code> is never called: Content video stops.</li>
                      <li><code>startLinearAdMode()</code> is called, but after the postrollTimeout expired: Content video stops.</li>
                    </ul>
              <p>The <code>postrolltimeout</code> should be as short as possible so that the viewer does not have to wait unnecessarily if no postroll is scheduled for a video. Make this longer if your ad integration needs a long time to decide whether it has postroll inventory to play or not. Ideally, your ad integration should already know if it wants to play a postroll before the <code>contentended</code> event.
              </p>


                    <h3>prerollTimeout</h3>
                    <p>Type: <code>number</code> Default Value: <code>1000</code> milliseconds</p>
                    <p>The maximum amount of time to wait for an ad implementation to initiate a preroll, in milliseconds. If <code>readyforpreroll</code> has been fired and the ad implementation does not call <code>startLinearAdMode()</code> before <code>prerollTimeout</code> expires, the content video will begin playback. The <code>prerollTimeout</code> option is cumulative with the standard timeout parameter.</p>
                    <p>This option is part of the ad framework and is configured as follows:</p>
                    <pre class="line-numbers"><code class="language-javascript">player.ima3({
  prerollTimeout: 1000
});</code></pre>
                    <p>Once the ad dispatches the <code>readyforpreroll</code> event one of these things will happen:</p>
              <ul>
                      <li><code>startLinearAdMode()</code> is called within the timeout: Preroll(s) will play without the user seeing any content video first.</li>
                      <li><code>startLinearAdMode()</code> is never called: Content video plays without preroll(s).</li>
                      <li><code>startLinearAdMode()</code> is called, but after the prerollTimeout expired: Bad user experience; content video plays a bit, then preroll(s) cut in.</li>
                    </ul>
              <p>The <code>prerolltimeout</code> should be as short as possible so that the viewer does not have to wait unnecessarily if no preroll is scheduled for a video. Make this longer if your ad integration needs a long time to decide whether it has preroll inventory to play or not. Ideally, your ad integration should already know if it wants to play a preroll before the <code>readyforpreroll</code> event.
              </p>

              <h3 id="requestMode">requestMode</h3>
                    <p>Type: <code>string</code> Default Value: <code>onload</code></p>
                    <p>There are four possible values for this option:</p>
                    <ul>
                      <li><code>onload</code>: Ads are requested immediately when the player loads. This is normally the best experience for DFP / VPAID.</li>
                      <li><code>onplay</code>: The first ad request is delayed until playback is initiated. This is important for ad networks which consider ad requests made without corresponding ad plays, which can  happen on a poorly performing site. This will cause ads trafficked to eventually drop, or the customer will receive less for the ads shown.</li>
                      <li><code>ondemand</code>: Ads will only play when initiated using the <code>player.ima3.adrequest()</code> method manually</li>
                      <li>
                        <code>oncue</code>: Ads are requested based on ID3 cue points in a live stream. For this type of request to function correctly, the ID3 TXXX frame received must contain JSON data with the following fields:
                          <ul>
                            <li><code>name</code>: Required; must be the string value <code>adCue</code></li>
                            <li><code>id</code>: Required; A unique value to identify the ad given that times are relative in live streams</li>
                            <li><code>serverUrl</code>: Optional; Appended as a breaklength parameter to the server url</li>
                            <li><code>duration</code>: Optional; ad duration</li>
                          </ul>
                          <p>Example: <code>{"name": "adCue", "id": 123}</code></p>
                        <p>You can also cancel an <code>oncue</code> ad using the following format for the object sent: <code>{"name": "adCancel"}</code></p>
                      </li>
                    </ul>
                    <aside class="bcls-aside bcls-aside--information">Note: All <code>requestMode</code> values make <code>ondemand</code> requests immediately.</aside>
                    <p>This option is part of the ad framework is configured as follows:</p>
<pre class="line-numbers"><code class="language-javascript">player.ima3({
  requestMode: 'onplay'
});</code></pre>

              <h3>serverUrl</h3>
                    <p>Type: <code>string</code> Default Value: <code>undefined</code></p>
                    <p>This is the only option that is <strong>required</strong>. Here, you will provide the URL to your ad server. Remember, you can <a href="#testadserver">test the ad tag</a> on your server before trying to use it in the plugin.</p>
  <p>This option is part of the <code>ima3</code> plugin and can be configured in Brightcove Studio as shown <a href="#playersmodule">above</a>, or in the embed-in-page code as follows:</p>
                    <pre class="line-numbers"><code class="language-javascript">player.ima3({
  serverUrl: 'your ad server'
});</code></pre>
<h3>timeout</h3>
      <p>Type: <code>number</code> Default Value: <code>5000</code></p>
      <p>The maximum amount of time to wait, in milliseconds, for an ad implementation to initialize before playback. If the viewer has requested playback and the ad implementation does not dispatch the <code>adsready</code> event before this timeout expires the content video will begin playback. It's still possible for an ad implementation to play ads after this waiting period has finished, but video playback will already be in progress.</p>
      <p>This option is part of the ad framework is configured as follows:</p>
<pre class="line-numbers"><code class="language-javascript">player.ima3({
  timeout: 5000
});</code></pre>
      <p>Once the ad plugin starts waiting for the <code>adsready</code> event, one of these things will happen:</p>
      <ul>
          <li>Integration ready within the timeout: This is the best case, preroll(s) will play without the user seeing any content video first.</li>
          <li>Integration ready, but after timeout has expired: Preroll(s) still play, but the user will see a bit of content video.</li>
          <li>Integration never becomes ready: Content video starts playing after timeout.</li>
      </ul>
      <p>This timeout is necessary to ensure a good viewer experience in cases where the ad implementation suffers an unexpected or irreparable error and never fires an <code>adsready</code> event. Without this timeout, the ads plugin would wait forever, and neither the content video nor ads would ever play.</p>
      <p>If the ad implementation takes a long time to initialize and this timeout is too short, then the content video will begin playing before the first preroll opportunity. This has the jarring effect that the viewer would see a little content before the preroll cuts in.</p>
      <p>In internal Brightcove testing it was found that five seconds seemed to be long enough to accommodate slow initialization in most cases, but still short enough that failures to initialize didn't look like failures of the player or content video.            </p>

                  <h3 id="vpaidMode">vpaidMode</h3>
                  <p>Type: <code>string</code> Default Value: <code>ENABLED</code></p>
                  <p>Specify VPAID 2 mode in the IMA HTML5 SDK.</p>
                  <p>There are three possible values for this option:</p>
                  <ul>
                    <li><code>ENABLED</code>: Play VPAID ads in an iframe with a different domain.</li>
                    <li><code>INSECURE</code>: Play VPAID ads in an iframe with the same domain.</li>
                    <li><code>DISABLED</code>:  VPAID ads throw an error.</li>
                  </ul>
                  <p>This option is part of the ad framework is configured as follows:</p>
            <pre class="line-numbers"><code class="language-javascript">player.ima3({
  vpaidMode: 'DISABLED'
});</code></pre>
                  <aside class="bcls-aside bcls-aside--information">Note: This will only take effect with the HTML5 ad tech. Flash ads are not affected.</aside>

                </section>
                <section id="adMacros" class="bcls-section">
                    <h2>Ad macros and the serverURL</h2>
                    <p>There are ad macros available to make your job easier when creating the ad server URL. These macros enable you to use variables in the server URL for which the IMA3 plugin will substitute appropriate values. For instance, the following server URL contains some of the variables: </p>
                    <pre class="line-numbers"><code class="language-json">{"serverUrl": "http://myadserver.com/ad/?video={mediainfo.id}&duration={player.duration}"}</code></pre>
                    <p>The IMA3 plugins would substitute in the appropriate values, and the server URL actually used would appear as follows:</p>
                    <pre class="line-numbers"><code class="language-json">{"serverUrl": "http://myadserver.com/ad/?video=12340001&duration=60"}</code></pre>
                    <p>The following is the complete list of variable for which substituted values will be used:</p>
                    <table class="table-styles">
                      <thead>
                        <tr>
                          <th style="width:30%">Macro</th>
                          <th style="width:60%">Description</th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr>
                          <td>{player.id}</td>
                          <td>Player ID</td>
                        </tr>
                        <tr>
                          <td>{mediainfo.id}</td>
                          <td>Video ID</td>
                        </tr>
                        <tr>
                          <td>{mediainfo.name}</td>
                          <td>Video title</td>
                        </tr>
                        <tr>
                          <td>{mediainfo.description}</td>
                          <td>Short description (250 chars max)</td>
                        </tr>
                        <tr>
                          <td>{mediainfo.tags}</td>
                          <td>Tags (metadata) associated with the video</td>
                        </tr>
                        <tr>
                          <td>{mediainfo.reference_id}</td>
                          <td>Reference ID</td>
                        </tr>
                        <tr>
                          <td>{mediainfo.duration}</td>
                          <td>Duration of the video as reported by Video Cloud</td>
                        </tr>
                        <tr>
                          <td>{mediainfo.ad_keys}</td>
                          <td>Free form text string that can be added and edited in the Media module of Studio; you should use the query parameter in the form
                            <pre class="line-numbers"><code class="language-javascript">cust_params={mediainfo.ad_keys}</code></pre>
                          </td>
                        </tr>
                        <tr>
                          <td>{player.duration}</td>
                          <td>Duration of video as measured by player (possibly slightly different from <code>mediainfo.duration</code> and probably more accurate)</td>
                        </tr>
                        <tr>
                          <td>{document.referrer}</td>
                          <td>Referring page URL</td>
                        </tr>
                        <tr>
                          <td>{window.location.href}</td>
                          <td>Current page URL</td>
                        </tr>
                        <tr>
                          <td>{player.url}</td>
                          <td>URL of the player</td>
                        </tr>
                        <tr>
                          <td>{timestamp}</td>
                          <td>Current local time in milliseconds since 1/1/70</td>
                        </tr>
                      </tbody>
                    </table>
            </section>
          <section id="methods" class="bcls-section">
            <h2>Methods</h2>
            <h3>player.ima3.adrequest( )</h3>
            <p>Calling this method will create an on-demand adrequest immediately upon receiving an ad response. Invoking this method creates a new IMA adManager which means that any previous ad response information (for instance, a postroll ad returned in a previous VAST response) will be lost. Brightcove recommends that you only use this method in cases where up-front knowledge of ad timings isn't known or you will be making all ad calls on-demand. In all other cases, it makes sense to put all ad data in the initial VAST call on plugin initialization.</p>
            <h5>Parameters</h5>
            <ul>
                <li><strong>adRequestUrl</strong> <code>String</code> Path to a VAST ad tag. You can and should pass relative URLs.</li>
            </ul>
            <h5>Returns:</h5>
            <ul>
            <li>Nothing</li>
            </ul>
            <p>Example</p>
            <pre class="line-numbers"><code class="language-javascript">player.ima3.adrequest('http://pubads.g.doubleclick.net/gampad/ads?sz=640x360&iu=/6062/iab_vast_samples/skippable&ciu_szs=300x250,728x90&impl=s&gdfp_req=1&env=vp&output=xml_vast2&unviewed_position_start=1&url=[referrer_url]&correlator=[timestamp]');</code></pre>

            <h3>player.ima3.ready()</h3>
            <p>Similar to the <code>vjs.ready()</code> method, any callbacks passed into this method will only be invoked when the ima3 plugin is ready. Since the loading of the ima3 swf can take some time, it is sometimes desirable to use this function to delay calling your methods until the swf is ready to handle them. For example, you use this method to delay and calls to <code>player.ima3.adrequest()</code> that might be made before the the player can handle them.</p>
            <h5>Parameters</h5>
            <ul>
                <li><strong>callback</strong> <code>function</code></li>
            </ul>
            <h5>Returns:</h5>
            <ul>
            <li>Nothing</li>
            </ul>
          </section>
          <section id="runtimesettings" class="bcls-section">
              <h2>Runtime settings</h2>
              <p>The following methods are available for both the HTML5 and Flash ad playback technologies. Only a few of the most used methods from the adsManager are displayed below. See Google's <a href="https://developers.google.com/interactive-media-ads/docs/sdks/html5/v3/apis#ima.AdsManager"> Interface google.ima.AdsManager</a> documentation for all available functionality.</p>
              <h3>AdsManager.destroy</h3>
              <p>Type: <code>google.ima.AdsManager.destroy</code></p>
              <p>Usage: <code>myPlayer.ima3.adsManager.destroy()</code></p>
              <p>Calling this method destroys the current ads manager. For more information see Google's <a href="//developers.google.com/interactive-media-ads/docs/sdks/html5/v3/apis#ima.AdsManager.destroy">document</a> on the method.</p>
              <h3>AdsManager.getRemainingTime</h3>
              <p>Type: <code>google.ima.AdsManager.getRemainingTime</code></p>
              <p>Usage: <code>myPlayer.ima3.adsManager.getRemainingTime()</code></p>
              <p>Calling this method returns the amount of time remaining for the current ad. If an ad isn't available or has finished playing, it returns -1. For more information see Google's <a href="//developers.google.com/interactive-media-ads/docs/sdks/html5/v3/apis#ima.AdsManager.getRemainingTime">document</a> on the method.</p>
              <h3>ImaSdkSettings.setAutoPlayAdBreaks</h3>
              <p>Type: <code>google.ima.ImaSdkSettings.setAutoPlayAdBreaks</code></p>
              <p>This method takes a boolean representing whether VMAP and ad rules are automatically played. For more information see Google's <a href="//developers.google.com/interactive-media-ads/docs/sdks/html5/v3/apis#ima.ImaSdkSettings.setAutoPlayAdBreaks">document</a> on the method.</p>
              <h3 id="AdsManager.stop">AdsManager.stop</h3>
              <p>Type: <code>google.ima.AdsManager.stop</code></p>
              <p>Usage: <code>myPlayer.ima3.adsManager.stop()</code></p>
              <p>Calling this method stops playing the current ad. Calling this will get publisher back to the content. This can be helpful when, for instance, calling for a new video with the Catalog and want it to begin playing before an ad finishes. For more information see Google's <a href="//developers.google.com/interactive-media-ads/docs/sdks/html5/v3/apis#ima.AdsManager.stop">document</a> on the method.</p>
            </section>
          <section id="html5settings" class="bcls-section">
            <h2>HTML5 settings</h2>
            <p>If the HTML5 ad tech is in use, a number of IMA settings are available on the plugin object at runtime. For instance, to determine the ad ID you you would use:</p>
<pre class="line-numbers"><code class="language-javascript">var adId = player.ima3.currentAd.getAdId();</code></pre>
            <p>Be careful interacting directly with these properties. Calling the wrong method can lead to unexpected results and failure of advertisements to play properly.</p>
            <h3>adsLoader</h3>
            <p>Type: <code>google.ima.AdsLoader</code></p>
            <p>The object used to create ads requests. See ima.AdsLoader. The Ads Loader may not be available until adsready has been fired by the plugin.</p>
            <h3>adsManager</h3>
            <p>Type: <code>google.ima.AdsManager</code></p>
            <p>The object responsible for playing ads. See ima.AdsManager. The Ads Manager is not available until adsready has been fired by the plugin.</p>
            <h3>adDisplayContainer</h3>
            <p>Type: <code>google.ima.AdDisplayContainer</code></p>
            <p>The object responsible for managing the display elements for ads. See ima.AdDisplayContainer. The Ads Display container may not be available until adsready has been fired by the plugin.            </p>
            <h3>currentAd</h3>
            <p>Type: <code>google.ima.Ad</code></p>
            <p>When an ad is playing, an object that encapsulates information about the current ad. See ima.Ad.          </p>
          </section>

            <section id="events" class="bcls-section">
                <h2>Events</h2>
                    <p>The plugin emits some custom event types during loading, initialization, and playback. You can listen for IMA3 and ad framework events just like you would any other event:</p>
<pre class="line-numbers"><code class="language-javascript">player.on(&#39;ima3error&#39;, function(event) {
  console.log(&#39;event&#39;, event);
});
</code></pre>
                <table class="table-styles">
                  <thead>
                    <tr>
                      <th style="width:35%">Event</th>
                      <th style="width:65%">Dispatched when:</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td>ima3-ready</td>
                      <td>The ima3 plugin code has loaded and is ready load the IMA SDK.</td>
                    </tr>
                    <tr>
                      <td>ima3error</td>
                      <td>There was an error loading the IMA3 SDK from Google. If it occurs, no ads will be displayed.</td>
                    </tr>
                    <tr>
                      <td>ima3-ad-error</td>
                      <td>An error has occurred in the IMA3 SDK. You should verify your ad configuration and settings to be sure your DoubleClick account is correctly configured. You can find common troubleshooting tasks at the <a href="https://support.google.com/dfp_premium/">DoubleClick support site</a> or talk to your DoubleClick account representative. Note that this event is only dispatched for the HTML5 tech (playback technology), NOT the Flash tech.</td>
                    </tr>
                    <tr>
                      <td>ads-request</td>
                      <td>Upon request ad data.</td>
                    </tr>
                    <tr>
                      <td>ads-load</td>
                      <td>When ad data is available following an ad request.</td>
                    </tr>
                    <tr>
                      <td>ads-ad-started</td>
                      <td>An ad has started playing.</td>
                    </tr>
                    <tr>
                      <td>ads-ad-ended</td>
                      <td>An ad has finished playing.</td>
                    </tr>
                    <tr>
                      <td>ads-pause</td>
                      <td>An ad is paused.</td>
                    </tr>
                    <tr>
                      <td>ads-play</td>
                      <td>An ad is resumed from a pause.</td>
                    </tr>
                    <tr>
                      <td>ads-first-quartile</td>
                      <td>The ad has played 25% of its total duration.</td>
                    </tr>
                    <tr>
                      <td>ads-midpoint</td>
                      <td>The ad has played 50% of its total duration.</td>
                    </tr>
                    <tr>
                      <td>ads-third-quartile</td>
                      <td>The ad has played 75% of its total duration.</td>
                    </tr>
                    <tr>
                      <td>ads-click</td>
                      <td>A viewer clicked on the playing ad.</td>
                    </tr>
                    <tr>
                      <td>ads-volumechange</td>
                      <td>The volume of the playing ad has been changed.</td>
                    </tr>
                    <tr>
                      <td>ads-pod-started</td>
                      <td>The first ad in a linear ad pod (a sequenced group of ads) has started.</td>
                    </tr>
                    <tr>
                      <td>ads-pod-ended</td>
                      <td>The last ad in a linear ad pod (a sequenced group of ads) has finished.</td>
                    </tr>
                    <tr>
                      <td>ads-allpods-completed</td>
                      <td>All linear ads have finished playing.</td>
                    </tr>
                  </tbody>
                </table>
            </section>
          <section id="playbackmodes" class="bcls-section">
            <h2>Playback modes</h2>
            <p>The IMA3 HTML5 SDK has two separate modes of operation: standard and custom playback mode. In standard mode, IMA3 will create a video element inside of the AdDisplayContainer iframe to play linear ads. Custom playback mode shares the video element with the content player and is intended for mobile devices that do not support multiple simultaneous video elements well. The videojs-ima3 plugin chooses which HTML5 playback mode to use by querying the content player's techOrder property and determining if any of the other content techs are supported. If multiple techs are supported, sharing the content video element isn't safe because it would be disposed if the current tech is unloaded. In practice, this means desktop machines with Flash installed will operate in standard playback mode and mobile devices without Flash will use custom playback mode.</p>
          </section>
          <section id="issues" class="bcls-section">
            <h2>Known issues</h2>
            <h3>Content playing before pre-roll</h3>
            <p>It was possible for the following issues to occur when using the IMA3 plugin with Brightcove Player:</p>
            <ul>
              <li>One to two seconds of video would play, then be interrupted by the pre-roll ad.</li>
              <li>When using video autoplay, the poster image would be displayed before the pre-roll ad.</li>
            </ul>
            <p>If you are still experiencing either of these issues, a possible quick fix is to use Studio to simply reset the IMA3 plugin. You do this by disabling IMA ads, then re-enabling using your ad tag Server URL (see following screenshot). The settings will automatically update to the latest recommendations when doing this. Of course, you will need to re-publish your player after making this configuration change.</p>
            <figure class="bcls-figure">
                <img class="bcls-image" src="//learning-services-media.brightcove.com/doc-assets/player-development/advertising/ima3-plugin/known-issue-reset-ima.png" alt="resetting IMA3 ads">
            </figure>
            <p>The reason these issues arose is:</p>
            <ul>
              <li><strong>Pre-roll timeout was too low</strong>: It can take several seconds to run client-side VPAID scripts, run real-time bidding auctions, and transmit the appropriate ad back to the player.</li>
              <li><strong>Soft timeout behavior</strong>: After the old default pre-roll timeout value of one second passes, Brightcove Player begins playing video, but when the pre-roll becomes available after one second it interrupts the video and starts to play the pre-roll ad.</li>
              <li><strong>Bug caused timeouts to malfunction</strong>: When a second video is loaded, a bug occurred that didn’t wait for the pre-roll timeout period before starting the video.</li>
              <li><strong>iOS web doesn’t pause immediately</strong>: Even though Brightcove Player is paused immediately after the video is loaded, and before playback starts, iOS can sometimes still show a few frames of the video.</li>
            </ul>
            <p>The issues have been resolved by:</p>
            <ul>
              <li><strong>Increase default timeout value</strong>: The defaults have been updated to make the default pre-roll timeout 4 seconds (4000 ms). Of course, you can reduce this value if best for your environment.</li>
              <li><strong>Change to hard timeouts</strong>: Instead of allowing late ads to interrupt, pre-roll ads are now abandoned if they do not load in given pre-roll timeout value. This is the default when using Studio to create a player, but if using the API you will need to set the <code>hardTimeouts</code> value to true.</li>
              <li><strong>Fixed out-of-order events bug</strong>: This fixed the second video load issue.</li>
              <li>The bug fix for the iOS issue will be released in August.</li>
            </ul>

            <!-- <p>It is possible to see some video content play before the pre-roll, or a "flash" of the content. You can correct this issue by using the following CSS:</p>
            <pre class="line-numbers"><code class="language-css">.vjs-ima3-flash.vjs-ad-loading .vjs-tech,
.vjs-ima3-html5.vjs-ad-loading .vjs-poster,
.vjs-ima3-html5.vjs-ad-loading .vjs-tech {
  opacity: 0;
 }</code></pre> -->
                    <h3>Supported environments</h3>
                    <p>To check for supported combinations of platforms, advertising standards and video media, see Google's <a href="https://developers.google.com/interactive-media-ads/video_features_and_sdk_versions">Video Feature and SDK compatibility</a> document. That document and the <a href="https://developers.google.com/interactive-media-ads/docs/vastinspector_dual">Video Suite Inspector</a> will help you diagnose attempted IMA3 advertisement configurations that simply will not function.</p>
                    <aside class="bcls-aside bcls-aside--information">Note: To use the Video Suite Inspector you will need your VAST ad tag or VAST ad response. You can then paste it into the given text field and then click the <strong>Test Ad</strong> button.</aside>
                    <h3>Resizing the Player During Ad or Video Playback</h3>
                  <p>If the player is resized during ad or video playback, ad content will not resize unless the player's dimensions function is called to resize the player. Resizing the player using other methods (style width and height, for example) will not resize the ad.</p>
                    <h3>Click Handling</h3>
                    <p>The IMA3 ad display is overlaid on top of the video player during playback. By default, that would prevent click or touch events from reaching
                        the player. This is not normally desirable so the default CSS only allows pointer events to reach the IMA SDK when at least one of the following
                    conditions is true:</p>
                    <ul>
                      <li>When the flash ad tech is active and an ad is playing</li>
                      <li>When the user&#39;s browser does not support touch events, the HTML ad tech is active and an ad is playing</li>
                      <li>When the the user&#39;s browser supports touch event, player controls are visible and an ad is playing</li>
                    </ul>
                    <h3>Exceptions Generated by Overlay Ads</h3>
                    <p>On Chrome 30, an exception is thrown from the IMA bridge when &quot;fading out&quot; an overlay ad:</p>
<pre class="line-numbers"><code class="language-html">Uncaught NotFoundError: An attempt was made to reference a Node in a context where it does not exist. bridge3.1.33.html:46
ae bridge3.1.33.html:46
Pi.I bridge3.1.33.html:121
(anonymous function) bridge3.1.33.html:93
</code></pre>
                    <p>This issue is evident in the <a href="https://developers.google.com/interactive-media-ads/docs/vastinspector_dual">IMA VAST inspector</a> as well.</p>
                    <h3>Overlays and Fullscreen Transitions</h3>
                    <p>video.js uses the <a href="http://www.w3.org/TR/fullscreen/">fullscreen API</a> where available. Different browsers implement the transition to
                        fullscreen differently and that can produce discrepancies in appearance when transitioning into and out of fullscreen mode. In most implementations,
                        the element that is being taken into fullscreen is geometrically scaled (i.e. zoomed) from its original to the target size. Most overlay
                        advertisements are designed to be displayed at a fixed size, however, and so they may appear distorted until the animation completes.</p>
                    <h3>Midrolls and live streams</h3>
                    <p>Midrolls play immediately if they are configured for live streams.</p>
                    <h3>Control bars</h3>
                    <p>You will see that the advertisement and video that plays after advertisement completion can have different control bars. IMA creates a separate video element under most circumstances and exposes information about the ad playback state through non-standard methods. The control bar in the Brightcove Player is associated with different playback technology, and it is non-trivial to have the same control bar for both technologies.</p>
                    <h3>Skippable ads on iPhones</h3>
                    <p>Skippable ads are not supported by IMA3 on iPhones and such ads will not be shown at all.</p>
                    <h3>Conflict with gpt_proxy.js</h3>
                    <p>If using the GPT proxy script with IMA3, and the <strong>adTechOder</strong> is <strong>HTML5</strong> first, playback issues can occur. The IMA3 plugin will be affected when using any script that uses <strong>window.google</strong> or <strong>window.google.ima</strong>. It is suggested that you check if you're using Brightcove Player, and if so, don't load the proxy on those occasions.</p>
            </section>
            <section id="contribads" class="bcls-section">
              <h2>Player Ad Libraries</h2>
              <p>The <a href="https://github.com/videojs/videojs-contrib-ads">videojs/videojs-contrib-ads</a> GitHub repository contains a plugin which provides common functionality needed by video advertisement libraries working with Brightcove Player. The plugin provides common functionality needed by video ad integrations and takes care of a number of concerns for ad integrators, reducing the code you have to write for your ad integration.</p>
              <p>For instance, the functionality in <a href="https://github.com/videojs/videojs-contrib-ads">videojs/videojs-contrib-ads</a> allows you to check the current <strong>state</strong> property on a player to determine whether an ad is playing or not. States change frequently during the pre-roll "handshake"  but are otherwise usually one of <code>content-playback</code> or <code>ad-playback</code>, defined by:</p>
              <ul>
                  <li><code>player.ads.state === 'ad-playback'</code> (this is the state when <code>adstart</code> is called)</li>
                  <li><code>player.ads.state === 'content-playback'</code> (this is the state when <code>adend</code> is called)</li>
              </ul>
              <p>The readme for the repository contains a state diagram on the README which covers the details of the pre-roll states.</p>
              <p>See the <a href="contrib-ads-migration-guide.html">Migration Guide</a> for information on the latest version of videojs-contrib-ads.</p>
            </section>
            <section id="adnetworkflow" class="bcls-section">
              <h2>Ad network flow</h2>
              <p>For those wishing to see a bit more "under the hood", a browser's development tools Network tab can reveal interesting details about the key files being downloaded as part of the ad process.</p>
              <p>In this example using the IMA3 plugin, you first see the the plugin's SWF version being downloaded. Note that the screenshots are from a desktop, so the browser is getting the Flash version of the plugin.</p>
              <figure class="bcls-figure">
                  <img class="bcls-image" src="//learning-services-media.brightcove.com/doc-assets/player-development/advertising/ima3-plugin/ads-learning-guide-network-plugin-swf.png" alt="network flow SWF">
              </figure>
              <p>The next ads related file to download is the VMAP document.</p>
              <figure class="bcls-figure">
                  <img class="bcls-image" src="//learning-services-media.brightcove.com/doc-assets/player-development/advertising/ima3-plugin/ads-learning-guide-network-vmap.png" alt="network flow VMAP">
              </figure>
              <p>Last to load is a VAST document for a particular ad.</p>
              <figure class="bcls-figure">
                  <img class="bcls-image" src="//learning-services-media.brightcove.com/doc-assets/player-development/advertising/ima3-plugin/ads-learning-guide-network-vast.png" alt="nework flow VAST">
              </figure>
            </section>

           <section id="implementcode" class="bcls-section">
             <h2 class="bcls-expander-head">Implement using code</h2>
             <div class="bcls-expander-content">
                  <p>To implement a plugin the player needs to know the location of the plugin code, a stylesheet if needed, the plugin name and plugin configuration options. The location of the plugin code and stylesheet are as follows:</p>
                  <pre class="line-numbers"><code class="language-html">http://players.brightcove.net/videojs-ima3/2/videojs.ima3.min.js</code></pre>
                  <pre class="line-numbers"><code class="language-html">http://players.brightcove.net/videojs-ima3/2/videojs.ima3.min.css</code></pre>
                    <p>The name of the plugin is <code>ima3</code>, and an example set of options is:</p>
                    <pre class="line-numbers"><code class="language-json">{
  "serverUrl": "http://pubads.g.doubleclick.net/gampad/ads?sz=400x300&iu=%2F6062...",
  "timeout": 5000,
  "postrollTimeout": 2000
}</code></pre>
                    <p>The following shows using the In-Page Embed implementation of the player to associate the IMA Plugin with a single instance of a player.</p>
                      <ul>
                          <li>Line 13: Uses a <code>link</code> tag to include the plugin's CSS in the <code>head</code> of the HTML page.</li>
                          <li>Line 17: Gives the <code>video</code> tag an <code>id</code> attribute, with some value, in this case <strong>video_1</strong>.</li>
                          <li>Line 26: Uses a <code>script</code> tag to include the plugin's JavaScript in the <code>body</code> of the HTML page.</li>
                          <li>Line 32: Creates a reference to the player.</li>
                          <li><p>Line 31-36: Initializes the plugin and passes in custom options. Here, we listen for the first <code>loadedmetadata</code> event, which is fired when the player content, including ads, is loaded in the player.</p>
                  <aside class="bcls-aside bcls-aside--tip">Note: While the <code>ready()</code> method is used to indicate that the player is loaded and ready, the <code>loadedmetadata</code> event is used to indicate that the player content, like ads, is ready to interact with. Here, we are also using the <code>one()</code> method so that our function is executed the first time the plugin is loaded and not every time a video is loaded. For details, see the <a href="../../brightcove-player/guides/events.html">Understanding Player Events</a> document.</aside></li>
                      </ul>
                  <pre class="line-numbers"><code class="language-html">&lt;!doctype html&gt;
&lt;html&gt;

&lt;head&gt;
  &lt;meta charset=&quot;UTF-8&quot;&gt;
  &lt;title&gt;IMA3 Plugin Code Example&lt;/title&gt;
  &lt;style&gt;
    .video-js {
      height: 344px;
      width: 610px;
    }
  &lt;/style&gt;
  &lt;link href=&quot;//players.brightcove.net/videojs-ima3/2/videojs.ima3.min.css&quot; rel=&quot;stylesheet&quot;&gt;
&lt;/head&gt;
&lt;body&gt;

  &lt;video  id=&quot;video_1&quot;
    data-video-id=&quot;3851380732001&quot;
    data-account=&quot;1752604059001&quot;
    data-player=&quot;Hy3gDJHu&quot;
    data-embed=&quot;default&quot;
    class=&quot;video-js&quot;
    controls&gt;&lt;/video&gt;
  &lt;script src=&quot;//players.brightcove.net/1752604059001/Hy3gDJHu_default/index.min.js&quot;&gt;&lt;/script&gt;

  &lt;script src=&quot;//players.brightcove.net/videojs-ima3/2/videojs.ima3.min.js&quot;&gt;&lt;/script&gt;

  &lt;script&gt;
    var myPlayer;

    videojs(&quot;video_1&quot;).on('loadedmetadata',function() {
      myPlayer = this;
      myPlayer.ima3({
        serverUrl: &quot;http://solutions.brightcove.com/bcls/brightcove-player/vmap/simple-vmap.xml&quot;
      });
    });
  &lt;/script&gt;
&lt;/body&gt;

&lt;/html&gt;</code></pre>
            </div>
          </section>

          <section id="changelog" class="bcls-section">
            <h2>Changelog</h2>

            <h4>27 Jul 2016</h4>
            <p>v2.11.1</p>
            <ul>
              <li>Updated to videojs-contrib-ads 3.3.10</li>
              <ul><li>Fix a bug in which content would replay after postrolls under certain circumstances</li></ul>
            </ul>

            <h4>22 Jul 2016</h4>
            <p>v2.11.0</p>
            <ul>
              <li>Added player.ima3.adTech</li>
            </ul>

            <h4>18 Jul 2016</h4>
            <p>v2.10.3</p>
            <ul>
              <li>Updated to videojs-contrib-ads 3.3.9</li>
              <ul><li>Fix a bug in which contentupdate is missed in postroll</li></ul>
            </ul>

            <h4>14 Jul 2016</h4>
            <p>v2.10.2</p>
            <ul>
              <li>Fix to account for adrequests made when requestmode is onplay and content is already playing</li>
              <li>Fixed bug where <code>ImaSdkSettings</code> did not reflect locale setting</li>
              <li>Fixed bug where IMA3 Plugin did not respect the <code>setNumRedirects</code> setting</li>
              <li>Updated to videojs-contrib-ads 3.3.9
                <ul>
                  <li>Fix a bug in which contentupdate is missed in postroll</li>
                </ul>
              </li>
            </ul>

            <h4>21 Jun 2016</h4>
            <p>v2.10.1</p>
            <ul>
              <li>Workaround for Chrome bug when removing poster</li>
              <li>Updated to videojs-contrib-ads 3.3.8
                <ul>
                  <li>Fix for issue resuming after ads on Android</li>
                  <li>Fix for issue requesting ads for subsequent videos</li>
                </ul>
              </li>
            </ul>

            <h4>16 Jun 2016</h4>
            <p>v2.10.0</p>
            <ul>
              <li>Hide poster and tech before preroll</li>
            </ul>

            <h4>13 Jun 2016</h4>
            <p>v2.9.1</p>
            <ul>
              <li>Fixed a bug where content would replay after a postroll completed</li>
            </ul>

            <h4>6 Jun 2016</h4>
            <p>v2.9.0</p>
            <ul>
              <li>Hard timeouts now work for VAST ads that do not use VMAP as well as with the Flash ad tech<li>
              <li>Fixed bug that could cause a flash of content on source change</li>
              <li>Fixed bug where first adrequest would fail with requestMode:ondemand + autoplay + preload:none + html5 ad tech</li>
            </ul>

            <h4>26 May 2016</h4>
            <p>v2.8.0</p>
            <ul>
              <li>Add default <code>postrollTimeout</code> of 1000 milliseconds</li>
              <li>Add missing logic for flash ad tech to destroy ads manager on <code>adserror</code></li>
              <li>No longer send nopreroll for vast ads</li>
              <li>No longer send adrequest for empty string content source</li>
              <li>Cancel multiple ad requests for the same content source</li>
              <li>No longer allow autoplay with onplay; it changes it to onload</li>
            </ul>

            <h4>10 May 2016</h4>
            <p>v2.7.1</p>
            <ul>
              <li>Fix to live ads that was introduced in 2.7.0</li>
              <li>Fix in live ads code that introduced intermittant errors on iOS8 (even in non-live scenarios)</li>
            </ul>

            <h4>28 Apr 2016</h4>
            <p>v2.7.0</p>
            <ul>
              <li>Added <code>ad_keys</code> to ad macros</li>
              <li>Code maintenance to enable <code>vjsstandard</code></li>
              <li>No longer plays ads when Economics flag is set to <code>FREE</code></li>
            </ul>

            <h4>20 Apr 2016</h4>
            <p>v2.6.0</p>
            <ul>
              <li>Ability to play and cancel ads in live streams based on ID3 metadata</li>
              <li>Quicker load time when <code>requestmode</code> is set to <code>ondemand</code> or <code>oncue</code></li>
              <li>Fixed and restored <code>nopostroll</code> feature</li>
            </ul>

            <h4>31 Mar 2016</h4>
            <p>v2.5.2</p>
            <ul>
              <li>Rollback nopostroll feature as it was preventing <code>ended</code> events</li>
            </ul>
            <h4>31 Mar 2016</h4>
            <p>v2.5.1</p>
            <ul>
              <li>Minor bugfix to contrib-ads</li>
            </ul>
            <h4 id="toc_3">28 Mar 2016</h4>
            <p>v2.5.0</p>
            <h5 id="toc_4">Features</h5>
            <ul>
              <li>HTML5 <code>hardTimeouts</code> option. Will prevent &quot;flash of content&quot; when using VMAP for HTML5 ads by discarding overdue ads. Disabled by default; planned to be enabled by default in a later major version update.</li>
              <li>Quicker load time when using IMA3 plugin with no preroll ads.</li>
              <li>Expose <code>player.ima3.currentAd.wrapperAdIds</code> and <code>player.ima3.currentAd.wrapperAdSystems</code> when using Flash ad tech.</li>
            </ul>
            <h5 id="toc_5">Bugfixes</h5>
            <ul>
              <li>Fix display of volume slider in graphite skin</li>
              <li>Fix bug where progress slider would continue when paused in Flash</li>
              <li>Fix bug where play/pause icon would not update correctly in Flash</li>
              <li>Fix several situations where invalid <code>adtimeout</code> events would be sent</li>
            </ul>
            <h4 id="toc_6">28 Mar 2016</h4>
            <p>v2.4.0</p>
            <ul>
              <li>Added VPAID 2 support</li>
            </ul>
            <h4 id="toc_7">28 Mar 2016</h4>
            <p>v2.3.0</p>
            <ul>
              <li>Hide dock during ad playback</li>
              <li>Fix bug where iPad overlay ads would not click-through</li>
              <li>Use versioned URL for default <code>adSwf</code> value</li>
              <li>Fix clickthroughs for HTML5 ads in IE10</li>
            </ul>
            <h4 id="toc_9">20 Jan 2016</h4>
            <p>v1.14.x</p>
            <ul>
              <li>Support multiple players</li>
            </ul>
            <h4 id="toc_10">30 Mar 2015</h4>
            <p>z1.13.0</p>
            <ul>
              <li>Update contrib-ads to pick up playlist support</li>
            </ul>
            <h4 id="toc_11">27 Mar 2015</h4>
            <p>v1.12.0</p>
            <ul>
              <li>Add adrequest method</li>
              <li>Add ready method</li>
              <li>Add loadingSpinner option</li>
              <li>Fix timings in HTML controlbar</li>
              <li>Add black background div to prevent content flashing issues with prerolls and midrolls (on desktop)</li>
            </ul>
            <h4 id="toc_12">27 Jan 2015</h4>
            <p>v1.11.0</p>
            <ul>
              <li>Add error handling</li>
              <li>Bump videojs-contrib-ads to 1.0.0</li>
              <li>Fix race condition where contentupdate can trigger twice</li>
            </ul>
            <h4 id="toc_13">8 Jan 2015</h4>
            <p>v1.10.0</p>
            <ul>
              <li>Bump videojs-contrib-ads to 0.6.0</li>
              <li>Add no-op function stubs for text track API methods</li>
            </ul>
            <h4 id="toc_14">21 Oct 2014</h4>
            <p>v1.8.0</p>
            <ul>
              <li>Bump default preroll timeout to 1000ms</li>
              <li>Always use a separate control bar for ad playback. Previously, ads on platforms that did not support Flash would re-use the content control bar for ad playback.</li>
              <li>Move ad container offscreen during content playback because IMA steals touch events on Android Chrome.</li>
            </ul>
            <h4 id="toc_15">16 Oct 2014</h4>
            <p>v1.7.0</p>
            <ul>
              <li>VPAID 2.0 support for the Flash ad tech</li>
            </ul>
            <h4 id="toc_16">1 Oct 2014</h4>
            <p>v1.6.0</p>
            <ul>
              <li>Update videojs-ads</li>
              <li>Pass updated plugin settings to the ad SWF</li>
            </ul>
            <h4 id="toc_17">1 Oct 2014</h4>
            <p>v1.5.0</p>
            <ul>
              <li>Set the default ad tech order to flash, html5</li>
            </ul>
            <h4 id="toc_18">28 Aug 2014</h4>
            <p>v1.4.0</p>
            <ul>
              <li>Post-roll support</li>
              <li>Added the ability to use custom click tracking elements with IMA3/HTML5</li>
            </ul>
            <h4 id="toc_19">20 Mar 2014</h4>
            <p>v1.3.0</p>
            <ul>
              <li>Upgrade to video.js 4.4.3</li>
            </ul>
          </section>

</article>
        <!-- end drupal content -->
            <div class="bcls-section" id="BCLreferences">
                <h2>Related Topics</h2>
                <ul>
                    <!-- <li><a href="//docs.brightcove.com/en/video-cloud/brightcove-player/guides/bc-analytics-plugin.html">New Player Plugin: Analytics</a> -->
                    <li><a href="../../brightcove-player/guides/ad-events.html">Ad Events and Ad Objects</a>
                    </li>
                    <li><a href="hls-plugin.html">Brightcove Player Plugin: HLS</a>
                    </li>
                    <li><a href="plugin-dev-quick-start.html">Quick Start to Plugin Development</a>
                    </li>
                    <li><a href="../../player-management/getting-started/player-mgmt-quick-start.html">Quick Start to Player Management</a>
                    </li>
                </ul>
            </div>
        </div>
      </div>

      <!-- bcl scripts -->
      <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.2.3/jquery.min.js"></script>
      <script src="//cdnjs.cloudflare.com/ajax/libs/gist-embed/2.4/gist-embed.min.js"></script>
      <script src="//cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>
      <script src="//cdnjs.cloudflare.com/ajax/libs/fastclick/1.0.6/fastclick.min.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/foundation/5.5.3/js/foundation.min.js"></script>
      <script src="//cdnjs.cloudflare.com/ajax/libs/handlebars.js/4.0.5/handlebars.min.js"></script>
      <script src="/en/scripts/docs-nav-data.min.js"></script>
      <script src="/en/scripts/bcls-doc-site-v2.js"></script>
      <script src="//learning-services-media.brightcove.com/doc-assets/js/bcls-utils.js"></script>
      <script src="//learning-services-media.brightcove.com/doc-assets/js/prism/prism.js"></script>
      <script>
          $(document).foundation();
      </script>

    <div style="text-align:center">
    <iframe id="CSAT" src="//learning-services-media.brightcove.com/doc-assets/general/surveylink.html" style=" padding-bottom:20px;border:none"></iframe>
</div>
<br><br>
<div class="footer text-center"><a id="feedbackMail" href="mailto:docs@brightcove.com">Questions or comments?</a></div>
<script>
var feedbackMail = document.getElementById("feedbackMail");
feedbackMail.setAttribute("href", "mailto:docs@brightcove.com?subject=question regarding " + encodeURI(document.location.href));
</script>
</body>

</html>
