<!DOCTYPE html>
<html lang="en">

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta name="viewport" content="initial-scale=1.0, maximum-scale=1.0, user-scalable=no, width=device-width" />
  <!-- change title to match the h1 heading -->
  <title>OnceUX Plugin</title>
  <link rel="stylesheet" type="text/css" href="//cdnjs.cloudflare.com/ajax/libs/foundation/5.5.0/css/foundation.min.css" />
  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/foundation/5.5.0/css/normalize.css" />
  <script src="//use.edgefonts.net/source-code-pro.js"></script>
  <link href="//files.brightcove.com/proxima-nova/font-faces.css" rel="stylesheet" type="text/css">
  <link rel="stylesheet" type="text/css" href="/en/styles/bcls-doc-site.css">
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.4/styles/github.min.css">
  <script>
    (function (i, s, o, g, r, a, m) {
      i['GoogleAnalyticsObject'] = r;
      i[r] = i[r] || function () {
        (i[r].q = i[r].q || []).push(arguments)
      }, i[r].l = 1 * new Date();
      a = s.createElement(o),
      m = s.getElementsByTagName(o)[0];
      a.async = 1;
      a.src = g;
      m.parentNode.insertBefore(a, m)
    })(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga');
    ga('create', 'UA-2728311-29', 'auto');
    ga('send', 'pageview');
  </script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/foundation/5.5.0/js/vendor/modernizr.js"></script>
  <!-- Page styles -->
  <style>
    .player-block iframe {
      width: 640px;
      height: 360px;
    }
  </style>
</head>

<body>
  <!-- header navbar -->
  <div id="navWrapper" class="fixed"></div>
  <!-- breadcrumbs -->
  <nav id="breadCrumbWrapper" class="breadcrumbs show-for-medium-up"></nav>
  <!-- search -->
  <div id="searchModal" class="reveal-modal" data-reveal></div>
  <!-- content -->
  <!-- content -->
  <div class="row">
    <div class="large-2 columns show-for-large-up">
      <div id="sidenav"></div>
    </div>
    <div id="main" class="large-10 small-12 columns">
      <div id="top" class="section">
        <h1>OnceUX Plugin</h1>
        <!-- Place document intro sentence(s) here -->
        <p>Using the OnceUX plugin with your Brightcove player, you can playback any Brightcove Once video.</p>
        <p>By default, the plugin enforces that all advertisements are watched and displays an ad count-down timer while they play. You can easily customize this plugin to use your own overlays and allow users to skip advertisements.</p>
        <div class="text-warning"
        style="padding-left:1em;padding-right:1em;">
          <h4>Other plugins used</h4>
          <p>Note: This example uses two other open source video.js plugins:</p>
          <ul>
            <li><a href="https://github.com/videojs/videojs-contrib-ads">videojs-contrib-ads</a> : Allows you to listen for <code>adstart</code> and <code>adend</code> events. You can listen for these events to know when an <code>adRoll</code> starts and ends respectively.
              Be aware, however, that these events can fire in rapid succession when scrubbing. They should always accurately reflect the <code>currentTime</code> of the playhead and states of the player.</li>
            <li><a href="https://github.com/brightcove/videojs-overlay">videojs-overlay</a> : For details, refer to the <a href="//docs.brightcove.com/en/video-cloud/brightcove-player/guides/overlay-plugin.html">Display Overlay Plugin</a> document.</li>
          </ul>
        </div>
      </div>
      <div id="player" class="section">
        <h2>The player</h2>
        <p>This example enforces the playback of an advertisement before the main subject video. An overlay is displayed with an ad count-down timer.</p>
        <div class="player-block">
          <iframe src='//players.brightcove.net/1752604059001/b2ce0968-2eb1-445c-af0d-4d54e6b73bbb_default/index.html' allowfullscreen webkitallowfullscreen mozallowfullscreen></iframe>
        </div>
      </div>
      <!-- id="player" -->
      <div id="getstarted" class="section">
        <h2>Get started</h2>
        <p>Here is the <code>curl</code> statement to create a Brightcove player with the OnceUX plugin.</p>
        <p>The properties are defined as follows:</p>
        <ul>
          <li>
            <p><code>scripts</code>: This property includes the script for the plugin.</p>
          </li>
          <li>
            <p><code>stylesheets</code>: This property includes the styles for the plugin.</p>
          </li>
          <li>
            <p><code>poster</code>: This property defines the poster image for the player.</p>
          </li>
          <li>
            <p><code>plugins</code>: This property contains an array of properties and values. For this plugin, you only need to supply the <code>name</code> property with the value of <code>onceux</code>.</p>
          </li>
          <li>
            <p><code>options</code>: This property is used to pass data to the plugin.</p>
          </li>
          <li>
            <p><code>metadataUri</code>: This property specifies the URI to call to get the Once VMAP data.</p>
          </li>
        </ul>
        <p><code data-gist-id="ef63cba9fedd4f7ed5c5" data-gist-hide-footer="true" data-gist-line="3-31"></code>
        </p>
        <p>The values for the <code>options</code> property are defined in the next section.</p>
        <h3>Initialize options</h3>
        <p>When you add the OnceUX plugin to your player, as shown in the <code>curl</code> statement above, you must pass an <code>options</code> object to the plugin to initialize it. This object must contain a <code>metadataUri</code> string or a VMAP object, along
          with any of the other optional properties:</p>
        <ul>
          <li><code>metadataUri</code>
          </li>
          <ul>
            <li>Required</li>
            <li>Type: String</li>
            <li>Default: undefined</li>
            <li>Description: The URI to call for the VMAP data.</li>
            <li>Example: "http://onceux.unicornmedia.com/now/ads/vmap/od/auto/1234"</li>
          </ul>
          <li><code>vmap</code>
          </li>
          <ul>
            <li>Optional</li>
            <li>Type: Object</li>
            <li>Default: none</li>
            <li>Description: If supplied, the plugin will use this VMAP object instead of calling the metadata URL to get the VMAP data.</li>
            <li>Example: see this <a href="//solutions.brightcove.com/bcls/brightcove-player/onceux-plugin/vmap-example.json">VMAP object</a>
            </li>
          </ul>
          <li><code>hideOverlay</code>
          </li>
          <ul>
            <li>Optional</li>
            <li>Type: Boolean</li>
            <li>Default: false</li>
            <li>Description: If true, the countdown timer and the <strong>Learn More</strong> click through overlays will not be shown while ads are playing.</li>
            <li>Example: true (hides default overlays)</li>
          </ul>
          <li><code>timeout</code>
          </li>
          <ul>
            <li>Optional</li>
            <li>Type: Number</li>
            <li>Default: 45000</li>
            <li>Description: The time in milliseconds to wait for the Once URI to respond.</li>
            <li>Example: 10000 (wait 10 seconds)</li>
          </ul>
          <h3>Use iframe</h3>
          <p>It is a best practice to use the iframe player implementation.</p>
          <p>Here is the complete code:</p>
          <p><code data-gist-id="ef63cba9fedd4f7ed5c5" data-gist-hide-footer="true" data-gist-line="173-196"></code>
          </p>
          <h3>Use embed_in_page</h3>
          <p>If you choose to use the embed_in_page implementation, you can add the OnceUX plugin right in the page code instead of using the <code>curl</code> statement above. Just remember that using the embed_in_page implementation only affects the player instance
            on the page, while the iframe implementation affects all instances of your player.</p>
          <p>Here is the complete code:</p>
          <p><code data-gist-id="ef63cba9fedd4f7ed5c5" data-gist-hide-footer="true" data-gist-line="200-240"></code>
          </p>
      </div>
      <div id="methods" class="section">
        <h2>Methods</h2>
        <p>The OnceUX plugin has the following methods:</p>
        <ul>
          <li><code>player.onceux.seekAds(timeInSeconds)</code>
          </li>
          <ul>
            <li>A function that takes a time (in seconds) to seek to without the default seek handling behavior enforcing that ads are not skipped.</li>
            <li>Parameters: A Number for the absolute time in seconds to seek to.</li>
            <li>Returns: None</li>
          </ul>
          <li><code>player.onceux.timeline.pathAtAbsoluteTime(timeInSeconds)</code>
          </li>
          <ul>
            <li>A function which takes a Number and provides a "path" into the timeline at any given point between <code>0</code> and the <code>absoluteDuration</code> of the stream.</li>
            <li>Parameters: A Number for the absolute time in seconds to provide a "path" for.</li>
            <li>Returns: A JSON object for the <code>path</code> representing the timeline. For details, see the <a href="#pathproperties">path object properties</a>.</li>
          </ul>
        </ul>
      </div>
      <div id="events" class="section">
        <h2>Events</h2>
        <p>The OnceUX plugin events are triggered when the <code>timeupdate</code> event occurs. Both the <code>linearAd</code> and <code>adRoll</code> objects are passed in these events.</p>
        <p>Here is an example of an event object returned:</p>
        <p><code data-gist-id="ef63cba9fedd4f7ed5c5" data-gist-hide-footer="true" data-gist-line="46-49"></code>
        </p>
        <p>Here are the available events:</p>
        <ul>
          <li>
            <p><code>onceux-linearad-start</code> : The linear ad starts playing.</p>
          </li>
          <li>
            <p><code>onceux-linearad-impression</code> : The linear ad impression URL has been pinged.</p>
          </li>
          <li>
            <p><code>onceux-linearad-firstQuartile</code> : The linear ad playhead crosses first quartile.</p>
          </li>
          <li>
            <p><code>onceux-linearad-midpoint</code> : The linear ad playhead crosses midpoint.</p>
          </li>
          <li>
            <p><code>onceux-linearad-thirdQuartile</code> : The linear ad playhead crosses third quartile.</p>
          </li>
          <li>
            <p><code>onceux-linearad-complete</code> : The linear ad completes playing. The <code>playCount</code> property of linear ad is incremented.</p>
          </li>
          <li>
            <p><code>onceux-adroll-start</code> : The ad roll starts playing.</p>
          </li>
          <li>
            <p><code>onceux-adroll-complete</code> : The ad roll completes playing. The <code>playCount</code> property of the ad roll is incremented.</p>
          </li>
          <li>
            <p><code>onceux-ads-complete</code> : All the ads have been played.</p>
          </li>
          <li>
            <p><code>onceux-linearad-skipped</code> : The linear ad is skipped by the user. Ads can be skipped only when multiple ad rolls are seeked over or by invoking the <code>seekAds()</code> function.</p>
          </li>
          <li>
            <p><code>onceux-linearad-mute</code> : The linear ad is muted by the user.</p>
          </li>
          <li>
            <p><code>onceux-linearad-unmute</code> : The linear ad is unmuted by the user.</p>
          </li>
          <li>
            <p><code>onceux-linearad-pause</code> : The linear ad is paused by the user.</p>
          </li>
          <li>
            <p><code>onceux-linearad-resume</code> : The linear ad is resumed by the user.</p>
          </li>
          <li>
            <p><code>onceux-companionad-creativeView</code> : The companion ad creative view event fired.</p>
          </li>
        </ul>
      </div>
      <div id="properties" class="section">
        <h2>Properties</h2>
        <p>You can view the values of runtime properties for the <code>onceux</code> object. Not all properties are currently parsed from the VMAP. See the <a href="//solutions.brightcove.com/bcls/brightcove-player/onceux-plugin/properties-example.json">properties example</a> for
          the current objects that are returned.</p>
        <h3>Once object properties</h3>
        <p>Here are the properties included in the <code>onceux</code> object:</p>
        <ul>
          <li><code>player.onceux.timeline</code>
          </li>
          <ul>
            <li>Type: Object</li>
            <li>Description: An object providing the essential parsed "absolute" timeline information from the VMAP.</li>
            <li>Example:</li>
            <p><code data-gist-id="ef63cba9fedd4f7ed5c5" data-gist-hide-footer="true" data-gist-line="34-42"></code>
            </p>
          </ul>
          <li><code>player.onceux.timeline.contenturi</code>
          </li>
          <ul>
            <li>Type: String</li>
            <li>Description: The content URI parsed from the VMAP.</li>
          </ul>
          <li><code>player.onceux.timeline.absoluteDuration</code>
          </li>
          <ul>
            <li>Type: Number</li>
            <li>Description: The total duration of the content including all Linear advertisements.</li>
          </ul>
          <li><code>player.onceux.timeline.contentDuration</code>
          </li>
          <ul>
            <li>Type: Number</li>
            <li>Description: The duration of the content excluding all Linear advertisements.</li>
          </ul>
          <li><code>player.onceux.timeline.adRolls</code>
          </li>
          <ul>
            <li>Type: Array</li>
            <li>Description: An Array of JSON objects representing the unmodified VAST 'AdBreak' info parsed from the Once VMAP XML file.</li>
          </ul>
        </ul>
        <h3>Add roll properties</h3>
        <p>Here are the properties included in the <code>adRoll</code> object:</p>
        <ul>
          <li>
            <p><code>adRoll.absoluteBeginTime</code> : Indicates the absolute time at which the adRoll will begin.</p>
          </li>
          <li>
            <p><code>adRoll.absoluteEndTime</code> : Indicates the absolute time at which the adRoll will end.</p>
          </li>
          <li>
            <p><code>adRoll.index</code> : Indicates the position of the adRoll with respect to the other adRollsIndicates the absolute time at which the adRoll will end.</p>
          </li>
          <li>
            <p><code>adRoll.playCount</code> : Indicates the number of times the adRoll has completed. Value 0 means that it has not been played.</p>
          </li>
        </ul>
        <h3>Linear ad properties</h3>
        <p>Here are the properties included in the <code>linearAd</code> object:</p>
        <ul>
          <li>
            <p><code>linearAd.absoluteBeginTime</code> : Indicates the absolute time at which the linear ad will begin.</p>
          </li>
          <li>
            <p><code>linearAd.absoluteEndTime</code> : Indicates the absolute time at which the linear ad will end.</p>
          </li>
          <li>
            <p><code>linearAd.index</code> : Indicates the position of the linear ad within the adRoll.</p>
          </li>
          <li>
            <p><code>linearAd.playCount</code> : Indicates the number of times the linear ad has been played. Value 0 means that it has not been played.</p>
          </li>
          <li>
            <p><code>linearAd.skipOffset</code> : Indicates the time after which the linear ad can be skipped. Value 0 means that the linear ad is not skippable.</p>
          </li>
          <li>
            <p><code>linearAd.companionAd</code> : An object representing the unmodified VAST companionAd info.</p>
          </li>
        </ul>
        <h3 id="pathproperties">Path properties</h3>
        <p>Here are the properties included in the <code>path</code> object:</p>
        <ul>
          <li>
            <p><code>path.absoluteTime</code> : This is the time in the stream relative to the absolute total time. This will always match what is passed into the function and provided just for convenience.</p>
          </li>
          <li>
            <p><code>path.contentTime</code> : This is the time in the stream relative to the currently playing linear advertisement or content.</p>
          </li>
          <li>
            <p><code>path.adRoll</code> : This value is null if no ad should be playing at the passed absolute time or if an ad should be playing, a JSON Object with the linear advertisement absolute begin/end time info from the timeline.</p>
          </li>
          <li>
            <p><code>path.linearAd</code> : This value is null if no ad should be playing at the passed absolute time or if an ad should be playing, a JSON Object with the linear advertisement <code>AdBreak</code> info from the timeline.</p>
          </li>
        </ul>
        <p>Here is an example of a <code>path</code> object without an ad.</p>
        <p><code data-gist-id="ef63cba9fedd4f7ed5c5" data-gist-hide-footer="true" data-gist-line="54-59"></code>
        </p>
        <p>Here is an example of a <code>path</code> object with an ad.</p>
        <p><code data-gist-id="ef63cba9fedd4f7ed5c5" data-gist-hide-footer="true" data-gist-line="64-169"></code>
        </p>
      </div>
      <div id="seekhandline" class="section">
        <h2>Seek handling</h2>
        <p>By default, the plugin enforces a "must-watch" ad policy. All advertisements must be watched in their entirety and <code>adRolls</code> cannot be skipped over or into part way. The only exception is when a seek is performed over multiple <code>adRolls</code>,
          where the plugin enforces that only the last <code>adRoll</code> that was seeked over is watched.</p>
        <p>Here are some examples:</p>
        <ul>
          <li>
            <p>Seek out of an ad : returns the user to where they seeked from</p>
          </li>
          <li>
            <p>Seek into an ad break : returns the user to the start of the <code>adRoll</code> containing the <code>adBreak</code>
            </p>
          </li>
          <li>
            <p>Seek over an ad : returns the user to the start of the <code>adRoll</code> seeked over</p>
          </li>
          <li>
            <p>Seek over multiple ad rolls : returns the user to the start of the last <code>adRoll</code> seeked over</p>
          </li>
          <li>
            <p>Seek backwards : no default handling</p>
          </li>
        </ul>
      </div>
      <div id="glossary" class="section">
        <h2>Glossary</h2>
        <p>This plugin distinguishes the concepts of <strong>absolute</strong> and <strong>content</strong> time within a OnceUX stream. Traditional video players only have a concept of <strong>content</strong> time; times between start and end of the URI it is currently playing. Because a OnceUX stream is essentially a number of <strong>content</strong> streams stiched together we've introduced the concept of <strong>absolute</strong> time which takes into account the complete stitched stream including the video advertisements.</p>
        <p>When you see the prefix <strong>absolute</strong> on a property or method, the times expected/returned are relative to the entire stitched stream. When you see the prefix <strong>content</strong>, the times expected/returned are relative only to a particular piece of content that was stitched into the stream (the main content or single linear advertisement).</p>
        <ul>
          <li>
            <p><code>timeline</code> : A JSON representation of the information in the Once VMAP XML. The timeline describes the stream and is referenced during playback constantly to ensure the UI is adapting to the currently playing content.</p>
          </li>
          <li>
            <p><code>path</code> : A snapshot of the timeline at any given second with information that is relavant only to that point in time within the stream.</p>
          </li>
          <li>
            <p><code>absoluteDuration</code> : The total duration of the stream including the linear ads.</p>
          </li>
          <li>
            <p><code>contentDuration</code> : The total duration of the stream excluding the linear ads.</p>
          </li>
          <li>
            <p><code>absoluteTime</code> : The time within the stream relative to absolute time.</p>
          </li>
          <li>
            <p><code>contentTime</code> : The time within the stream relative to the stitched content segement.</p>
          </li>
          <li>
            <p><code>absoluteStartTime</code> : The start time for stitched content in absolute time.</p>
          </li>
          <li>
            <p><code>absoluteEndTime</code> : The end time for stitched content in absolute time.</p>
          </li>
          <li>
            <p><code>adRoll</code> : A collection of one or more linear ads and non-linear ads.</p>
          </li>
          <li>
            <p><code>linearAd </code> : An <code>adBreak</code> which replaces the main video content. For example, video ads.</p>
          </li>
          <li>
            <p><code>companionAd</code> : An <code>adBreak</code> accompanying the linear ad or nonlinear ad which will be displayed outside the player screen. For example, ad banners.</p>
          </li>
          <li>
            <p><code>nonLinerAd</code> : An <code>adBreak</code> which will not replace the main video content. For example, overlay ads. These are not yet supported.</p>
          </li>
        </ul>
      </div>
      <div class="section" id="BCLreferences">
        <h2>Related Topics</h2>
        <ul>
          <li> <a href="//docs.brightcove.com/en/video-cloud/brightcove-player/guides/plugin-dev-quick-start.html#passdatatoplugin">Quick Start to Plugin Development</a>
          </li>
          <li> <a href="//docs.brightcove.com/en/video-cloud/player-management/getting-started/player-mgmt-quick-start.html#customizePlayer">Quick Start to Player Management - Plugin Section</a>
          </li>
          <li> <a href="//docs.brightcove.com/en/video-cloud/brightcove-player/guides/plugin-guide.html">Player Plugin Overview</a>
          </li>
        </ul>
      </div>
    </div>
  </div>
  <!-- bcl scripts -->
  <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
  <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/gist-embed/1.9/gist-embed.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/fastclick/1.0.0/fastclick.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/foundation/5.5.0/js/foundation.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/handlebars.js/2.0.0/handlebars.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.4/highlight.min.js"></script>
  <script src="/en/scripts/log.js"></script>
  <script src="/en/scripts/docs-nav-data.min.js"></script>
  <script src="/en/scripts/bcls-doc-site.js"></script>
  <script src="/en/scripts/bc-mapi.js"></script>
  <script>
    $(document).foundation();
  </script>
  <script type="text/javascript">
    /******** Any scripts specific to page samples should go here *********/
  </script>
  <div class="footer text-center"><a id="feedbackMail" href="mailto:docs@brightcove.com">Questions or comments?</a>
  </div>
  <script>
    var feedbackMail = document.getElementById("feedbackMail");
    feedbackMail.setAttribute("href", "mailto:docs@brightcove.com?subject=question regarding " + encodeURI(document.location.href));
  </script>
</body>

</html>