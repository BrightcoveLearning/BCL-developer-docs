<!DOCTYPE html>
<html lang="en">

<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="viewport" content="initial-scale=1.0, maximum-scale=1.0, user-scalable=no, width=device-width" />
	<!-- change title to match the h1 heading -->
	<title>Standard Ingest Profiles</title>
	<link rel="stylesheet" type="text/css" href="//cdnjs.cloudflare.com/ajax/libs/foundation/5.5.2/css/foundation.min.css" />
	<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/foundation/5.5.2/css/normalize.css" />
	<script src="//use.edgefonts.net/source-code-pro.js"></script>
	<link href='http://fonts.googleapis.com/css?family=Open+Sans:400italic,700italic,400,700' rel='stylesheet' type='text/css'>
	<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.6/styles/atelier-estuary.light.min.css" />
    <link rel="stylesheet" type="text/css" href="/en/styles/bcls-doc-site.css" />
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:400italic,700italic,400,700' rel='stylesheet' type='text/css'>
    <style type="text/css">
        h2 {
            font-size: 1.5rem;
        }
        th, td {
            text-align: center;
        }
    </style>
	<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-2728311-29', 'auto');
  ga('send', 'pageview');

</script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/foundation/5.5.2/js/vendor/modernizr.js"></script>
</head>

<body>
	<!-- header navbar -->
	<div id="navWrapper" class="fixed"></div>
	<!-- breadcrumbs -->
	<nav id="breadCrumbWrapper" class="breadcrumbs show-for-medium-up"></nav>
	<!-- search -->
	<div id="searchModal" class="reveal-modal" data-reveal></div>
	<!-- content -->
	<!-- content -->
	<div class="row">
		<div class="sidebar large-2 columns show-for-large-up">
			<div id="sidenav"></div>
		</div>
		<div id="main" class="large-10 small-12 columns">
			<div id="top" class="section">
				<h1>Standard Ingest Profiles</h1>
				<!-- Place document intro sentence(s) here -->
				<p>When creating a Dynamic Ingest request using the DI API you must supply a profile which determines the number and type of renditions created by the ingest.</p>
                <p class="BCL-aside">Note: this page is built using live data from the API; it may take a minute to fully load.</p>
                <!-- the rest of the content of this page is generated by script -->
			</div>

		</div>
	</div>
	<!-- bcl scripts -->
	<script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
	<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/gist-embed/1.9/gist-embed.min.js"></script>
	<script src="//cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>
	<script src="//cdnjs.cloudflare.com/ajax/libs/fastclick/1.0.3/fastclick.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/foundation/5.5.2/js/foundation.min.js"></script>
	<script src="//cdnjs.cloudflare.com/ajax/libs/handlebars.js/3.0.2/handlebars.min.js"></script>
	<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.6/highlight.min.js"></script>
	<script src="/en/scripts/log.js"></script>
	<script src="/en/scripts/docs-nav-data.min.js"></script>
	<script src="/en/scripts/bc-mapi.js"></script>
    <div class="footer text-center"><a id="feedbackMail" href="mailto:docs@brightcove.com">Questions or comments?</a></div>
    <script>
	var feedbackMail = document.getElementById("feedbackMail");
	feedbackMail.setAttribute("href", "mailto:docs@brightcove.com?subject=question regarding " + encodeURI(document.location.href));
	</script>
    <script src="./assets/BCLSprofilesArray.js"></script>
    <script src="/en/scripts/bcls-doc-site.js"></script>
    <script type="text/javascript">
        var BCLS = ( function (window, document, Handlebars, bclsProfiles_cached, hljs) {
            var  mainSection = document.getElementById("main"),
                proxyURL = "https://solutions.brightcove.com/bcls/bcls-proxy/bcls-proxy.php",
                        requestData = "client_id=cca7ae2a-503d-472e-996c-3aa664d4aa95&client_secret=OE43iNQ6HluFxM2I_f6QDfGLoSSW28jnDWbX8gDgS6GIFD2P6VNWKbRHyln0I5aVyoSeil0l5ikWYQ2hUbR99g&url=" + encodeURI('https://ingestion.api.brightcove.com/v1/accounts/3921507403001/profiles') + "&requestBody=null&requestType=GET",
                data = bclsProfiles_cached,
                profileListTemplate = "{{#BCLSprofilesArray}}<tr><td><a href=\"#{{name}}\">{{name}}</a></td><td class=\"bcl-center\">{{videoRenditions}}</td><td class=\"bcl-center\">{{audioRenditions}}</td><td class=\"bcl-center\">{{imageRenditions}}</td><td>{{description}}</td></tr>{{/BCLSprofilesArray}}",
                navLabel = [],
                // functions
                buildSummaryTable,
                buildDetailTables,
                getProfileData,
                createInPageNav,
                createInPageNavMenu,
                dedupe,
                isDefined,
                bclslog;

            /**
             * tests for all the ways a variable might be undefined or not have a value
             * @param {*} x the variable to test
             * @return {Boolean} true if variable is defined and has a value
             */
            isDefined = function(x){
                if( x !== "" && x !== null && x !== undefined && x !== NaN && x !== {} && x !== []){
                    return true;
                } else{
                    return false;
                }
            };

            /**
             * dedupe a simple array of strings or numbers
             * @param {array} arr the array to be deduped
             * @return {array} out the deduped array
             */
            dedupe = function (arr) {
                var i,
                    len = arr.length,
                    out = [],
                    obj = {};

                for (i = 0;i < len; i++) {
                    obj[arr[i]] = 0;
                }
                for (i in obj) {
                    out.push(i);
                }
                return out;
            };
            /**
             * Logging function - safe for IE
             * @param  {string} context description of the data
             * @param  {*} message the data to be logged by the console
             * @return {}
             */
            bclslog = function (context, message) {
                if (window["console"] && console["log"]) {
                    console.log(context, message);
                }
                return;
            };

            // create navigation for page sections
            createInPageNavMenu = function () {
                var str = "<ul class=\"side-nav show-for-large-up\">",
                    i,
                    max = navLabel.length,
                    $navElements,
                    $sidenav = $("#sidenav");
                for (i = 0; i < max; i++) {
                    str += "<li><a href=\"#" + navLabel[i].link + "\">" + navLabel[i].text + " </a></li>";
                }
                str += "</ul>";
                $sidenav.append(str);
                $navElements = $sidenav.find("a");
                $navElements.on("click", function () {
                    $navElements.attr("style", "");
                    $(this).attr("style", "background-color:#F3951D;color:#ffffff");
                });
                // set h2 color to product NewColor
                $("h1,h2").attr("style", "color:#F3951D;");
                $("pre>code").each(function (i, e) {
                    hljs.highlightBlock(e);
                });
            };
            createInPageNav = function () {
                var navObj = {},
                    $divsection = $("div.section");
                // set initial visibilities
                $divsection.each(function (index) {
                    bclslog("index", index);
                    if (index > 0) {
                        $this = $(this);
                        navObj = {};
                        navObj.link = $this.attr("id");
                        navObj.text = $this.find("h2:first").text();
                        navLabel.push(navObj);
                    }
                });
                // only create the nav widget if there is more than one item
                if (navLabel.length > 1) {
                    // create in-page nav menu
                    createInPageNavMenu();
                }
            };

            buildSummaryTable = function () {
                var newSectionNode = document.createElement("div"),
                    sectionHeadingNode = document.createElement("h2"),
                    sectionIntroNode = document.createElement("p"),
                    profileTableNode = document.createElement("table"),
                    profiletheadNode = document.createElement("thead"),
                    profiletbodyNode = document.createElement("tbody"),
                    sectionHeadingElem,
                    sectionIntroElem,
                    profileTableElem,
                    profiletheadElem,
                    profiletbodyElem,
                    template = profileListTemplate,
                    profileDescriptions = [
                        {"name": "Express Standard", "description": "Does not include HLS renditions"},
                        {"name": "Live - HD", "description": "Profile used by the Live Module - all HD renditions"},
                        {"name": "Live - Premium HD", "description": "Used by Live Module - Larger set with Standard and HD renditions"},
                        {"name": "Live - Standard", "description": "Use by Live Module - small set that is cost effective"},
                        {"name": "audio-only", "description": "Audio tracks to cover all devices ***CURRENTLY NOT WORKING - DO NOT USE***"},
                        {"name": "balanced-high-definition", "description": "A large set providing high quality renditions for all device types"},
                        {"name": "balanced-nextgen-player", "description": "Mostly HLS renditions for the Brightcove Player"},
                        {"name": "balanced-standard-definition", "description": "A set for general use, average quality"},
                        {"name": "high-bandwidth-devices", "description": "For devices on good wi-fi connections"},
                        {"name": "low-bandwidth-devices", "description": "For devices on non-wi-fi connections"},
                        {"name": "mp4-only", "description": "A good range of MP4 renditions, no HLS"},
                        {"name": "screencast", "description": "Limited renditions, larger frame size with lower bitrates"},
                        {"name": "single-rendition", "description": "A single good quality MP4"}
                    ],
                    i, iMax, j, jMax, k, kMax, item;
                iMax = data.BCLSprofilesArray.length;
                // massage data
                for (i = 0; i < iMax; i++) {
                    item = data.BCLSprofilesArray[i];
                    item.videoRenditions = 0;
                    item.audioRenditions = 0;
                    item.imageRenditions = 0;
                    jMax = item.renditions.length;
                    item.numRenditions = jMax;
                    kMax = profileDescriptions.length;
                    for (k = 0; k < kMax; k++) {
                        if (item.name === profileDescriptions[k].name) {
                            item.description = profileDescriptions[k].description;
                        }
                    }

                    for (j = 0; j < jMax; j++) {
                        if (item.renditions[j].format === "ts") {
                            item.renditions[j].format = "ts (HLS)";
                        }
                        if (item.renditions[j].media_type === "video") {
                            item.videoRenditions++;
                        } else if (item.renditions[j].media_type === "image") {
                            item.imageRenditions++;
                        } else if (item.renditions[j].media_type === "audio") {
                            item.audioRenditions++;
                        }
                    }

                }
                newSectionNode.setAttribute("id", "summaryTableSection");
                newSectionNode.setAttribute("class", "section");
                sectionHeadingNode.setAttribute("id", "summaryTableHeading");
                sectionIntroNode.setAttribute("id", "summarySectionIntro");
                profileTableNode.setAttribute("id", "profileSummaryTable");
                profileTableNode.setAttribute("class", "profile-data");
                profiletheadNode.setAttribute("id", "profileSummaryTableThead");
                profiletbodyNode.setAttribute("id", "profileSummaryTableTbody");
                newSectionNode.appendChild(sectionHeadingNode);
                newSectionNode.appendChild(sectionIntroNode);
                newSectionNode.appendChild(profileTableNode);
                profileTableNode.appendChild(profiletheadNode);
                profileTableNode.appendChild(profiletbodyNode);
                mainSection.appendChild(newSectionNode);
                sectionHeadingElem = document.getElementById("summaryTableHeading");
                sectionIntroElem = document.getElementById("summarySectionIntro");
                profiletheadElem = document.getElementById("profileSummaryTableThead");
                profiletbodyElem = document.getElementById("profileSummaryTableTbody");
                sectionHeadingElem.innerHTML = "Standard Profiles List";
                sectionIntroElem.innerHTML = "Click on a profile name to see details of the renditions it includes. Note that the actual renditions created will depend on the quality of the source video.";
                profiletheadElem.innerHTML = "<tr><th>Profile Name</th><th>Video Renditions</th><th>Audio Renditions</th><th>Image Renditions</th><th>Description</th></tr>";
                template = Handlebars.compile(profileListTemplate);
                profiletbodyElem.innerHTML = template(data);
            };
            buildDetailTables = function () {
                bclslog("building data tables");
                var newSectionNode,
                    sectionHeadingNode,
                    sectionSubHeadingNode,
                    sectionJsonHeadingNode,
                    sectionTableHeadingNode,
                    renditionTableNode,
                    renditiontheadNode,
                    renditiontbodyNode,
                    profilePreNode,
                    profileCodeNode,
                    sectionHeadingElem,
                    sectionSubHeadingElem,
                    sectionJsonHeadingElem,
                    sectionTableHeadingElem,
                    profilePreElem,
                    profileCodeElem,
                    renditionTableElem,
                    renditiontheadElem,
                    renditiontbodyElem,
                    i, j, jMax,
                    iMax = data.BCLSprofilesArray.length,
                    headings,
                    rendition,
                    renditionProperty,
                    re = /_/g;
                for (i = 0; i < iMax; i++) {
                    var headersArray = [],
                        thStr = "",
                        tbStr = "",
                        l,
                        lMax;
                    newSectionNode = document.createElement("div");
                    sectionHeadingNode = document.createElement("h2");
                    sectionSubHeadingNode = document.createElement("p");
                    sectionJsonHeadingNode = document.createElement("h6");
                    sectionTableHeadingNode = document.createElement("h6");
                    profilePreNode = document.createElement("pre");
                    profileCodeNode = document.createElement("code");
                    newSectionNode.setAttribute("id", data.BCLSprofilesArray[i].name);
                    newSectionNode.setAttribute("class", "section");
                    sectionHeadingNode.setAttribute("id", data.BCLSprofilesArray[i].name + "_summaryTableHeading");
                    sectionSubHeadingNode.setAttribute("id", data.BCLSprofilesArray[i].name + "_summarySubHeading");
                    sectionJsonHeadingNode.setAttribute("id", data.BCLSprofilesArray[i].name + "_summaryJsonHeading");
                    sectionTableHeadingNode.setAttribute("id", data.BCLSprofilesArray[i].id + "_profileSummaryTable");
                    profilePreNode.setAttribute("id", data.BCLSprofilesArray[i].name + "_summaryPre");
                    profileCodeNode.setAttribute("id", data.BCLSprofilesArray[i].name + "_summaryCode");
                    newSectionNode.appendChild(sectionHeadingNode);
                    newSectionNode.appendChild(sectionSubHeadingNode);
                    newSectionNode.appendChild(sectionJsonHeadingNode);
                    newSectionNode.appendChild(profilePreNode);
                    newSectionNode.appendChild(sectionTableHeadingNode);
                    profilePreNode.appendChild(profileCodeNode);

                    mainSection.appendChild(newSectionNode);
                    sectionHeadingElem = document.getElementById(data.BCLSprofilesArray[i].name + "_summaryTableHeading");
                    sectionSubHeadingElem = document.getElementById(data.BCLSprofilesArray[i].name + "_summarySubHeading");
                    sectionJsonHeadingElem = document.getElementById(data.BCLSprofilesArray[i].name + "_summaryJsonHeading");
                    sectionTableHeadingElem = document.getElementById(data.BCLSprofilesArray[i].id + "_profileSummaryTable");
                    profilePreElem = document.getElementById(data.BCLSprofilesArray[i].name + "_summaryPre");
                    profileCodeElem = document.getElementById(data.BCLSprofilesArray[i].name + "_summaryCode");
                    sectionHeadingElem.innerHTML = data.BCLSprofilesArray[i].name;
                    sectionSubHeadingElem.innerHTML = "<a href=\"#" + data.BCLSprofilesArray[i].id + "_profileSummaryTable\">View rendition information in table form</a>";
                    sectionJsonHeadingElem.innerHTML = "JSON for the <code>" + data.BCLSprofilesArray[i].name + "</code> profile";
                    sectionTableHeadingElem.innerHTML = "Table of rendition properties";
                    profileCodeElem.innerHTML = JSON.stringify(data.BCLSprofilesArray[i], false, "  ");
                    jMax = data.BCLSprofilesArray[i].renditions.length;
                    renditionTableNode = document.createElement("table");
                    renditiontheadNode = document.createElement("thead");
                    renditiontbodyNode = document.createElement("tbody");
                    renditionTableNode.setAttribute("id", data.BCLSprofilesArray[i].id + "_profileSummaryTable");
                    renditionTableNode.setAttribute("class", "profile-data");
                    renditiontheadNode.setAttribute("id", data.BCLSprofilesArray[i].id + "_profileSummaryTableThead");
                    renditiontbodyNode.setAttribute("id", data.BCLSprofilesArray[i].id + "_profileSummaryTableTbody");
                    newSectionNode.appendChild(renditionTableNode);
                    renditionTableNode.appendChild(renditiontheadNode);
                    renditionTableNode.appendChild(renditiontbodyNode);
                    renditiontheadElem = document.getElementById(data.BCLSprofilesArray[i].id + "_profileSummaryTableThead");
                    renditiontbodyElem = document.getElementById(data.BCLSprofilesArray[i].id + "_profileSummaryTableTbody");
                    // get all properties and build the table headers
                    for (j = 0; j < jMax; j++) {
                        var prop;
                        thStr += "<tr>";
                        rendition = data.BCLSprofilesArray[i].renditions[j];
                        for (prop in rendition) {
                            headersArray.push(prop);
                        }
                    }
                    // dedupe the headers
                    headersArray = dedupe(headersArray);
                    // write the th elements to the string
                    lMax = headersArray.length;
                    for (l = 0; l < lMax; l++) {
                        thStr += "<th>" + headersArray[l].replace(re, " ") + "</th>";
                    }
                    thStr += "</tr>";
                    renditiontheadElem.innerHTML = thStr;
                    // now add the body row for each rendition
                    for (j = 0; j < jMax; j++) {
                        tbStr = "<tr>";
                        rendition = data.BCLSprofilesArray[i].renditions[j];
                        for (l = 0; l < lMax; l++) {
                            tbStr += "<td>";
                            tbStr += isDefined(rendition[headersArray[l]]) ? rendition[headersArray[l]] : "";
                            tbStr += "</td>";
                        }
                        tbStr += "</tr>";
                        renditiontbodyElem.innerHTML += tbStr;
                    }
                }
                bclslog("content built");
                createInPageNav();
            };
            getProfileData = function () {
                var httpRequest = new XMLHttpRequest(),
                    proxyURL = "https://solutions.brightcove.com/bcls/bcls-proxy/bcls-proxy.php",
                    getResponse = function () {
                        bclslog("getting data");
                        try {
                            if (httpRequest.readyState === 4) {
                              if (httpRequest.status === 200) {
                                // try {
                                  bclslog(httpRequest.responseText);
                                  data.BCLSprofilesArray = JSON.parse(httpRequest.responseText);
                                  buildSummaryTable();
                                  buildDetailTables();

                                // } catch (e) {
                                //   bclslog('invalid json', e);
                                //   // just use cached data and build the tables
                                //     data = bclsProfiles_cached;
                                //     buildSummaryTable();
                                //     buildDetailTables();
                                // }
                              } else {
                                bclslog("There was a problem with the request. Request returned: ", httpRequest.status);
                                // just use cached data and build the tables
                                data = bclsProfiles_cached;
                                buildSummaryTable();
                                buildDetailTables();

                              }
                            }
                          }
                          catch(e) {
                            bclslog('Caught Exception: ', e);
                          }
                    };
                // set response handler
                httpRequest.onreadystatechange = getResponse;
                // open the request
                httpRequest.open("POST", proxyURL);
                // set headers
                httpRequest.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");
                // open and send request
                httpRequest.send(requestData);
            };
            getProfileData();

            // BCLSmain.createInPageNav();
            })(window, document, Handlebars, bclsProfiles_cached, hljs);
    </script>
    <!-- note - since the script above inserts sections into the DOM, the main site script and foundation() must be called after that script runs! -->
    <script>
        $(document).foundation();

	</script>

</body>

</html>
