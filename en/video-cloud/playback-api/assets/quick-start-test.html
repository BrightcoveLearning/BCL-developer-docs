<!DOCTYPE html>
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <title></title>
        <style>
            body {
              margin: 2em;
              font-family: sans-serif;
            }
            h2 {
              font-size: 1.1em;
            }
            img {
              float: left;
            }
            button {
              padding: .5em;
            }
            pre>code {
              background-color: #F1EFEE;
              border-left: .5em solid #636363;
              box-shadow: 5px 5px 10px rgba(192, 192, 192, 1.000);
              font-family: monospace;
              padding: 1em;
            }
        </style>
    </head>
    <body>
        <h1>Playback API Tester: Video</h1>
        <h2>Inputs</h2>
        <p>Account id:
          <input id="account_id" type="text" value="57838016001">
        </p>
        <p>Policy key:
          <input id="policy_key" type="text" size="80" value="BCpkADawqM0NK0Rq8n6sEQyWykemrqeSmIQqqVt3XBrdpl8TYlvqN3hwKphBJRnkPgx6WAbozCW_VgTOBCNf1AQRh8KnmXSXfveQalRc5-pyNlSod5XzP99If2U">
        </p>
        <p>Video id:
          <input id="video_id" value="4084164751001">
        </p>
        <p>Playlist id:
          <input id="playlist_id" value="749117323001">
        </p>
        <p><button id="videoButton">Get a video</button> <button id="playlistButton">Get a playlist</button></p>
        <h2>API request:</h2>
        <pre><code id="apiRequest"></code></pre>
        <h2>Generated content</h2>
        <div id="generatedContent"></div>
        <script>
        var BCLS = ( function (window, document) {
            var apiBaseURL          = 'https://edge.api.brightcove.com/playback/v1',
                // elememnt references
                account_id          = document.getElementById('account_id'),
                policy_key          = document.getElementById('policy_key'),
                video_id            = document.getElementById('video_id'),
                playlist_id         = document.getElementById('playlist_id'),
                videoButton         = document.getElementById('videoButton'),
                playlistButton      = document.getElementById('playlistButton'),
                apiRequest          = document.getElementById('apiRequest'),
                generatedContent    = document.getElementById('generatedContent'),
                // functions
                makeVideoDisplay,
                makePlaylistDisplay,
                getMediaData;

            makeVideoDisplay = function (videoData) {

            };

            makePlaylistDisplay = function (playlistData) {

            };

            getMediaData = function (mediaType, requestURL, options) {
                var httpRequest = new XMLHttpRequest(),
                    responseData,
                    parsedData,
                    getResponse = function () {
                        try {
                            if (httpRequest.readyState === 4) {
                              if (httpRequest.status === 200) {
                                logResponse(type, httpRequest.responseText);
                                responseData = httpRequest.responseText;
                                switch (mediaType) {
                                    case "video":
                                        parsedData = JSON.parse(responseData);
                                        di_url_display.value = "https://ingest.api.brightcove.com/v1/accounts/" + account_id + "/videos/" + parsedData.id + "/ingest-requests";
                                        setDIOptions();
                                    }
                                    break;
                                    case "playlist":
                                    totalIngested++;
                                    logResponse("totalIngested", totalIngested);
                                    if (videoNumber < totalVideos - 1) {
                                        videoNumber++;
                                        logResponse("Processing video number", videoNumber);
                                        // pause to avoid CMS API timeouts
                                        t2 = setTimeout(setCMSOptions, 1000);
                                    }
                                    break;
                                }
                              } else {
                                alert("There was a problem with the request. Request returned " + httpRequest.status);
                              }
                            }
                          }
                          catch(e) {
                            alert('Caught Exception: ' + e);
                          }
                    };
                // set response handler
                httpRequest.onreadystatechange = getResponse;
                // open the request
                httpRequest.open("GET", proxyURL);
                // set headers
                httpRequest.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");
                // open and send request
                httpRequest.send();
            };

            // event listeners

        })(window, document);
        </script>
    </body>
</html>
